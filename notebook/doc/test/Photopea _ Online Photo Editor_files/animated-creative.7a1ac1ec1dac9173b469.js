window._bannerflow.registerModule("7a1ac1ec1dac9173b469",(()=>{var t;return(()=>{"use strict";var i,e,n={593984402815064:(t,i,e)=>{var n,s,r;e.d(i,{G6:()=>c,HM:()=>f,Vk:()=>v,ce:()=>p,un:()=>u,vU:()=>a});const o=((null===(n=window.navigator)||void 0===n?void 0:n.userAgent)||"").toLowerCase(),h=!!window.opr&&!!opr.addons||!!window.opera||o.indexOf(" opr/")>=0,a="undefined"!=typeof InstallTrigger,c=(null===(r=null===(s=window.navigator)||void 0===s?void 0:s.vendor)||void 0===r?void 0:r.indexOf("Apple"))>-1&&-1===navigator.userAgent.indexOf("crios")&&-1===o.indexOf("fxios"),u=!!!document.documentMode&&!!window.StyleMedia,l=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),d=l&&-1!=o.indexOf("edg"),f=((l||h||d)&&window.CSS,o.match(/(iPad)/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),p=function(){try{const t=window.navigator.userAgent,i=t.indexOf("OS ");if((t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1)&&i>-1){const e=Number(t.substr(i+3,4).replace("_",".")),n=t.substr(i+3).split(" ")[0].replace(/_/g,".").split(".").map((t=>Number(t)));return{simple:e,full:{major:n[0],minor:n[1],patch:n[2]||0}}}}catch(t){console.warn("Could not get iOS version.")}return{simple:0,full:{major:0,minor:0,patch:0}}}();function v(){const t=navigator.userAgent;let i,e=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(e[1])?(i=/\brv[ :]+(\d+)/g.exec(t)||[],parseFloat(i[1])||-1):"Chrome"===e[1]&&(i=t.match(/\b(OPR|Edge)\/(\d+)/),null!=i)?parseFloat(i[2])||-1:(e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(i=t.match(/version\/(\d+)/i))&&e.splice(1,1,i[1]),parseFloat(e[1])||-1)}},526456703559590:(t,i,e)=>{e.d(i,{BE:()=>s,CH:()=>r,xE:()=>o});var n=e(593984402815064);function s(t,i){t.parentNode&&t.parentNode.insertBefore(i,t.nextSibling)}function r(){return n.ce.simple>=16.3?"javascript:''":"about:blank"}function o(t){var i;const e=document.createElement("meta");e.name="color-scheme",e.content="light only",null===(i=t.contentDocument)||void 0===i||i.head.appendChild(e)}},347708221820546:(t,i,e)=>{e.d(i,{b3:()=>u,Ty:()=>v,kZ:()=>m});var n=e(961342611394679),s=e(577269179748313),r=e(810692733885393),o=e(50897836289296);function h(t){switch(t){case"cover":case"crop":return n.Jr.Crop;case"distort":case"stretch":return n.Jr.Stretch;case"contain":case"fit":return n.Jr.Fit;default:return n.Iu.sizeMode}}var a=e(593984402815064),c=e(584415190493052);class u{static get origin(){var t;return null===(t=u.t)||void 0===t?void 0:t.origin}static async n(t="",i="",e=1){let n=!1;const s=a.ce.simple;return n=!(s>0&&s>=14.3&&s<14.5)&&await function(){l||(l=new Promise((t=>{const i=new Image;i.onload=i.onerror=()=>t(2===i.height),i.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"})));return l}(),u.t={webP:n,dpr:e,origin:t,defaultOrigin:i},n}static getCroppingOptions(t){const i=t.imageSettings;if(i.sizeMode===n.Jr.Crop)return function(t,i,e=.5,n=.5){if(!i||!i.width||!i.height)return;const r=Object.assign(Object.assign({},(0,s.vd)(i,t,"cover")),{x:0,y:0}),o=(0,s.nH)(t,r,e,n),h=i.width/r.width,a=(0,s.aR)({x:o.x*h,y:o.y*h,width:o.width*h,height:o.height*h}),c=(0,s.fy)(a);return c.x2=Math.min(c.x2,i.width),c.y2=Math.min(c.y2,i.height),c}(t,t.imageAsset,i.x,i.y)}static a(t,i={}){const{imageAsset:e,imageSettings:o}=t,h=function(t,i){const e=t.imageAsset;let n=t.states.reduce(((t,i)=>{const e=i.scaleX||0,n=i.scaleY||0;return Math.max(e,n,t)}),1);if(i)if(t.width<=i.width||t.height<=i.height){const e=(0,s.vd)(t,i,"cover");n=Math.min(e.width/t.width,n)}else n=1;if((null==e?void 0:e.width)&&(null==e?void 0:e.height)){const i=e.width,s=e.height;if(i<t.width*n)return{width:i,height:s}}return{width:t.width*n,height:t.height*n}}(t,i.sizeLimit),a=i.feedUrl||(null==e?void 0:e.url)||"",l=i.force?100:void 0,f="number"==typeof o.quality?o.quality:l;let p=o.sizeMode;const v=i.cropping;e||(p=p===n.Jr.Crop?n.Jr.Crop:n.Jr.Fit);const{origin:m,defaultOrigin:g,webP:w}=u.t,b=d(a,w);if("svg"===b||"gif"===b||void 0===f){const t=m&&g&&(0,c.A4)(a,g)&&"local"!==window.ENVIRONMENT?(0,c.r9)(a,m):a;return(0,r.Nm)(t)}const y=u.getDevicePixelRatio("number"!=typeof o.quality||o.highDpi);return u.getUrl(a,Object.assign(Object.assign({},h),{sizeMode:p,quality:f,cropping:v,dpr:y}))}static getUrl(t,i){const e=u.t;if(!e)throw new Error("ImageOptimizerUrlBuilder not initiated");return function(t,i){if(!t)throw new Error("No image url provided");(0,r.Nm)(t),i=Object.assign(Object.assign({},m),(0,o.Yc)(i));const e=i.imageOptimizerOrigin||"";if(!(0,r.Nm)(e)||(0,c.j3)(t))return t;const n=d(t,i.webpSupport);if("svg"===n||"gif"===n)return t;if(t.indexOf(e)>-1){const i=(0,c.Dg)(t).u;"string"==typeof i&&(t=decodeURIComponent(i))}if(!i.width||!i.height)throw new Error("No size provided");const s=i.position?{positionX:i.position.x,positionY:i.position.y}:void 0,h=(0,o.uZ)(i.dpr||1,1,2),a=Math.round(i.width*h),u=Math.round(i.height*h),l="number"==typeof i.quality?(0,o.uZ)(i.quality,0,99):void 0,p=Object.assign(Object.assign({u:encodeURIComponent(t),w:a,h:u,q:l,f:n,rt:f(i.sizeMode||i.fitOption)},s),i.cropping),v=(0,c.nZ)(p);return`${e}/api/image/${i.method}${v}`}(t,Object.assign({webpSupport:e.webP,imageOptimizerOrigin:e.origin,dpr:e.dpr},(0,o.Yc)(i)))}static c(t=""){const i="string"==typeof t?t:t.imageUrl||"";if(!this.origin&&"string"!=typeof t){const e=p(i),s="svg"!==e&&"gif"!==e,r=t.__data.imageSettings.sizeMode===n.Jr.Crop;return(0,c.j3)(i)&&r&&s&&!(0,c.Zp)(i)}return!!i&&u.g(i)&&!!(0,c.Dg)(i).x1}static getOriginalUrl(t=""){return u.g(t)?v(t)||"":t}static g(t){const i=u.origin;return!!i&&function(t,i){return t.indexOf(i)>-1&&!!v(t)}(t,i)}static getDevicePixelRatio(t){const i=window.devicePixelRatio;return t&&i?(0,o.uZ)((0,o.L8)(i,.5),1,2):this.t.dpr}}let l;function d(t,i=!1){const e=p(t),n=a.ce.simple;return"gif"===e&&n>0&&n>=14&&n<16&&(i=!1),"svg"===e?e:i?"webp":e&&"webp"!==e?e:"png"}function f(t){const i=h(t);return i===n.Jr.Stretch||i===n.Jr.Fit?"contain":i===n.Jr.Crop?"cover":void 0}function p(t){const i=(0,c.mD)(t);switch(i){case"jpg":return"jpeg";case"webp":case"jpeg":case"gif":case"png":case"svg":return i}}function v(t){return(0,c.Dg)(t).u}const m={webpSupport:!1,imageOptimizerOrigin:"",method:"optimize",quality:n.De,dpr:1}},375374058922245:(t,i,e)=>{e.d(i,{C2:()=>b,DE:()=>u,Uu:()=>a,ZH:()=>l,ot:()=>x,q$:()=>s,qF:()=>r,wU:()=>g,zj:()=>p});var n=e(680214823521203);function s(t){return o(t,"in")}function r(t){return o(t,"out")}function o(t,i){return h(t.filter((t=>t.type===i)))}function h(t){return m(...c(t))}function a(t,i){return!(0,n.xj)(t)&&g(i,t)}function c(t){const i=Array.isArray(t)?t:t.animations,e=[];return null==i||i.forEach((t=>e.push(...t.keyframes))),e}function u(t,i,e=0){const n=y(i);return t.slice(0).sort(f).find((t=>n!==t&&t.time-e<=n.time))}function l(t,i,e=0){const n=y(i);return t.slice(0).sort(d).find((t=>n!==t&&n.time<=t.time+e))}function d(t,i){return t.time-i.time||(t.duration||0)-(i.duration||0)}function f(t,i){return i.time-t.time||(i.duration||0)-(t.duration||0)}function p(t,i){return i-t.time}function v(...t){return(null==t?void 0:t.length)?Math.min(...t.map((t=>t.time))):0}function m(...t){if(!(null==t?void 0:t.length))return 0;const i=v(...t);return Math.max(...t.map((t=>t.time+(t.duration||0))))-i}function g(t,i,e=0){return w(t,i,i,e)}function w(t,i,e,n=0){const s=_(t),r=_(i),o=i===e?r:_(e);return r.time-n<=s.time&&s.time+s.duration<=o.time+o.duration+n}function b(t,i){const e=t.time<i.time?t:i,n=t.time<i.time?i:t;return Math.max(0,n.time-(e.time+(e.duration||0)))}function y(t){return"number"==typeof t?{time:t}:t}function _(t){return"number"==typeof t?{time:t,duration:0}:(void 0===t.duration&&(t.duration=0),t)}function x(t){if(!t)return;const i=parseInt(t,10);return function(t){return Number.isInteger(t)&&Number.isFinite(t)&&t>0}(i)?1e3/i:void 0}},290484402537373:(t,i,e)=>{e.d(i,{L:()=>u});var n=e(672562019417818),s=e(431962836110159),r=e(356676357306009),o=e(680214823521203),h=e(656188145953480),a=e(651411520567126),c=e(375374058922245);let u=class extends a.v{get duration(){return function(t){let i=0;for(const e of t.elements)e.time+e.duration>i&&(i=e.time+e.duration);return i}(this.creative)}constructor(t,i,e){super(),this.creative=t,this.b=i,this.F=e,this.time=0,this.isPlaying=!1,this.loop=1,this.C=!1,this.A=0,this.E=0,this.S=0,this.O=1,this.$=new Map,this.D=[],this.B=t=>{if(this.k&&t-this.A<this.k)return void(this.T=requestAnimationFrame(this.B));if(this.A=t,this.C||!this.isPlaying)return void this.R();this.E||(this.E=t);const i=this.z(),e=this.creative.loops,n=(t-this.E)*this.O,r=(this.S+n)/1e3;if(!this.P()&&this.loop>=e&&r>=i&&this.F.MODE!==s.y.VideoGenerator)this.stop();else{if(this.F.MODE===s.y.VideoGenerator&&r>=this.duration)return this.H(this.duration),void this.pause();for(r<this.duration?this.H(r):r>=this.duration&&(this.H(this.duration),this.next());this.D.length;){const t=this.D.pop();t.fn(...t.value)}this.emit("tick",[this.time]),this.T=requestAnimationFrame(this.B)}}}play(){return!this.isPlaying&&this.creative.elements.length>0&&(this.F.MODE===s.y.ManageView&&1===this.loop&&(this.time=this.V()),this.S=1e3*this.time,this.T=requestAnimationFrame(this.B),this.isPlaying=!0,this.b.U(!0),this.emit("play",[this.time])),this}toggle(){return this.isPlaying?this.pause():this.play(),this}pause(){return this.isPlaying&&(this.R(),this.isPlaying=!1,this.b.U(!1),this.emit("pause",[this.time])),this}stop(){if(this.F.MODE!==s.y.VideoGenerator){const t=this.z();this.pause(),this.H(t)}this.emit("stop",[this.time])}seek(t){return t=Math.max(t,0)||0,this.time!==t&&(this.S=1e3*t,this.E=0,this.H(t),this.emit("seek",[this.time])),this}seekToElement(t){this.pause();const i=this.creative.elements.find((i=>i.id===t));if(i){const t=i.time+i.duration/2;this.seek(t)}else console.warn(`Tried to seek to element[${t}], but element does not exist`);return this}next(t=!0,i){const e=this.loop+(i||1);let n=!1;return this.b.feedStore&&(n=this.b.feedStore.loop<1,n&&this.b.feedStore.setFeedLoop(i||1)),this.setLoop(e,t,!n),this}prev(t=!0,i,e){const n=this.loop-(i||1);return this.b.feedStore&&this.b.feedStore.setFeedLoop(this.b.feedStore.loop-(i||1),e),this.setLoop(n,t,!1),this}replay(){return this.seek(0),this.emit("replay",[this.loop]),this}restart(){return this.F.MODE===s.y.VideoGenerator||(this.b.feedStore&&(this.b.feedStore.resetIndexState(),this.b.feedStore.skipNextIndexUpdate()),this.setLoop(1),this.play(),this.emit("restart",[this.loop])),this}W(t,i){this.Y(),this.b.X("number"==typeof t?t:this.time,i)}Z(t){this.creative=t}H(t,i){this.time=t,this.W(this.time,i)}setLoop(t,i=!0,e=!0){this.b.feedStore&&(e&&this.b.feedStore.setFeedLoop(this.b.feedStore.loop<0?this.b.feedStore.loop:t),this.b.feedStore.updateElementsCurrentIndex()),i?(this.S=0,this.E=0,this.H(0,!0)):this.W(this.time,!0),this.loop=Math.max(1,t),1===this.loop&&(this.time=this.V()),this.F.MODE!==s.y.VideoGenerator&&this.emit("loop",[this.loop])}addToQueue(t,i=[]){this.isPlaying?this.D.push({fn:t.bind(this),value:i}):t.bind(this)(...i)}updateCustomFPSInterval(t){this.k=t}addToQueueFromWidget(t,i){this.F.MODE!==s.y.VideoGenerator&&this.addToQueue(t,i)}Y(){if(this.isPlaying)for(let t=0;t<this.creative.elements.length;t++){const i=this.creative.elements[t],e=i.animations;this.$.has(i.id)||this.$.set(i.id,{visible:!1});const n=this.$.get(i.id);let s="none";const r=(0,c.q$)(e),h=(0,c.qF)(e);if(r&&(this.time>i.time&&this.time<r+i.time?s="inTransitionIn":"inTransitionIn"===n.animationState&&(this.time<=i.time||this.time>=r+i.time)&&(s="inTransitionOut")),h){const t=i.time+i.duration-h;this.time>t&&this.time<i.time+i.duration?s="outTransitionIn":"outTransitionIn"===n.animationState&&(this.time<t||this.time>=i.duration+i.time)&&(s="outTransitionOut")}(0,o.ZP)(i,this.time)?this.$.set(i.id,{visible:!0,animationState:s}):this.$.set(i.id,{visible:!1,animationState:s});const a=0===this.time&&0===i.time,u=this.time===i.duration+i.time,l=this.$.get(i.id);if((n.visible!==l.visible||a||u)&&((l.visible&&!u||a)&&"animationStarted"!==n.animationState?(l.animationState="animationStarted",this.emit("animation_start",[i])):(l.visible||a)&&!u||"animationEnded"===n.animationState||"none"===n.animationState&&0!==h||(l.animationState="animationEnded",this.emit("animation_end",[i]))),n.animationState!==this.$.get(i.id).animationState)switch(this.$.get(i.id).animationState){case"inTransitionOut":this.emit("in_transition_end",[i]);break;case"outTransitionIn":this.emit("out_transition_start",[i])}}}V(){return"number"==typeof this.creative.startTime?this.creative.startTime:0}z(){return"number"==typeof this.creative.stopTime?this.creative.stopTime:this.duration-1}R(){this.S=0,this.E=0,this.T&&(cancelAnimationFrame(this.T),this.T=void 0)}P(){return this.F.MODE===s.y.DesignView||!this.creative.loops}destroy(){this.C=!0,this.clearEvents(),this.R()}};u=(0,n.gn)([(0,n.fM)(0,(0,h.f3)(1)),(0,n.fM)(1,(0,h.f3)(3)),(0,n.fM)(2,(0,h.f3)(2)),(0,n.w6)("design:paramtypes",[r.EG,Object,Object])],u),(0,h.GY)(1,{},u,"creative",0),(0,h.GY)(3,{},u,"_renderer",1),(0,h.GY)(2,{},u,"_env",2)},354032240760973:(t,i,e)=>{e.d(i,{I:()=>r});var n=e(70225877371813),s=e(392686411906864);class r{constructor(t){if(this.type=s.M.Solid,this.stops=[],t)this.setColor(t);else{this.red=0,this.green=0,this.blue=0,this.hue=this.saturation=this.lightness=0,this.alpha=100;const t=(0,n.pV)(this.red,this.green,this.blue);this.hue=t.h,this.saturation=t.s,this.lightness=t.l}}get angle(){if(this.stops.length>1){const t=180*Math.atan2(this.end.position.y-this.start.position.y,this.end.position.x-this.start.position.x)/Math.PI;return Math.round((90+t)%360)}return 0}get start(){return this.stops[0]}get end(){return this.stops[this.stops.length-1]}copy(){return new r(this)}toJSON(){return this.toString()}toString(){switch(this.type){case s.M.Solid:return(0,n.xP)(this);case s.M.LinearGradient:return(0,n.Sz)(this)}}addColorStop(t,i,e){this.stops.push({color:t,offset:i,position:e})}setColor(t){return this.type=t.type,"solid"===t.type?(this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this.saturation=t.saturation,this.lightness=t.lightness,this.hue=t.hue):(this.alpha=t.alpha,this.stops=t.stops.map((t=>({color:(0,n.lu)(t.color),offset:t.offset,position:t.position?Object.assign({},t.position):void 0})))),this}static parse(t,i="#FFFFFF"){return(0,n.lu)(t,i)}}},70225877371813:(t,i,e)=>{e.d(i,{Aq:()=>v,D5:()=>d,Rc:()=>m,Sz:()=>F,Z0:()=>l,dF:()=>_,lu:()=>f,pV:()=>w,xP:()=>x});var n=e(354032240760973),s=e(392686411906864),r=e(23244914098722),o=e(50897836289296);const h=/^#[0-9a-fA-F]{3}$|^#[0-9a-fA-F]{6}$/,a=/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$/,c=/^rgba\((0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d),(0?(\.\d+)?|1(\.0)?)\)$/,u=/^rgb\(\s*(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d)\s*,\s*(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d)\s*,\s*(0|255|25[0-4]|2[0-4]\d|1\d\d|0?\d?\d)\s*\)$/;function l(t){return"fill"===t||"textColor"===t||"color"===t}function d(t){return h.test(t)||c.test(t)||u.test(t)||a.test(t)||0===t.indexOf("linear-gradient")}function f(t,i="#FFFFFF"){if(t instanceof n.I)return new n.I(t);if(!t)return f(i);const e=r.i.get(t);if(e)return e;let o;return t="string"==typeof t?t.replace(/,\s+/gi,","):t,o=h.test(t)||a.test(t)?function(t){"#"===t[0]&&(t=t.substring(1,t.length));const i=new n.I;3===t.length?(i.red=parseInt(t.substring(0,1)+t.substring(0,1),16),i.green=parseInt(t.substring(1,2)+t.substring(1,2),16),i.blue=parseInt(t.substring(2,3)+t.substring(2,3),16)):6===t.length?(i.red=parseInt(t.substring(0,2),16),i.green=parseInt(t.substring(2,4),16),i.blue=parseInt(t.substring(4,6),16)):(i.red=255,i.green=255,i.blue=255);const e=w(i.red,i.green,i.blue);return i.hue=e.h,i.saturation=e.s,i.lightness=e.l,i}(t):c.test(t)?v(t):u.test(t)?function(t){const i=new n.I,e=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/.exec(t.replace(/\s/g,""));e&&(i.red=parseInt(e[1],10),i.green=parseInt(e[2],10),i.blue=parseInt(e[3],10));const s=w(i.red,i.green,i.blue);return i.hue=s.h,i.saturation=s.s,i.lightness=s.l,i}(t):0===t.indexOf("linear-gradient")?function(t){const i=t.substring(t.indexOf("(")+1,t.lastIndexOf(")")).split(/,(?![^(]*\))(?![^"']*["'](?:[^"']*["'][^"']*["'])*[^"']*$)/);let e;i[0].indexOf("deg")>-1&&(e=parseInt(i.shift()||"0",10));return function(t,i){const e=new n.I;e.type=s.M.LinearGradient;const r=Math.PI*(i||0)/180,o=Math.cos(r),h=Math.sin(r);for(let n=0;n<t.length;n++){const s=t[n].split(" ");let r,a,c;void 0!==i?(r=s[0].trim(),a=parseInt(s[1],10),0!==n&&n!==t.length-1||(c=g(a,o,h))):(r=s[s.length-1],a=0===n?0:100,3===s.length?c={x:parseFloat(s[0]),y:parseFloat(s[1])}:a=parseFloat(s[0])),e.addColorStop(f(r),a,c)}return e}(i,e)}(t):f(i),r.i.set(t,o),o}function p(t,i,e,s=1){const r=new n.I;if(s>1||s<0)throw new Error("invalid alpha");r.red=t,r.green=i,r.blue=e,r.alpha=Math.round(100*s);const o=w(t,i,e);return r.hue=o.h,r.saturation=o.s,r.lightness=o.l,r}function v(t){const i=new n.I,e=/^rgba\(([^,]+),([^,]+),([^,]+),([^,]+)\)$/g.exec(t.replace(/\s/g,""));e&&(i.red=parseInt(e[1],10),i.green=parseInt(e[2],10),i.blue=parseInt(e[3],10),i.alpha=Math.round(100*parseFloat(e[4])));const s=w(i.red,i.green,i.blue);return i.hue=s.h,i.saturation=s.s,i.lightness=s.l,i}function m(t,...i){return function(t,...i){let e=0,s=0,r=0,h=0;const a={x:0,y:0},c={x:0,y:0};let u=0,l=0;if(i.forEach((i=>{var d;const f=i.color,p=(0,o.uZ)(i.amount,0,1),v="solid"!==f.type?[...f.stops]:[];if(e+=(f.red-t.red)*p,s+=(f.green-t.green)*p,r+=(f.blue-t.blue)*p,h+=(f.alpha-t.alpha)*p,null==v?void 0:v.length){if(2!==v.length)throw new Error("Tinting gradients with more than 2 stops is not supported currently");(null===(d=t.stops)||void 0===d?void 0:d.length)||(t.stops=[],v.forEach(((i,e)=>{const s=0===e?0:1;t.stops.push({color:new n.I(t),position:i.position?Object.assign({},i.position):{x:.5,y:s},offset:i.offset})})),t.type=i.color.type),u+=(v[0].offset-t.start.offset)*p,l+=(v[1].offset-t.end.offset)*p,v[0].position&&t.start.position&&v[1].position&&t.end.position&&(a.x+=(v[0].position.x-t.start.position.x)*p,a.y+=(v[0].position.y-t.start.position.y)*p,c.x+=(v[1].position.x-t.end.position.x)*p,c.y+=(v[1].position.y-t.end.position.y)*p)}})),t.stops.length){t.start.offset+=u,t.end.offset+=l,t.start.position={x:a.x+t.start.position.x,y:a.y+t.start.position.y},t.end.position={x:c.x+t.end.position.x,y:c.y+t.end.position.y};const e=i.map((t=>{var i;let e="linear-gradient"===t.color.type?new n.I(null===(i=t.color.start)||void 0===i?void 0:i.color):void 0;return e||(e=p(t.color.red,t.color.green,t.color.blue,t.color.alpha/100)),{color:e,amount:t.amount}})),s=i.map((t=>{var i;let e="linear-gradient"===t.color.type?new n.I(null===(i=t.color.end)||void 0===i?void 0:i.color):void 0;return e||(e=p(t.color.red,t.color.green,t.color.blue,t.color.alpha/100)),{color:e,amount:t.amount}}));t.start.color=m(t.start.color,...e),t.end.color=m(t.end.color,...s),t.alpha+=h}else t.red+=e,t.green+=s,t.blue+=r,t.alpha+=h;return t}(new n.I(t),...i)}function g(t,i,e){const n=1-t/100;return{x:0*i-e*(n-.5)+.5,y:i*(n-.5)+0*e+.5}}function w(t,i,e){t/=255,i/=255,e/=255;const n=Math.max(t,i,e),s=Math.min(t,i,e);let r,o;const h=(n+s)/2;if(n===s)r=o=0;else{const a=n-s;switch(o=h>.5?a/(2-n-s):a/(n+s),n){case t:r=(i-e)/a+(i<e?6:0);break;case i:r=(e-t)/a+2;break;case e:r=(t-i)/a+4}r/=6}return{h:r,s:o,l:h}}function b(t){return(0,o.uZ)(t,0,255)>>>0}function y(t){return((t=b(t))<16?"0":"")+t.toString(16).toUpperCase()}function _(t){if(t.type!==s.M.Solid)throw new Error("Cannot convert a none solid color to HEX format.");return`#${y(t.red)}${y(t.green)}${y(t.blue)}`}function x(t){if(t.type!==s.M.Solid)throw new Error("Cannot convert a none solid color to RGBA format.");return`rgba(${b(t.red)},${b(t.green)},${b(t.blue)},${(0,o.gH)(t.alpha/100)})`}function F(t){return`linear-gradient(${t.stops.map((i=>{const e=f(i.color);e.alpha=e.alpha*(t.alpha/100);let n="";return i.position?n=`${(0,o.gH)(i.position.x)} ${(0,o.gH)(i.position.y)}`:i.offset&&(n=`${(0,o.gH)(i.offset)}`),`${n} ${x(e)}`})).join(",")})`}},649763800171425:(t,i,e)=>{function n(t){return t.replace(/%20/g," ")}function s(t){return"object"==typeof t&&("id"in t&&"path"in t&&"step"in t)}e.d(i,{Tu:()=>s,nw:()=>n})},771982960687292:(t,i,e)=>{e.d(i,{E4:()=>h,M4:()=>o});var n=e(50897836289296),s=e(757159384577621),r=e(0xe9de428abe8e);function o(t,i,e={},n={}){return{type:"word",content:String.fromCharCode(t),style:(0,s.Vc)(i),top:0,left:0,width:0,height:0,lineHeight:0,attributes:(0,r.Xh)(e),styleIds:n.styleIds||{},styleId:n.styleId,__previousStyleIds:[...n.previousStyleIds||[]],__previousStyleIdToHistoryIndexMap:new Map(n.previousStyleIdToHistoryIndexMap||[])}}function h(t,i){return"newline"!==t.type&&"end"!==t.type&&(t.type===i.type&&(!!(0,s.dP)(t.styleIds,i.styleIds)&&(!!(0,s.ZJ)(t.__previousStyleIds,i.__previousStyleIds)&&function(t,i){const e=(0,n.CE)(t.style,"__fontFamilyId"),r=(0,n.CE)(i.style,"__fontFamilyId");if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(!(0,s.qA)(n,e,r))return!1;const o=(0,n.CE)(t.attributes,"shouldRenderNumber"),h=(0,n.CE)(i.attributes,"shouldRenderNumber");if(Object.keys(o).length!==Object.keys(h).length)return!1;for(const s in o)if(!(0,n.vZ)(t.attributes[s],i.attributes[s]))return!1;return!0}(t,i))))}},757159384577621:(t,i,e)=>{e.d(i,{$T:()=>m,Ag:()=>A,Kq:()=>p,O8:()=>w,RP:()=>v,Vc:()=>E,WT:()=>d,Yw:()=>C,ZJ:()=>x,dP:()=>_,ef:()=>b,gk:()=>g,qA:()=>F,tt:()=>y,xm:()=>l});var n=e(589259402348475),s=e(0xe9de428abe8e),r=e(50897836289296),o=e(354032240760973),h=e(680214823521203),a=e(649763800171425),c=e(771982960687292);function u(t){return 32===t||9===t||11===t||12===t||133===t||5760===t||t>=8192&&t<=8203||8287===t||12288===t||65279===t}function l(t){return void 0!==t&&"variable"===t.type}function d(t){return void 0!==t&&("word"===t.type||"space"===t.type||"newline"===t.type||"variable"===t.type)}function f(t){return 10===t||13===t||8232===t||8233===t||133===t}function p(t,i){if(t&&t.spans&&t.spans.length>0){let e=t.spans.length-1;"end"===t.spans[e].type&&e--;for(let n=0;n<t.spans.length;n++)i(t.spans[n],n)}}function v(t){switch(t){case"left":case"justify":return"flex-start";case"center":return"center";case"right":return"flex-end"}}function m(t){switch(t){case"top":return"flex-start";case"middle":return"center";case"bottom":return"flex-end"}}function g(t){return{style:(0,h.kG)(),spans:w(t).concat([{type:"end",content:"END",top:0,left:0,width:0,height:0,lineHeight:0,attributes:{},dir:"ltr"}])}}function w(t,i={},e,r,o,h,d,p){const v=[];let m,g;t="number"==typeof t?t.toString():t,(null==e?void 0:e.variable)&&t===n.I+(0,a.nw)(e.variable.path)&&(t=t.replace(/\s/g,"&nbsp;"));for(let n=0;n<t.length;n++){const a=t.charCodeAt(n);if(u(a))"space"===g?m.content+=String.fromCharCode(a):(m={top:0,left:0,type:"space",content:String.fromCharCode(a),attributes:(0,s.Xh)(i.attributes||{}),style:e?r(e):{},width:0,height:0,lineHeight:0,styleIds:h||{},styleId:o,__previousStyleIds:[...d||[]],__previousStyleIdToHistoryIndexMap:new Map(p||[])},v.push(m),g="space");else if(f(a))m={top:0,left:0,type:"newline",content:String.fromCharCode(a),width:0,height:0,lineHeight:0,style:e?r(e):{},attributes:(0,s.Xh)(i.attributes||{}),styleIds:h||{},styleId:o,__previousStyleIds:[...d||[]],__previousStyleIdToHistoryIndexMap:new Map(p||[])},v.push(m),g="newline";else if("word"===g||"variable"===g)m.content+=String.fromCharCode(a);else{if(e&&e.variable){let t={};t=r?r(e):e,m={type:"variable",content:String.fromCharCode(a),style:t,top:0,left:0,width:0,height:0,lineHeight:0,attributes:(0,s.Xh)(i.attributes||{}),styleIds:h||{},styleId:o,__previousStyleIds:[...d||[]],__previousStyleIdToHistoryIndexMap:new Map(p||[])}}else m=(0,c.M4)(a,null!=e?e:{},i.attributes,{styleId:o,styleIds:h,previousStyleIds:d,previousStyleIdToHistoryIndexMap:p});v.push(m),g=e&&e.variable?"variable":"word"}}for(const n of v)l(n)&&(n.content=n.content.replace(/\&nbsp\;/gi," ")),n.attributes.shouldRenderNumber=!1;return v}function b(t){return t.replace(/\\n/g,"\n").replace(/\\"/g,'"').replace(/\\'/g,"'").replace(/\\&/g,"&").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\f/g,"\f").replace(/\\\\/g,"\\").replace(/\\u2028/g,"\u2028").replace(/\\u2029/g,"\u2029").replace(/\\u0085/g,"")}function y(t){const i=null==t?void 0:t.value;if(!i)return!1;if("string"==typeof i)try{const t=JSON.parse(i);if(void 0!==t.text&&void 0!==t.styles)return!0}catch(e){}else try{if("object"==typeof i&&"text"in i&&void 0!==i.text&&void 0!==i.styles)return!0}catch(e){}return!1}function _(t,i){if(Object.keys(t).length!==Object.keys(i).length)return!1;for(const[e,n]of Object.entries(t))if(!i[e]||i[e]!==n)return!1;return!0}function x(t,i){return!(null==t?void 0:t.length)&&!(null==i?void 0:i.length)||(0,r.vZ)(t,i)}function F(t,i,e,n=!0){const s=e[t];if("$mixed"===s)return!1;const r=i[t];switch(t){case"uppercase":case"underscore":case"strikethrough":return n?!!r==!!s:r===s;case"font":{const t=s,i=r;return i===t||void 0!==t&&void 0!==i&&(t.id===i.id&&t.fontFamilyId===i.fontFamilyId&&t.style===i.style&&t.weight===i.weight&&t.src===i.src)}case"textColor":if(r===s)return!0;if(void 0===r||void 0===s)return!1;if(!(r instanceof o.I&&s instanceof o.I))throw new Error("Neither 'targetValue' nor 'sourceValue' is of type Color.");return r.toString()===s.toString();case"padding":const t=s,i=r;return i===t||void 0!==t&&void 0!==i&&(t.top===i.top&&t.bottom===i.bottom&&t.left===i.left&&t.right===i.right);case"textShadows":{const t=r,i=s;if(typeof i!=typeof t)return!1;if(i===t)return!0;if(i.length!==t.length)return!1;for(let e=0;e<t.length;e++){const n=t[e],s=i[e];if(!(n.blur===s.blur&&n.color===s.color&&n.offsetX===s.offsetX&&n.offsetY===s.offsetY&&n.spread===s.spread))return!1}return!0}default:return r===s}}function C(t){const i=[];for(const e of t)i.push(A(e));return i}function A(t){const i=(0,s.Xh)(t);if(d(t)){const e=i;e.styleId=t.styleId,e.style=(0,s.Xh)(t.style),e.styleIds=Object.assign({},t.styleIds||{}),t.__previousStyleIdToHistoryIndexMap&&(e.__previousStyleIdToHistoryIndexMap=new Map([...t.__previousStyleIdToHistoryIndexMap])),e.__previousStyleIds=(0,s.Xh)(t.__previousStyleIds)}return i}function E(t){const i={};for(const e in t)if(void 0!==t[e])switch(e){case"textColor":i[e]=t[e].copy();break;case"fontSize":i[e]=t[e];break;default:i[e]=(0,s.Xh)(t[e])}return i}Math.PI,Math.PI,Math.PI},359228699048257:(t,i,e)=>{var n,s,r;e.d(i,{BJ:()=>r,UI:()=>s,zu:()=>n}),function(t){t.ViewNodeChanged="viewNodeChange",t.PropertyChanged="propertyChanged",t.Resize="resize",t.Move="move",t.Click="click",t.MouseMove="mousemove",t.MouseOver="mouseover",t.MouseOut="mouseout",t.MouseDown="mousedown",t.MouseUp="mouseup",t.AnimationStart="animation_start",t.AnimationEnd="animation_end",t.InTransitionEnd="in_transition_end",t.OutTransitionStart="out_transition_start",t.TCData="tcdata",t.ShowPreloadImage="show_preload_image"}(n||(n={})),function(t){t.Click="click",t.MouseMove="mousemove",t.MouseOver="mouseover",t.MouseOut="mouseout",t.MouseDown="mousedown",t.MouseUp="mouseup",t.Mute="mute"}(s||(s={})),function(t){t.Play="play",t.Pause="pause",t.Stop="stop",t.Loop="loop",t.Restart="restart",t.Replay="replay",t.Seek="seek",t.Tick="tick"}(r||(r={}))},431962836110159:(t,i,e)=>{var n;e.d(i,{y:()=>n}),function(t){t[t.AnimatedCreative=0]="AnimatedCreative",t[t.ManageView=1]="ManageView",t[t.DesignView=2]="DesignView",t[t.ImageGenerator=3]="ImageGenerator",t[t.VideoGenerator=4]="VideoGenerator"}(n||(n={}))},442095885506762:(t,i,e)=>{e.d(i,{N:()=>s,_:()=>r});var n=e(50897836289296);const s="&t=",r=t=>{const i=(0,n.as)((0,n.Bw)(t));return{textParams:s+(0,n.nH)(i),distinctText:i}}},356676357306009:(t,i,e)=>{e.d(i,{EG:()=>a});var n=e(70225877371813),s=e(879126521801134),r=e(680214823521203);class o{constructor(){this.locked=!1,this.hidden=!1}}class h extends o{get elements(){return Object.freeze(this.Q)}get nodes(){return Object.freeze(this.G)}get J(){let t=0;for(const i of this.elements)(0,r.AA)(i)||i.time+i.duration>t&&(t=i.time+i.duration);return Math.round(100*t)/100}constructor(t){if(super(),this.Q=[],this.G=[],this.id=t.id,void 0===this.id)throw new Error(`No id was set when creating node ${this.name}`);this.kind=t.kind,t.nodes?this.K(t.nodes):t.elements&&this.K(t.elements)}K(t){this.G=t.slice(),this.G.forEach((t=>this.it(t))),this.et(t)}et(t){this.Q=(0,r.gu)(t);const i=this.__parentNode||this.__rootNode;null==i||i.et(i.nodes)}*nt(t=!1,i){i||(i=this);const e=i.nodes;switch(i.kind){case s.OH.Creative:case s.OH.Group:for(const i of e)if(i.kind===s.OH.Group){t&&(yield i);for(const e of this.nt(t,i))yield e}else yield i;break;default:throw new Error("Unknown group element.")}}it(t){(0,r.AA)(this)?(t.__rootNode=this.__rootNode,t.__parentNode=this):this instanceof a&&(t.__rootNode=this,t.__parentNode=void 0)}st(){const t=this;t.K(this.nodes.slice().reverse());for(const i of t.nodes)i instanceof h&&i.K(i.st().nodes);return t}ht(t,i){const e=this.nodes.slice();i=null!=i?i:this.nodes.length,this.it(t),e.splice(i,0,t),this.K(e)}at(t,i){for(const e of this.nt(i))if(e.id===t)return e}ct(t){const i=[],e=this.nodes;for(const n of e)n.id!==t&&((0,r.AA)(n)&&n.ct(t),i.push(n));this.K(i)}}class a extends h{get duration(){return this.J}constructor(t){super(Object.assign(Object.assign({},t),{kind:s.OH.Creative,nodes:t.nodes})),this.loops=0,this.guidelines=[],this.preserveEmptyChildren=!1,delete this.hidden,delete this.locked,delete this.name,this.width=t.width,this.height=t.height,this.fill=t.fill||(0,n.Aq)("rgba(255, 255, 255, 1)"),this.loops=t.loops||0,this.stopTime=t.stopTime,this.startTime=t.startTime,this.guidelines=t.guidelines||[],this.gifExport=Object.assign({frames:[],show:!1},t.gifExport),this.preloadImage=Object.assign({quality:70,format:"jpg",frames:[]},t.preloadImage),this.socialGuide=t.socialGuide}getFirstPreloadImageFrame(){return this.preloadImage.frames.length>0?this.preloadImage.frames[0]:1}ut(){return"number"==typeof this.stopTime?this.stopTime:this.duration-1}}},680214823521203:(t,i,e)=>{e.d(i,{kG:()=>g,oK:()=>D,qL:()=>F,sL:()=>x,Ul:()=>O,DL:()=>$,YC:()=>m,AA:()=>d,xj:()=>S,$Q:()=>l,ZP:()=>v,BM:()=>c,iN:()=>u,xs:()=>p,mO:()=>f,LY:()=>_,gu:()=>A,zX:()=>E});var n=e(879126521801134),s=e(919818021326992),r=e(375374058922245);n.OH.Rectangle,n.OH.Text,n.OH.Image,n.OH.Video,n.OH.Ellipse,n.OH.Button,n.OH.Widget;var o;!function(t){t.list="list",t.grid="grid",t.preview="preview"}(o||(o={}));function h(t){return Boolean(t&&"kind"in t)}function a(...t){return function(i){return!!h(i)&&-1!==t.findIndex((t=>i.kind===t))}}const c=a(n.OH.Button,n.OH.Text),u=(a(n.OH.Ellipse),a(n.OH.Rectangle),a(n.OH.Creative),a(n.OH.Video)),l=a(n.OH.Image);a(n.OH.Image,n.OH.Video);function d(t){return!!t&&a(n.OH.Group)(t)}const f=a(n.OH.Widget,n.OH.BannerflowLibraryWidget,n.OH.BannerflowLibraryWidgetInstance);function p(t){return void 0!==t&&"kind"in t&&(t.kind!==n.OH.Creative&&t.kind!==n.OH.Group&&t.__data)}function v(t,i){return!S(t)&&i>=t.time&&i<=t.time+t.duration}function m(t){return!function(t){return!(!t||"kind"in t&&"string"==typeof t.kind)}(t)&&!p(t)}function g(t){var i,e,n,s,r,o;return{padding:null!==(i=null==t?void 0:t.padding)&&void 0!==i?i:{top:0,left:0,right:0,bottom:0},verticalAlignment:null!==(e=null==t?void 0:t.verticalAlignment)&&void 0!==e?e:"top",maxRows:null!==(n=null==t?void 0:t.maxRows)&&void 0!==n?n:1/0,textOverflow:null!==(s=null==t?void 0:t.textOverflow)&&void 0!==s?s:"expand",characterSpacing:null!==(r=null==t?void 0:t.characterSpacing)&&void 0!==r?r:0,lineHeight:null!==(o=null==t?void 0:t.lineHeight)&&void 0!==o?o:1.3,__fontFamilyId:""}}const w=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];let b=1;function y(){return function(t){const i=w.length;if(t<=i)return w[t-1];const e=[];let n=t;for(;n>=i;){const t=n%i;n=(n-t)/i,e.push(w[t])}return e.push(w[n-1]),e.reverse().join("")}(b++)}function _(){b=1}function x(t,i,e,n){C(t,i,e,n)}function F(t,i,e,n){C(t,i,e,n)}function C(t,i,e,s){let o=[];if(h(t))switch(t.kind){case n.OH.Creative:case n.OH.Group:o=t.nodes;break;default:throw new Error("Unknown group element.")}else o=t;s&&(o=o.slice().reverse());let a=0;for(const n of o)d(n)?C(n,(t=>{i(t,n,a)}),e,s):("number"!=typeof e||(0,r.Uu)(n,e))&&i(n,void 0,a),a++}function A(t){const i=[];return F(t,(t=>{d(t)||i.push(t)})),i}function E(t){if(Array.isArray(t)&&t.every((t=>!d(t))))return t;const i=[],e="nodes"in t?t.nodes:t;for(const n of e.slice().reverse())d(n)?(i.unshift(n),i.unshift(...E(n))):-1===i.indexOf(n)&&i.unshift(n);return i}function S(t){return t.hidden||function(t){let i=!1;return O(t,(t=>{if(t.hidden)return i=!0,!0})),i}(t)}function O(t,i){if(!t)return;let e=t.__parentNode;for(;e;){if(i(e))return;e=e.__parentNode}}function $(t){const i={};for(const e of s.eK){const n=t[e];void 0!==n&&(i[e]=n)}return i}function D(t){if(d(t))throw new Error("View elements can not be created from a group node.");const i={kind:t.kind,__data:t,get __dirtyContent(){return i.__data.__dirtyContent}};return i.elementCid=y(),i.cidIndex=b,i.id=t.id,i.name=t.name,i.ratio=t.ratio,i.time=t.time,i.duration=t.duration,c(i)&&c(t)?(i.font=t.font,i.content=t.content):l(t)&&l(i)?i.feed=t.feed:f(i)&&f(t)&&(i.customProperties=t.customProperties),i}},392686411906864:(t,i,e)=>{var n;e.d(i,{M:()=>n}),function(t){t.Solid="solid",t.LinearGradient="linear-gradient"}(n||(n={}))},961342611394679:(t,i,e)=>{e.d(i,{De:()=>s,Iu:()=>r,Jr:()=>n});Object.keys({sizeMode:"enum",x:"number",y:"number",quality:"number",highDpi:"boolean"});var n;!function(t){t.Fit="fit",t.Stretch="stretch",t.Crop="crop"}(n||(n={}));const s=85,r={x:.5,y:.5,quality:s,sizeMode:n.Fit,highDpi:!1}},879126521801134:(t,i,e)=>{var n,s,r;e.d(i,{OH:()=>s}),function(t){t.Rectangle="Rectangle",t.Ellipse="Ellipse",t.Text="Text",t.Button="Button",t.Image="Image",t.Widget="Widget",t.Video="Video",t.Group="Group"}(n||(n={})),function(t){t.Creative="creative",t.Rectangle="rectangle",t.Text="text",t.Image="image",t.Video="video",t.Group="group",t.Ellipse="ellipse",t.Button="button",t.Widget="widget",t.BannerflowLibraryWidget="bannerflowLibraryWidget",t.BannerflowLibraryWidgetInstance="bannerflowLibraryWidgetInstance"}(s||(s={})),function(t){t.Creative="creative",t.Rectangle="shape-rectangle",t.Text="text",t.Video="video",t.Image="image",t.Group="group",t.AnyElement="any",t.Ellipse="shape-oval",t.Button="button",t.Widget="widget",t.BannerflowLibraryWidget="widget",t.BannerflowLibraryWidgetInstance="widget"}(r||(r={}))},919818021326992:(t,i,e)=>{e.d(i,{By:()=>g,eK:()=>u,lt:()=>o,ff:()=>w,RF:()=>b,Is:()=>m,Gc:()=>c,$5:()=>h,zI:()=>l});var n=e(50897836289296);const s="widgetReference",r="imageReference",o={font:"FontStyle",textColor:"Color",fontSize:"number",lineHeight:"number",characterSpacing:"number",uppercase:"boolean",underline:"boolean",strikethrough:"boolean",textShadows:"TextShadow[]",variable:"Feed",__fontFamilyId:"string"},h=Object.assign(Object.assign({},o),{maxRows:"integer",padding:"Padding",textOverflow:"enum",horizontalAlignment:"enum",verticalAlignment:"enum",textColor:"Color"});function a(t){return Object.keys(t)}const c=a(h),u=a((0,n.CE)(o,"__fontFamilyId")),l={js:"string",ts:"string",html:"string",css:"string",customProperties:"CustomProperty[]",[s]:"string",bannerflowLibraryWidgetReference:"string",select:"CustomProperty[]",number:"number",image:"ImageAsset",boolean:"boolean",color:"Color",widgetAsset:"WidgetAsset"},d={[r]:"string",imageAsset:"ImageAsset",imageSettings:"ImageSettings"},f={x:"number",y:"number",width:"number",height:"number",duration:"number",fill:"Color",originX:"number",originY:"number",rotationX:"number",rotationY:"number",rotationZ:"number",radius:"Radius",opacity:"number",shadows:"Shadow[]",filters:"FilterMap",border:"Border",hidden:"boolean",locked:"boolean",mirrorX:"boolean",mirrorY:"boolean",scaleX:"number",scaleY:"number",ratio:"number",feed:"Feed",states:"State[]",animations:"Animation[]",actions:"Action[]",time:"number",content:"text"},p=Object.assign(Object.assign({},(0,n.CE)(f,"states","animations","actions","feed","time","duration","hidden","locked","width","height","content")),{name:"string"}),v=Object.assign(Object.assign({},p),{textColor:"IColor"}),m=(Object.assign(Object.assign({},p),v),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h),l),d),{videoAsset:"VideoAsset",videoSettings:"VideoSettings"}),f),p)),g=(a(m),a(f),["x","y","width","height","scaleX","scaleY","fitPositionX","fitPositionY","radius","border","fontSize","padding","shadows","textShadows"]);const w={opacity:1},b={radius:0,opacity:0,scaleX:0,scaleY:0}},589259402348475:(t,i,e)=>{e.d(i,{I:()=>n});const n="@"},257140808400526:(t,i,e)=>{function n(t){return s(t,new Map)}function s(t,i){switch(Object.prototype.toString.call(t)){case"[object Array]":{if(i.has(t))return i.get(t);const e=t.slice(0);return i.set(t,e),e.forEach(((t,n)=>{e[n]=s(t,i)})),e}case"[object Object]":{if(i.has(t))return i.get(t);const e=Object.create(Object.getPrototypeOf(t));return i.set(t,e),Object.keys(t).forEach((n=>{"__widget"!==n&&(e[n]=s(t[n],i))})),e}default:return t}}e.d(i,{Xh:()=>n})},656188145953480:(t,i,e)=>{e.d(i,{GY:()=>h,KX:()=>c,T7:()=>r,f3:()=>o,hL:()=>a});const n=new Map;function s(t,i,e){let s=n.get(e);s||(s=new Map),s.set(t,i),n.set(e,s)}function r(t,i,e){const s=n.get(i);if(s)return s.get(t)}function o(t,i={}){return function(e,n,o){var h,a;const c=r("i",e)||new Map;c.set(o,{token:t,optional:null!==(h=i.optional)&&void 0!==h&&h,forwardRef:null!==(a=i.forwardRef)&&void 0!==a&&a}),s("i",c,e)}}function h(t,i={},e,n,o){var h,a;const c=r("i",e)||new Map;c.set(o,{token:t,optional:null!==(h=i.optional)&&void 0!==h&&h,forwardRef:null!==(a=i.forwardRef)&&void 0!==a&&a}),s("i",c,e)}function a(){return function(t,i,e){s("c",e,t)}}function c(t,i,e){s("c",e,t)}},344054454553173:(t,i,e)=>{e.d(i,{W2:()=>s});var n=e(656188145953480);class s{constructor(t){this.parent=t,this.dt=new Map,this.ft=new Map,this.pt=new Map,this.vt=new Map}mt(t,i){const e=(0,n.T7)("i",i),s=(0,n.T7)("p",i),r=(0,n.T7)("c",i);if(i instanceof Function){const n={target:i,parameterMap:e,parentParameterIndex:s,containerParameterIndex:r};this.dt.set(t,n)}else this.ft.set(t,i)}gt(t){this.dt.delete(t),this.ft.delete(t),this.vt.delete(t)}maybeResolve(t){const{target:i}=this.wt(t,!0);return i}clear(){this.pt.clear()}resolve(t,i=!1){const{target:e}=this.wt(t,i);if(!e)throw new Error(`Could not resolve token '${t}'.`);return e}bt(t,i){this.vt.set(t,i)}wt(t,i){const e=this.yt(t,0),n=[];if(e){const s=e.item;if("function"==typeof s.target){const r=e.container.pt.get(t);if(r)return{target:r,parentParameterIndex:void 0};const o=[];if(s.parameterMap)for(const[t,e]of s.parameterMap.entries()){const{target:s,parentParameterIndex:r}=this.wt(e.token,e.optional||i);if(s)n[t]=s,void 0!==r&&o.push({target:s,parentParameterIndex:r});else if(!i&&!e.optional)throw new Error(`Could not resolve symbol '${e.token}'.`)}void 0!==s.containerParameterIndex&&(n[s.containerParameterIndex]=this);const h=new s.target(...n);for(const t of o){let i=0;for(const e in t.target)i===t.parentParameterIndex&&(t.target[e]=h),i++}return e.container.pt.set(t,h),{target:h,parentParameterIndex:s.parentParameterIndex}}}const s=this.yt(t,2);if(s)return{target:s.item};const r=this.yt(t,1);return r?{target:r.item(r.container)}:{target:void 0}}yt(t,i){let e=this;for(;e;){let n;switch(i){case 0:n=e.dt.get(t);break;case 2:n=e.ft.get(t);break;case 1:n=e.vt.get(t)}if(void 0!==n)return{item:n,container:e};e=e.parent}}}},73235113624478:(t,i,e)=>{e.d(i,{S3:()=>r,mz:()=>s});Error;const n={enabled:!0,level:"error"};class s extends Error{constructor(t,i){super(t),this.message=t,this.contexts={widgetError:i}}}function r(t,i){let e;var s;e=(s=i)&&s.contexts?Object.assign(Object.assign({},n),i):Object.assign(Object.assign({},n),{contexts:{context:i}});const r=window.TrackerService;e.enabled&&r&&r.captureMessage(t,e.level,e.contexts),"error"===e.level?console.error(t,e.contexts):console.warn(t,e.contexts)}},651411520567126:(t,i,e)=>{e.d(i,{v:()=>n});class n{constructor(){this._t={},this.xt=null,this.skipEmission=!1}on(t,i,e){return"string"==typeof i?t=`${t}:${i}`:e=i,this._t[t]||(this._t[t]=[]),-1===this._t[t].indexOf(e)&&this._t[t].push(e),this}once(t,i,e){"string"==typeof i?t=`${t}:${i}`:e=i;const n=i=>{"function"==typeof e&&e.apply(this.xt,[i]),this.off(t,n)};return this.on(t,n),this}off(t,i,e){if(void 0!==i&&("string"==typeof i?t=`${t}:${i}`:e=i),void 0===t)return this.clearEvents(),this;if(!e)return delete this._t[t],this;const n=this._t[t];if(null==n?void 0:n.length){let t=n.length;for(;t-->0;)n[t]===e&&n.splice(t,1)}return this}emit(t,i,e){var n;if(this.skipEmission)return this;"string"==typeof i?t=`${t}:${i}`:e=i;const s=null===(n=this._t[t])||void 0===n?void 0:n.slice();if(s)for(const o of s)try{o.apply(this.xt,e||[])}catch(r){console.error("CallbackError: ",r)}return this}clearEvents(){this._t={}}}},577269179748313:(t,i,e)=>{e.d(i,{Bq:()=>o,Yt:()=>s,aR:()=>u,fy:()=>h,nH:()=>c,vd:()=>a});var n=e(50897836289296);function s(t){const i=function(t,i=0,e=!1){const{x:s,y:r,width:o,height:h,rotationZ:a}=t,c={x:s+o/2,y:r+h/2};let u={x:s+i,y:r+i},l={x:s+o-i,y:r+i},d={x:s+i,y:r+h-i},f={x:s+o-i,y:r+h-i};void 0!==a&&(u=(0,n.Hl)(u,c,-a),l=(0,n.Hl)(l,c,-a),d=(0,n.Hl)(d,c,-a),f=(0,n.Hl)(f,c,-a));const p={topLeft:u,topRight:l,bottomLeft:d,bottomRight:f};return e&&(p.center={x:(Math.min(u.x,l.x,d.x,f.x)+Math.max(u.x,l.x,d.x,f.x))/2,y:(Math.min(u.y,l.y,d.y,f.y)+Math.max(u.y,l.y,d.y,f.y))/2}),p}(t),e=Math.min(i.topLeft.x,i.bottomLeft.x,i.topRight.x,i.bottomRight.x),s=Math.min(i.topLeft.y,i.bottomLeft.y,i.topRight.y,i.bottomRight.y);return{x:e,y:s,width:Math.max(i.topLeft.x,i.bottomLeft.x,i.topRight.x,i.bottomRight.x)-e,height:Math.max(i.topLeft.y,i.bottomLeft.y,i.topRight.y,i.bottomRight.y)-s}}const r=(t,i)=>t.width===i.width&&t.height===i.height;function o(t,...i){return i.every((i=>r(t,i)))}function h(t){return{x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height}}function a(t,i,e="contain",n){const s="cover"===e?Math.max:Math.min,r=l(n),o=s(i.width/t.width,i.height/t.height);return c({width:r(t.width*o),height:r(t.height*o)},i,"center","center",n)}function c(t,i,e="center",n="center",s){const r=l(s),o=r(function(t,i,e="center"){const n=d(e);return(i.x||0)-(t-i.width)*n}(t.width,i,e)),h=r(function(t,i,e="center"){const n=d(e);return(i.y||0)-(t-i.height)*n}(t.height,i,n));return{x:o,y:h,width:t.width,height:t.height}}function u(t,i="round"){return Object.assign(Object.assign(Object.assign({},t),function(t,i="round"){const e=l(i),{x:n,y:s}=t;return{x:"number"==typeof n?e(n):n,y:"number"==typeof s?e(s):s}}(t,i)),function(t,i="round"){const e=l(i),{width:n,height:s}=t;return{width:"number"==typeof n?e(n):n,height:"number"==typeof s?e(s):s}}(t,i))}function l(t){return t&&"none"!==t?Math[t]:t=>t}function d(t){if("number"==typeof t)return(0,n.uZ)(t,0,1);switch(t){case"center":return.5;case"left":case"top":return 0;case"right":case"bottom":return 1}throw new Error(`Could not convert align '${t}' to number`)}},810692733885393:(t,i,e)=>{e.d(i,{Nm:()=>r,w6:()=>o});var n=e(584415190493052);const s=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi;function r(t){if(o(t=null==t?void 0:t.trim()))return t;throw new Error(`Error: unsafe URL value: "${t}" (see http://g.co/ng/security#xss)`)}function o(t){return!((t=t.trim())&&"#"!==t&&!(0,n.Zp)(t)&&!t.match(s))}},23244914098722:(t,i,e)=>{e.d(i,{i:()=>s});var n=e(0xe9de428abe8e);class s{static set(t,i){return this.cache.set(t,(0,n.Xh)(i)),i}static get(t){const i=this.cache.get(t);return(0,n.Xh)(i)}static clear(){this.cache.clear()}}s.cache=new Map},584415190493052:(t,i,e)=>{e.d(i,{$q:()=>p,A4:()=>v,C6:()=>u,CB:()=>a,Dg:()=>o,Ok:()=>b,Zp:()=>c,fm:()=>w,ge:()=>l,j3:()=>h,mD:()=>g,nZ:()=>m,qd:()=>d,r9:()=>f});var n=e(23244914098722);const s=/^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/?\n]+)/gim,r=/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/i;function o(t=""){const i={},e=n.i.get(t);if(e)return e;if(t&&t.indexOf("?")>-1)try{new URL(t).searchParams.forEach(((t,e)=>{i[e]=t}))}catch(s){let e;const n=/([^&=]+)=?([^&]*)/g,r=t=>{try{t=decodeURIComponent(t.replace(/\+/g," "))}catch(s){}return t},o=(t=t.substring(t.indexOf("?")+1))||window.location.search.substring(1);for(;e=n.exec(o);)i[r(e[1])]=r(e[2])}return n.i.set(t,i),i}function h(t){return!!t&&0!==t.replace(/^https?:/,"").indexOf("//")}function a(t){return"string"==typeof t&&!!t.match(r)}function c(t){return!!t&&t.startsWith("data:image")}function u(t="",i=""){return t.length&&i.length&&("/"!==t.charAt(t.length-1)&&(t+="/"),"/"===i.charAt(0)&&(i=i.substr(1))),t+i}function l(t,i=!0){if("string"==typeof t){const e=t.match(s);if(e)return i?function(t){return t.replace(/^((https?:)?\/\/)/gim,"")}(e[0]):e[0]}}function d(t){if(t)switch(t.toLowerCase()){case"1":case"on":case"true":case"yes":return!0;case"0":case"off":case"false":case"no":return!1;default:return}}function f(t,i){return i?t.replace(new URL(t).origin,new URL(i).origin):t}function p(t){if(!t)return!1;const i="function"==typeof URL?new URL(t).hostname:l(t,!0);return!!i&&!!i.match(/((bannerflow\.)|(studio\.local))/g)}function v(t,i){return l(t)===l(i)}function m(t,i=!0){if("object"==typeof t){const e=[];for(const n in t){const s=t[n];(void 0!==s&&s.toString()||!i)&&e.push(`${n}=${s}`)}return e.length?`?${e.join("&")}`:""}return""}function g(t){var i;if(t){const e=t.split(/[#?]/)[0].split(".");if(1===e.length)return;const n=null===(i=e.pop())||void 0===i?void 0:i.trim().toLowerCase();if(n)return/[a-zA-Z]/gi.test(n)?n:void 0}}function w(t){const i=g(t);return!!i&&/(mp4|mov|webm|h264)/.test(i)}function b(){return!!window&&"file:"===window.location.protocol}},50897836289296:(t,i,e)=>{function n(t,i=Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER){return Math.max(Math.min(t,e),i)}function s(t){return g(t,.01)}function r(t,i){return o(t,i)}function o(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;let e,n;if(Array.isArray(t)){if(e=t.length,e!==i.length)return!1;for(n=e;0!=n--;)if(!o(t[n],i[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();const s=Object.keys(t);if(e=s.length,e!==Object.keys(i).length)return!1;for(n=e;0!=n--;)if(!Object.prototype.hasOwnProperty.call(i,s[n]))return!1;for(n=e;0!=n--;){const e=s[n];if(!e.startsWith("__")&&!o(t[e],i[e]))return!1}return!0}return t!=t&&i!=i}function h(t,...i){const e={};for(const n of i)void 0!==t[n]&&(e[n]=t[n]);return e}function a(t,...i){const e=Object.assign({},t);for(const n of i)delete e[n];return e}function c(t){const i=Object.assign({},t);for(const e in t)void 0===i[e]&&delete i[e];return i}e.d(i,{Bw:()=>y,CE:()=>a,HZ:()=>f,Hl:()=>m,L8:()=>g,MN:()=>F,Yc:()=>c,as:()=>_,ei:()=>h,ej:()=>v,gH:()=>s,nH:()=>C,t7:()=>x,uZ:()=>n,vZ:()=>r,wQ:()=>A,xF:()=>E,yo:()=>p});const u={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},l=Object.assign(Object.assign({},u),{"‍":"&zwj;","‌":"&zwnj;"}),d=Object.assign({},l);function f(t){for(const i in d)t=t.replace(new RegExp(i,"g"),d[i]);return t}function p(t){for(const i in u)t=t.replace(new RegExp(u[i],"g"),i);return t=(t=t.replace(/\\n/g,"\n")).replace(/\\r/g,"\r")}!function(){const t=[];let i;for(let e=0;e<256;e++){i=e;for(let t=0;t<8;t++)i=1&i?3988292384^i>>>1:i>>>1;t[e]=i}}();function v(t){const i=`; ${document.cookie}`.split(`; ${t}=`);if(2===i.length)return i.pop().split(";").shift()}function m(t,i,e){const n=Math.cos(-e),s=Math.sin(-e);return{x:n*(t.x-i.x)-s*(t.y-i.y)+i.x,y:n*(t.y-i.y)+s*(t.x-i.x)+i.y}}function g(t,i){return Math.round(t/i)/(1/i)}function w(t,i){return t===i?0:typeof t==typeof i?t<i?-1:1:typeof t<typeof i?-1:1}const b=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935)/gi;function y(t){return t.replace(b,"")}function _(t){const i=t.normalize("NFC");return(t.normalize("NFKD")+i).split("").filter(((t,i,e)=>e.indexOf(t)===i)).sort(w).join("")}function x(t,i,e){return t+e*(i-t)}function F(t){return t}function C(t){return encodeURIComponent(t).replace(/[!'()*]/g,(function(t){return`%${t.charCodeAt(0).toString(16)}`}))}function A(t,i){return(t%i+i)%i}function E(t,i){return Array.from(new Set([...Object.keys(t),...Object.keys(i)])).filter((e=>t[e]!==i[e])).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:i[e]})),{})}},672562019417818:(t,i,e)=>{e.d(i,{fM:()=>s,gn:()=>n,w6:()=>r});function n(t,i,e,n){var s,r=arguments.length,o=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,e,n);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(o=(r<3?s(o):r>3?s(i,e,o):s(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o}function s(t,i){return function(e,n){i(e,n,t)}}function r(t,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,i)}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError}},s={};function r(t){var i=s[t];if(void 0!==i)return i.exports;var e=s[t]={exports:{}};return n[t](e,e.exports,r),e.exports}r.m=n,r.d=(t,i)=>{for(var e in i)r.o(i,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((i,e)=>(r.f[e](t,i),i)),[])),r.u=t=>({231:"feed",263:"widget",791:"video"}[t]+"."+{231:"ba4c78feed8e8de65939",263:"47bac3586a0622bf8637",791:"cc3e11ecbc273b5fb7d9"}[t]+".js"),r.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),i={},e="LIB:",r.l=(t,n,s,o)=>{if(i[t])i[t].push(n);else{var h,a;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var l=c[u];if(l.getAttribute("src")==t||l.getAttribute("data-webpack")==e+s){h=l;break}}h||(a=!0,(h=document.createElement("script")).charset="utf-8",h.timeout=120,r.nc&&h.setAttribute("nonce",r.nc),h.setAttribute("data-webpack",e+s),h.src=t),i[t]=[n];var d=(e,n)=>{h.onerror=h.onload=null,clearTimeout(f);var s=i[t];if(delete i[t],h.parentNode&&h.parentNode.removeChild(h),s&&s.forEach((t=>t(n))),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:h}),12e4);h.onerror=d.bind(null,h.onerror),h.onload=d.bind(null,h.onload),a&&document.head.appendChild(h)}},r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.p="scripts/",(()=>{var t={139:0};r.f.j=(i,e)=>{var n=r.o(t,i)?t[i]:void 0;if(0!==n)if(n)e.push(n[2]);else{var s=new Promise(((e,s)=>n=t[i]=[e,s]));e.push(n[2]=s);var o=r.p+r.u(i),h=new Error;r.l(o,(e=>{if(r.o(t,i)&&(0!==(n=t[i])&&(t[i]=void 0),n)){var s=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;h.message="Loading chunk "+i+" failed.\n("+s+": "+o+")",h.name="ChunkLoadError",h.type=s,h.request=o,n[1](h)}}),"chunk-"+i,i)}};var i=(i,e)=>{var n,s,[o,h,a]=e,c=0;if(o.some((i=>0!==t[i]))){for(n in h)r.o(h,n)&&(r.m[n]=h[n]);if(a)a(r)}for(i&&i(e);c<o.length;c++)s=o[c],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0},e=self.webpackChunkLIB=self.webpackChunkLIB||[];e.forEach(i.bind(null,0)),e.push=i.bind(null,e.push.bind(e))})();var o={};(()=>{var t;r.r(o),r.d(o,{AnimatedCreative:()=>ci,Color:()=>bt.I}),function(t){t.Render="render",t.Preload="preload",t.CreativeLoad="creativeload",t.Init="init",t.Click="click",t.ViewEnter="viewenter",t.ViewLeave="viewleave",t.IABViewEnter="iab_viewenter",t.IABViewLeave="iab_viewleave",t.PageReady="ready",t.Error="error",t.Destroy="destroy",t.Play="play",t.Stop="stop",t.Seek="seek",t.Loop="loop",t.Pause="pause",t.TCData="tcdata"}(t||(t={}));var i=r(526456703559590),e=r(347708221820546),n=r(584415190493052),s=r(431962836110159),h=r(70225877371813),a=r(757159384577621),c=r(680214823521203);function u(t){return Object.assign(Object.assign({},t),{fill:(0,h.lu)(t.fill),elements:t.elements.map((t=>function(t){const i=t.fill?(0,h.lu)(t.fill):void 0,e=Object.assign(Object.assign({},t),{fill:i});t.border&&(e.border={thickness:(n=t.border).thickness,style:n.style||"solid",color:(0,h.lu)(n.color)});var n;t.shadows&&(e.shadows=t.shadows.map(v));e.states=t.states.map(d),(0,c.BM)(e)&&(0,c.BM)(t)&&(e.textColor=(0,h.lu)(t.textColor),e.content=function(t){return{spans:t.content.spans.map(p),style:f(t.content.style)}}(t));(0,c.iN)(e)&&(0,c.iN)(t)&&(e.videoSettings=function(t){const i=t.videoSettings.playbackButton;return Object.assign(Object.assign({},t.videoSettings),{sizeMode:t.videoSettings.sizeMode,playbackRate:t.videoSettings.playbackRate,playbackButton:Object.assign(Object.assign({},i),{color:(0,h.lu)(i.color)})})}(t));return e}(t)))})}function l(t,i){for(const e of i)if(e.id===t)return e.value;throw new Error("Could not find font style in preload assets.")}function d(t){return function t(i){for(const e in i){const n=i[e];let s;s="object"==typeof n?t(n):"string"==typeof n&&(0,h.Z0)(e)&&(0,h.D5)(n)?(0,h.lu)(n):n,i[e]=s}return i}(t)}function f(t){const i=t;for(const e in i){const t=i[e];(0,h.Z0)(e)&&(0,h.D5)(t)&&(i[e]=(0,h.lu)(t)),"textShadow"===e&&(0,h.Z0)(e)&&(0,h.D5)(t)&&(i[e]=(0,h.lu)(t))}return i}function p(t){return(0,a.WT)(t)&&t.style.textColor&&(t.style.textColor=(0,h.lu)(t.style.textColor)),t.content=(0,a.ef)(t.content),t}function v(t){return Object.assign(Object.assign({},t),{color:(0,h.lu)(t.color)})}var m=r(344054454553173);function g(t,i){if(!t)return!1;if(t===i)return!0;let e=i.parentNode;for(;e;){if(e===t)return!0;e=e.parentNode}return!1}const w=new Map,b=new Map;async function y(t,i){const e=x(t,i);let n=w.get(t.id);const s=b.get(t.id);if(n&&s===e)return await n.load();if(!e)throw new Error("Unknown font style.");return n=new FontFace(`f-${t.id}`,`url(${e})`),w.set(t.id,n),b.set(t.id,e),await n.load()}function _(t,i,e){const s=x(i,e);if(!s)throw new Error("Failed to get URL of font style");const r=`f-${i.id}`,o=(h=s,null===(a=(0,n.Dg)(h).u)||void 0===a?void 0:a.split(".").pop());var h,a;const c=t.createElement("style"),u=t.createElement("link");u.rel="preload",u.href=s,u.as="font",u.type=`font/${o}`,u.crossOrigin="",c.textContent=`\n                        @font-face {\n                          font-family: '${r}';\n                          src: url(${s}) format('${o}');\n                        }\n                      `,t.head.appendChild(u),t.head.appendChild(c)}function x(t,i){var e,s;let r=t.src||t.fontUrl;return("undefined"==typeof process||"test"!==(null===(e=window.bfstudio)||void 0===e?void 0:e.environment.stage)&&process.env.STUDIO_JS)&&window.bfstudio&&(r=(0,n.r9)(r,process.env.FONTS_AZURE_STORAGE_CDN_ORIGIN)),"undefined"!=typeof process&&"test"===(null===(s=window.bfstudio)||void 0===s?void 0:s.environment.stage)||!i||(r=(0,n.r9)(r,i)),r}function F(t){performance&&performance.mark&&performance.mark(t)}new Map;var C=r(810692733885393);function A(t,i){i=i&&(0,C.Nm)(i);const e=new E;return t.onload=()=>{e.resolve(t)},t.onerror=t=>{e.reject(t)},"string"==typeof i&&(t.src=i),e}class E{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}}var S=r(50897836289296);let O,$;const D={sin:Math.sin,cos:Math.cos,pi:Math.PI,PI:Math.PI,abs:Math.abs,round:Math.round,ceil:Math.ceil,floor:Math.floor,pow:Math.pow,sqrt:Math.sqrt,random:Math.random};let B=!1;const j=new Function("code","\n    try {\n        context.eval = eval;\n        context.code = code;\n    } catch(e) {\n        var context = window.context || {};\n        context.eval = eval;\n        context.code = code;\n    }\n    const scopeProxy = new Proxy(context, {\n        has(prop) { return !(prop in context) },\n        get(target, prop) {\n            if (prop in target) {\n                return target[prop];\n            }\n            if (!(typeof prop === 'symbol')) {\n                throw new Error(`Unexpected token '${prop.toString()}'.`);\n            }\n        }\n    });\n    with (scopeProxy) {\n        return eval(code);\n    }");class M{static eval(t,i={}){if(O||M.init(),B)return window.context=Object.assign(Object.assign({},D),i),j(t);const e=null==O?void 0:O.contentWindow,n=(null==O?void 0:O.contentDocument)&&(null==e?void 0:e.evalMathExpression);if(!n||!e)throw new Error("Safe eval iframe is not initiated.");return e.context=Object.assign(Object.assign({},D),i),n(t)}static async init(t){var i,e;if($)return $;if(!O&&"undefined"!=typeof window){O=document.createElement("iframe");const s=O.style;s.position="absolute",s.pointerEvents="none",s.width=s.height=s.opacity=s.top=s.left="0",$=A(O).promise,document.body.appendChild(O),await $;const r=O.contentDocument;if(t||!r)B=t||!r;else{const t=(null===(e=null===(i=null===window||void 0===window?void 0:window.process)||void 0===i?void 0:i.env)||void 0===e?void 0:e.STUDIO_JS)?(0,S.ej)("script-nonce"):"";try{const i=document.createElement("script"),e=URL.createObjectURL(new Blob([`window.evalMathExpression = ${j.toString()}`]));i.nonce=t,i.src=e;const n=A(i).promise;r.head.appendChild(i),await n,URL.revokeObjectURL(e)}catch(n){r.open(),r.write(`<!DOCTYPE html><html><head><script nonce="${t}">window.evalMathExpression = ${j.toString()}<\/script></head></html>`),r.close()}}}return O}static destroy(){O&&(document.body.removeChild(O),O=void 0)}}var I=r(290484402537373);class k{constructor(t,i,e){const n=e.resolve(11);this.Ft=n(i),this.Ct=e.resolve(5),this.At=this.Ft.feedStore}}var T,R,L=r(672562019417818),z=r(593984402815064),P=r(771982960687292),N=r(919818021326992),H=r(589259402348475),V=r(0xe9de428abe8e),U=r(656188145953480),W=r(73235113624478),Y=r(651411520567126);!function(t){t.SetState="SET_STATE",t.RemoveState="REMOVE_STATE",t.ClearStates="CLEAR_STATES",t.OpenUrl="OPEN_URL"}(T||(T={})),function(t){t.Click="click",t.MouseDown="mousedown",t.MouseUp="mouseup",t.MouseEnter="mouseenter",t.MouseLeave="mouseleave",t.TouchStart="touchstart",t.TouchEnd="touchend",t.TouchCancel="touchcancel"}(R||(R={}));var X=r(375374058922245);function Z(t="linear"){return q[t].func}const q={linear:{name:"Linear",type:"none",func:t=>t},easeInExpo:{name:"InExpo",type:"in",func:t=>0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:{name:"OutExpo",type:"in",func:t=>1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:{name:"InOutExpo",type:"inout",func:t=>0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInQuad:{name:"InQuad",type:"in",func:t=>t*t},easeOutQuad:{name:"OutQuad",type:"out",func:t=>t*(2-t)},easeInOutQuad:{name:"InOutQuad",type:"inout",func:t=>t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:{name:"InCubic",type:"in",func:t=>t*t*t},easeOutCubic:{name:"OutCubic",type:"out",func:t=>--t*t*t+1},easeInOutCubic:{name:"InOutCubic",type:"inout",func:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:{name:"InQuart",type:"in",func:t=>t*t*t*t},easeOutQuart:{name:"OutQuart",type:"out",func:t=>1- --t*t*t*t},easeInOutQuart:{name:"InOutQuart",type:"inout",func:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:{name:"InQuint",type:"in",func:t=>t*t*t*t*t},easeOutQuint:{name:"OutQuint",type:"out",func:t=>1+--t*t*t*t*t},easeInOutQuint:{name:"InOutQuint",type:"inout",func:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},easeInElastic:{name:"InElastic",type:"in",func:t=>1===t?1:.04*t/--t*Math.sin(25*t)},easeOutElastic:{name:"OutElastic",type:"out",func:t=>0===t?0:(.04-.04/t)*Math.sin(25*t)+1},easeInOutElastic:{name:"InOutElastic",type:"inout",func:t=>.5===t?.5:(t-=.5)<0?(.02+.01/t)*Math.sin(50*t):(.02-.01/t)*Math.sin(50*t)+1},easeInBack:{name:"InBack",type:"in",func:t=>{let i=1;return i||0===i||(i=1.70158),1*t*t*((i+1)*t-i)}},easeOutBack:{name:"OutBack",type:"out",func:t=>{let i=1;return i||0===i||(i=1.70158),(t-=1)*t*((i+1)*t+i)+1}},easeInOutBack:{name:"InOutBack",type:"inout",func:t=>{let i=1;return void 0===i&&(i=1.70158),(t/=.5)<1?t*t*((1+(i*=1.525))*t-i)*.5:.5*((t-=2)*t*((1+(i*=1.525))*t+i)+2)}},easeInBounce:{name:"InBounce",type:"in",func:t=>1-Q(1-t)},easeOutBounce:{name:"OutBounce",type:"out",func:t=>Q(t)},easeInOutBounce:{name:"InOutBounce",type:"inout",func:t=>t<.5?.5*Q(2*t):.5*Q(2*t-1)+.5}};function Q(t){return t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375}tt("0651\n0652\n0670\n0640\n0627\n064C-065F");const G=tt("0041-005A\n0061-007A\n00AA\n00B5\n00BA\n00C0-00D6\n00D8-00F6\n00F8-0220\n0222-0233\n0250-02AD\n02B0-02B8\n02BB-02C1\n02D0-02D1\n02E0-02E4\n02EE\n037A\n0386\n0388-038A\n038C\n038E-03A1\n03A3-03CE\n03D0-03F5\n0400-0482\n048A-04CE\n04D0-04F5\n04F8-04F9\n0500-050F\n0531-0556\n0559-055F\n0561-0587\n0589\n0903\n0905-0939\n093D-0940\n0949-094C\n0950\n0958-0961\n0964-0970\n0982-0983\n0985-098C\n098F-0990\n0993-09A8\n09AA-09B0\n09B2\n09B6-09B9\n09BE-09C0\n09C7-09C8\n09CB-09CC\n09D7\n09DC-09DD\n09DF-09E1\n09E6-09F1\n09F4-09FA\n0A05-0A0A\n0A0F-0A10\n0A13-0A28\n0A2A-0A30\n0A32-0A33\n0A35-0A36\n0A38-0A39\n0A3E-0A40\n0A59-0A5C\n0A5E\n0A66-0A6F\n0A72-0A74\n0A83\n0A85-0A8B\n0A8D\n0A8F-0A91\n0A93-0AA8\n0AAA-0AB0\n0AB2-0AB3\n0AB5-0AB9\n0ABD-0AC0\n0AC9\n0ACB-0ACC\n0AD0\n0AE0\n0AE6-0AEF\n0B02-0B03\n0B05-0B0C\n0B0F-0B10\n0B13-0B28\n0B2A-0B30\n0B32-0B33\n0B36-0B39\n0B3D-0B3E\n0B40\n0B47-0B48\n0B4B-0B4C\n0B57\n0B5C-0B5D\n0B5F-0B61\n0B66-0B70\n0B83\n0B85-0B8A\n0B8E-0B90\n0B92-0B95\n0B99-0B9A\n0B9C\n0B9E-0B9F\n0BA3-0BA4\n0BA8-0BAA\n0BAE-0BB5\n0BB7-0BB9\n0BBE-0BBF\n0BC1-0BC2\n0BC6-0BC8\n0BCA-0BCC\n0BD7\n0BE7-0BF2\n0C01-0C03\n0C05-0C0C\n0C0E-0C10\n0C12-0C28\n0C2A-0C33\n0C35-0C39\n0C41-0C44\n0C60-0C61\n0C66-0C6F\n0C82-0C83\n0C85-0C8C\n0C8E-0C90\n0C92-0CA8\n0CAA-0CB3\n0CB5-0CB9\n0CBE\n0CC0-0CC4\n0CC7-0CC8\n0CCA-0CCB\n0CD5-0CD6\n0CDE\n0CE0-0CE1\n0CE6-0CEF\n0D02-0D03\n0D05-0D0C\n0D0E-0D10\n0D12-0D28\n0D2A-0D39\n0D3E-0D40\n0D46-0D48\n0D4A-0D4C\n0D57\n0D60-0D61\n0D66-0D6F\n0D82-0D83\n0D85-0D96\n0D9A-0DB1\n0DB3-0DBB\n0DBD\n0DC0-0DC6\n0DCF-0DD1\n0DD8-0DDF\n0DF2-0DF4\n0E01-0E30\n0E32-0E33\n0E40-0E46\n0E4F-0E5B\n0E81-0E82\n0E84\n0E87-0E88\n0E8A\n0E8D\n0E94-0E97\n0E99-0E9F\n0EA1-0EA3\n0EA5\n0EA7\n0EAA-0EAB\n0EAD-0EB0\n0EB2-0EB3\n0EBD\n0EC0-0EC4\n0EC6\n0ED0-0ED9\n0EDC-0EDD\n0F00-0F17\n0F1A-0F34\n0F36\n0F38\n0F3E-0F47\n0F49-0F6A\n0F7F\n0F85\n0F88-0F8B\n0FBE-0FC5\n0FC7-0FCC\n0FCF\n1000-1021\n1023-1027\n1029-102A\n102C\n1031\n1038\n1040-1057\n10A0-10C5\n10D0-10F8\n10FB\n1100-1159\n115F-11A2\n11A8-11F9\n1200-1206\n1208-1246\n1248\n124A-124D\n1250-1256\n1258\n125A-125D\n1260-1286\n1288\n128A-128D\n1290-12AE\n12B0\n12B2-12B5\n12B8-12BE\n12C0\n12C2-12C5\n12C8-12CE\n12D0-12D6\n12D8-12EE\n12F0-130E\n1310\n1312-1315\n1318-131E\n1320-1346\n1348-135A\n1361-137C\n13A0-13F4\n1401-1676\n1681-169A\n16A0-16F0\n1700-170C\n170E-1711\n1720-1731\n1735-1736\n1740-1751\n1760-176C\n176E-1770\n1780-17B6\n17BE-17C5\n17C7-17C8\n17D4-17DA\n17DC\n17E0-17E9\n1810-1819\n1820-1877\n1880-18A8\n1E00-1E9B\n1EA0-1EF9\n1F00-1F15\n1F18-1F1D\n1F20-1F45\n1F48-1F4D\n1F50-1F57\n1F59\n1F5B\n1F5D\n1F5F-1F7D\n1F80-1FB4\n1FB6-1FBC\n1FBE\n1FC2-1FC4\n1FC6-1FCC\n1FD0-1FD3\n1FD6-1FDB\n1FE0-1FEC\n1FF2-1FF4\n1FF6-1FFC\n200E\n2071\n207F\n2102\n2107\n210A-2113\n2115\n2119-211D\n2124\n2126\n2128\n212A-212D\n212F-2131\n2133-2139\n213D-213F\n2145-2149\n2160-2183\n2336-237A\n2395\n249C-24E9\n3005-3007\n3021-3029\n3031-3035\n3038-303C\n3041-3096\n309D-309F\n30A1-30FA\n30FC-30FF\n3105-312C\n3131-318E\n3190-31B7\n31F0-321C\n3220-3243\n3260-327B\n327F-32B0\n32C0-32CB\n32D0-32FE\n3300-3376\n337B-33DD\n33E0-33FE\n3400-4DB5\n4E00-9FA5\nA000-A48C\nAC00-D7A3\nD800-FA2D\nFA30-FA6A\nFB00-FB06\nFB13-FB17\nFF21-FF3A\nFF41-FF5A\nFF66-FFBE\nFFC2-FFC7\nFFCA-FFCF\nFFD2-FFD7\nFFDA-FFDC\n10300-1031E\n10320-10323\n10330-1034A\n10400-10425\n10428-1044D\n1D000-1D0F5\n1D100-1D126\n1D12A-1D166\n1D16A-1D172\n1D183-1D184\n1D18C-1D1A9\n1D1AE-1D1DD\n1D400-1D454\n1D456-1D49C\n1D49E-1D49F\n1D4A2\n1D4A5-1D4A6\n1D4A9-1D4AC\n1D4AE-1D4B9\n1D4BB\n1D4BD-1D4C0\n1D4C2-1D4C3\n1D4C5-1D505\n1D507-1D50A\n1D50D-1D514\n1D516-1D51C\n1D51E-1D539\n1D53B-1D53E\n1D540-1D544\n1D546"),J=tt("200F"),K=tt("05BE\n05C0\n05C3\n05D0-05EA\n05F0-05F4\n061B\n061F\n0621-063A\n0640-064A\n066D-066F\n0671-06D5\n06DD\n06E5-06E6\n06FA-06FE\n0700-070D\n0710\n0712-072C\n0780-07A5\n07B1\n200F\nFB1D\nFB1F-FB28\nFB2A-FB36\nFB38-FB3C\nFB3E\nFB40-FB41\nFB43-FB44\nFB46-FBB1\nFBD3-FD3D\nFD50-FD8F\nFD92-FDC7\nFDF0-FDFC\nFE70-FE74\nFE76-FEFC");function tt(t){const i=[],e=t.split("\n");for(const n of e){const t=n.trim();if(""===t)continue;const e=t.split("-");1===e.length?i.push([parseInt(e[0],16)]):i.push([parseInt(e[0],16),parseInt(e[1],16)])}return i}const it='Helvetica, Arial, Tahoma, "Microsoft Yahei", 微软雅黑, STXihei, 华文细黑, sans-serif';let et=class t extends Y.v{constructor(t,i,e,n,s,r,o){super(),this.Et=t,this.St=i,this.Ot=e,this.F=n,this.$t=s,this.Dt=r,this.Bt=o,this.jt=[],this.Mt=new Map,this.It=new Map,this.kt=!1,this.Tt=[],this.Rt=0,this.Lt=0,this.zt=new Map,this.Pt=0,this.Nt=[],this.Ht=[],this.Vt=1,this.Ut=0,this.Wt=0,this.Xt=(t,i,e,n=!0,s,r=!1,o)=>{var h,c;const u=this;this.Zt||(this.Zt=u.qt(),i.push(this.Zt),this.Wt=0),(0,a.xm)(t)&&(t.content=t.content.replace(/%20/gi," "));const l=this.Qt(t,n,o),d=t.style&&t.style.fontSize||this.Gt,f=t.style&&t.style.lineHeight||this.style.lineHeight;if(t.top=(f-1)*d/2,t.width=l.width,t.height=l.height-(f-1)*d,t.lineHeight=l.height,"end"===t.type)return void function(t){if(u.Zt.spans.push(t),u.Jt(),u.Zt.isLastLine=!0,u.Kt(i,e,s),u.kt)return;u.ti=void 0}(t);if("newline"===t.type)return void function(t){if(u.ii="newline",!u.style.maxRows||u.Pt<u.style.maxRows){if(u.Zt.spans.push(t),u.Jt(),u.Zt.endsWithNewline=!0,u.Kt(i,e,s),u.kt)return;(!u.style.maxRows||u.Pt<u.style.maxRows)&&(u.Zt=u.qt(),u.Lt=0,i.push(u.Zt),u.Pt++),u.ti=void 0}else u.Zt.spans.push({type:"space",attributes:{},dir:"infer",top:0,left:0,width:t.width,height:0,lineHeight:0,content:" ",style:(0,V.Xh)(t.style),styleIds:{},__previousStyleIds:[],__previousStyleIdToHistoryIndexMap:new Map}),u.Jt()}(t);const p=t.style.fontSize?this.Gt*t.style.fontSize:this.Gt,v=(null!==(h=t.style.characterSpacing)&&void 0!==h?h:this.style.characterSpacing)*p,m=this.Lt+t.width+(t.attributes.shouldRenderNumber?4:0)-v,g=(null!==(c=this.style.width)&&void 0!==c?c:0)-this.style.padding.left-this.style.padding.right;if(!r&&"truncate"===this.style.textOverflow&&("word"===t.type||"variable"===t.type)&&m>g)return void function(t){var n;const{preContentSpan:r,postContentSpan:h}=function(t){if(!u.Zt)throw new Error("Current content line is not set.");const i=t.content.length,e=(0,a.Ag)(t);for(let n=1;n<=i;n++){e.content=t.content.substring(0,n);const s=u.Qt(e,!0),r=n===i&&t.attributes.shouldRenderNumber?4:0,o=u.style.width-u.style.padding.left-u.style.padding.right;if(u.Lt+s.width+r-v>o)return u.ni(t,n-1)}throw new Error("Could not split span.")}(t),c=[h].concat(s);if(r.content){if(u.Xt(r,i,e,!0,c,!1,o),u.kt)return}else if(0===u.Lt)return u.kt=!0,e.shouldAbort=!0,u.si(i);if(u.Jt(),u.Kt(i,e,c),u.kt)return;const l=!u.style.maxRows||u.Pt<u.style.maxRows;(null===(n=u.Dt)||void 0===n?void 0:n.inEditMode)||l?(u.Zt=u.qt(),u.Pt++,u.Lt=0,u.Wt=0,i.push(u.Zt),u.Xt(h,i,e,!0,s,!1,o)):u.ri(i,[h].concat(s),e)}(t);"space"===this.ii&&("word"===t.type||"variable"===t.type)&&(this.ti=this.Zt.spans.length);const w=this.Wt+t.width-v>=g;function b(){u.Wt+=t.width,t.attributes&&t.attributes.shouldRenderNumber&&(u.Wt+=4),u.ii=t.type}!r&&void 0!==this.ti&&"space"!==t.type&&"composition"!==t.type&&w&&0!==this.Zt.spans.length?function(t){var r,h,a;const c=!u.style.maxRows||u.Pt<u.style.maxRows;if((null===(r=u.Dt)||void 0===r?void 0:r.inEditMode)&&"truncate"===u.style.textOverflow||c){const r=u.Zt.spans.splice(u.ti,1/0);u.Jt();const a=r.concat([t]);if(u.Kt(i,e,a.concat(s)),u.kt)return;if(u.Zt=u.qt(),i.push(u.Zt),u.Pt++,(null===(h=u.Dt)||void 0===h?void 0:h.inEditMode)||"truncate"!==u.style.textOverflow){u.Lt+=t.width+(t.attributes.shouldRenderNumber?4:0),u.Lt>u.Ut&&(u.Ut=u.Lt),u.Zt.spans.push(...a);let i=0;for(const t of a)i+=t.width;u.Wt=i}else{u.Lt=0;for(let t=0;t<a.length;t++){if(u.kt)return;u.Xt(a[t],i,e,n,a.slice(t+1).concat(s),void 0,o)}}}else u.Zt.spans.push(t),u.Jt(),(null===(a=u.Dt)||void 0===a?void 0:a.inEditMode)||"truncate"!==u.style.textOverflow||u.ri(i,s,e),b();t.attributes&&t.attributes.shouldRenderNumber&&(u.Wt+=4);u.ii=t.type,u.ti=void 0}(t):function(t){u.Zt.lineWidth+=t.width,u.Zt.spans.push(t),"word"===t.type||"variable"===t.type?(u.Lt+=t.width+(t.attributes.shouldRenderNumber?4:0),u.Lt>u.Ut&&(u.Ut=u.Lt)):u.Lt=0;b()}(t)},this.oi=t=>{if(this.hi()||!this.At)return;const i=t.currentTarget.id,e=this.ai(i);if(e&&this.ci(e)){const n=this.At.getFeedValue(e.feed,i,e.element);this.ui(t,n.targetUrl)}},this.Tt=(0,a.Yw)(this.Et.spans),this.style=this.li=Object.assign({},this.Et.style),this.di(),this.fi(),this.vi=e.renderUnderscoreLayer,this.mi=e.element,this.gi=e.viewElement,this.At=e.feedStore,this.wi=!!e.skipFontLoad}get bi(){var t;return null===(t=this.Dt)||void 0===t?void 0:t.selection.selection}set bi(t){this.Dt&&(this.Dt.selection.selection=t)}get yi(){var t;return(null===(t=this.$t)||void 0===t?void 0:t.zoom)||1}get selectedCharacters(){if(!this.bi)return"";let t="";for(const i of this.Tt)"variable"===i.type&&i.style.variable?t+=this._i(i):"word"===i.type&&(void 0!==i.line&&void 0!==i.column||(t+=i.content));return t}_i(t){var i;const e=this.At.getFeed(t.style.variable.id),n=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.map((i=>{var e,n;return null!==(n=null===(e=i[t.style.variable.path||""])||void 0===e?void 0:e.value)&&void 0!==n?n:""})).join("");return null!=n?n:""}n(){this.xi(),this.Fi=new Promise((async t=>{await this.Ci(),this.Ai(!1),t()}))}fi(){this.St.style.backgroundColor="transparent",this.Ei=document.createElement("div"),this.Ei.classList.add("center");const t=this.Ei.style;t.width="100%",t.height="100%",t.display="flex",t.alignItems=(0,a.$T)(this.style.verticalAlignment),t.justifyContent=(0,a.RP)(this.style.horizontalAlignment),this.Si=document.createElement("div"),this.Si.classList.add("text-content"),this.Si.style.outline="none",this.Si.style.position="relative",this.Si.style.width="100%",this.Si.spellcheck=!1,this.Ei.appendChild(this.Si),this.St.appendChild(this.Ei)}resetDirtyContent(t){t.__dirtyContent=void 0}setText(t,i,e,n){this.Et=t,this.Tt=t.spans,e?this.zt=new Map:this.Oi(),n||(this.style=t.style),this.di(),this.Ai(!e),this.emit("change",[this.$i()])}Di(){var t;(null===(t=this.Dt)||void 0===t?void 0:t.inEditMode)&&this.Dt.stopEdit(!0),this.Nt=[];for(const i of this.Nt)i.element.removeEventListener("mousedown",i.callback);this.Bi(),this.Dt&&(window.removeEventListener("mouseup",this.Dt.mouseBindings.onMouseUp),window.removeEventListener("mousemove",this.Dt.mouseBindings.onMouseMove)),this.emit("destroyed"),this.clearEvents()}di(){const t=getComputedStyle(this.St);this.ji(t),this.Mi(t),this.Ii(t),this.ki(t),this.Ti(),this.Ri()}ji(t){this.style.fontSize||(this.style.fontSize=parseInt(t.fontSize,10))}Mi(t){this.style.textColor||(this.style.textColor=(0,h.lu)(t.color))}Ii(t){this.style.lineHeight||(this.style.lineHeight=parseFloat(t.lineHeight))}ki(t){this.style.padding||(this.style.padding={top:parseInt(t.paddingTop,10)||0,left:parseInt(t.paddingLeft,10)||0,bottom:parseInt(t.paddingBottom,10)||0,right:parseInt(t.paddingRight,10)||0})}Ti(){if(!this.style.width||!this.style.height){const t=this.St.getBoundingClientRect();this.style.width=t.width,this.style.height=t.height}}Ri(){var i;if(!this.style.horizontalAlignment){const e=null===(i=this.Tt[0])||void 0===i?void 0:i.content.charCodeAt(0),n=t.Li(e);this.style.horizontalAlignment="rtl"===n?"right":"left"}}zi(){this.Vt=this.Pi.getBoundingClientRect().height/10}async rerender(t=!1,i){this.zi(),await this.Fi,t&&await this.Ci(),i&&(this.style.width=i.width,this.style.height=i.height),this.Ni(),this.Hi(),this.Ai(!1),this.Vi()}Ni(){this.Ui&&this.Wi.forEach((t=>{t.removeEventListener("click",this.oi),Array.from(t.children).forEach((t=>{t.removeEventListener("click",this.oi)}))}))}Hi(){var t;this.bi&&(null===(t=this.Dt)||void 0===t?void 0:t.inEditMode)&&this.Dt.selection.storeSelectionCharacterPositions()}Vi(){var t;this.bi&&(null===(t=this.Dt)||void 0===t?void 0:t.inEditMode)&&this.Dt.selection.reselectText()}Ai(t=!0){var i;t&&this.Oi();let e=this.Tt;(null===(i=this.Dt)||void 0===i?void 0:i.inEditMode)||this.vi||(e=this.Yi(e)),e=this.Xi(e),this.Zi(e),this.qi(e),"shrink"===this.style.textOverflow&&this.resizeText(e),this.Qi(),this.Gi(),this.Ji()}Gi(){var t;const i="left"===this.style.horizontalAlignment;for(const e of this.Ki){let n=i?0:(null!==(t=this.style.width)&&void 0!==t?t:0)-this.style.padding.left-this.style.padding.right,s=[],r=[];for(const t of e.spans)if("rtl"===t.dir)if(i){t.left=n;let i=t.width;for(const t of s)t.left=n+i,i+=t.width;s.unshift(t)}else{if(r.length>0){const t=r.pop();n-=t.left+t.width}n-=t.width,t.left=n,r=[]}else if(i){if(s.length>0){const t=s.pop();n+=t.left+t.width}t.left=n,n+=t.width,s=[]}else{t.left=n;let i=t.width;for(const t of r)t.left=n-i,i-=t.width;r.unshift(t)}}}Qi(){const t=this.te();for(const i of this.Ki){let e="ltr",n="ltr";for(let s=0;s<i.spans.length;s++){n=s+1<i.spans.length?i.spans[s+1].dir:void 0;const r=i.spans[s],o=0===s,h=s===i.spans.length-(i.isLastLine?2:1);"variable"===r.type&&"infer"===r.dir&&t&&(r.dir="rtl",o&&(i.dir="rtl")),"infer"===r.dir||"previous"===r.dir?o?(r.dir="ltr",i.dir="ltr"):r.dir=h?i.dir:this.ie({isSpaceSpan:"space"===r.type,prevDir:e,nextDir:n,textLineDir:i.dir}):e=r.dir}}}ie({isSpaceSpan:t,prevDir:i,nextDir:e,textLineDir:n}){return t?this.ee(i,e,n)||this.ne(i,e,n)?"rtl":"ltr":i}ee(t,i,e){return"rtl"===t&&("rtl"===i||"ltr"===i&&"rtl"===e)}ne(t,i,e){return"ltr"===t&&"rtl"===i&&"rtl"===e}se(t){return(0,a.WT)(t)?t.content.length+(t.startJoint?1:0)+(t.endJoint?1:0):0}Zi(t){for(let i=0;i<t.length-1;i++){const e=t[i],n=t[i+1];"word"===e.type&&"word"===n.type&&"rtl"===e.dir&&"rtl"===n.dir?(e.endJoint="‍",n.startJoint="‍"):e.endJoint="‌"}}Xi(i){const e=[];for(const n of i)if((0,a.WT)(n)){if(0===n.content.length){e.push(n);continue}let i="variable"===n.type?n:(0,a.Ag)(n);if("word"===n.type){const s=n.content.charCodeAt(0);let r=t.Li(s);i.content=String.fromCharCode(s),i.dir=r;for(let o=1;o<n.content.length;o++){const s=n.content.charCodeAt(o),h=t.Li(s);r!==h&&"previous"!==h?(e.push(i),i=(0,a.Ag)(n),i.content=String.fromCharCode(s),i.dir=r=h):i.content+=String.fromCharCode(s)}}else i.dir="infer";e.push(i)}else n.dir="ltr",e.push(n);return e}re(){const t=[];for(const i of this.Ki)for(const e of i.spans){if("ellipsis"===e.type)throw new Error("Ellipsis cannot exist in this stage.");t.push(e)}return t}oe(t,i){const e=0!==this.he&&0!==this.style.width?this.he/t:0,n=0!==this.ae&&0!==this.style.height?this.ae/i:0;n>e?(this.Gt=this.Gt/n,this.ue(1/n)):(this.Gt=this.Gt/e,this.ue(1/e))}ue(t){for(const i of this.Ki){i.lineHeight*=t,i.lineWidth*=t,i.trailingSpaceWidth*=t;for(const e of i.spans)e.width*=t,e.lineHeight*=t}}le(){let t=0;for(const i of this.Ki)t+=i.lineWidth*i.lineHeight;return t}de(){var t,i;const e=Math.max((null!==(t=this.style.height)&&void 0!==t?t:0)-this.style.padding.top-this.style.padding.bottom,0),n=Math.max((null!==(i=this.style.width)&&void 0!==i?i:0)-this.style.padding.left-this.style.padding.right,0);return{elementHeight:e,elementWidth:n,elementArea:n*e}}resizeText(t){const{elementHeight:i,elementWidth:e,elementArea:n}=this.de();if(i<3||e<3)return void(this.Gt=0);let r=!0;const o=this.F.MODE===s.y.ManageView?.01:.1;let h=0,a=this.Gt;do{const s=this.he,c=this.ae||0,u=s/e,l=c/i,d=this.le(),f=s<=e&&c<=i;if(f&&r)return void this.fe();if(r){const i=40;this.Gt=i,this.fe(),this.qi(t,this.Gt),this.pe=1/this.Gt,this.Gt=1,this.ve(t,!1),r=!1;continue}const p=(this.Gt+o)/this.Gt,v=d/n,m=s/c/(e/i),g=.9,w=o,b=1/Math.abs(1-v)*g+1/Math.abs(1-m)*w;if(f&&b>=h&&(h=b,a=this.Gt),u===l)return void this.fe();this.pe=p,this.Gt=this.Gt*p,this.ve(t,!1)}while(this.Gt<this.style.fontSize);this.pe=a/this.Gt,this.Gt=a,z.G6&&(this.Gt=Math.floor(this.Gt)),this.ve(t,!1),this.oe(e,i),this.fe()}fe(){this.Rt=0}me(t,i,e){if((0,a.qA)(t,{[t]:i},this.style))e!==this.style&&delete e[t];else{if("$mixed"===i)return void(e[t]=i);switch(N.$5[t]){case"Color":e.textColor=i.copy();break;case"FontStyle":case"Padding":case"Variable":e[t]=Object.assign({},i);break;case"TextShadow[]":e.textShadows=i&&i.map((t=>Object.assign({},t)));break;case"boolean":"boolean"!=typeof i?delete e[t]:e[t]=i;break;default:e[t]=i}}}$i(){return{style:this.style,spans:(0,a.Yw)(this.Tt)}}ni(t,i){const e="variable"===t.type?"":t.content.slice(0,i),n="variable"===t.type?t.content:t.content.slice(i);return{preContentSpan:this.we(t,e),postContentSpan:this.we(t,n)}}we(t,i){return{type:t.type,dir:t.dir,content:i,style:(0,a.Vc)(t.style),attributes:this.be(t),styleIds:(0,V.Xh)(t.styleIds),styleId:t.styleId,__previousStyleIds:t.__previousStyleIds&&[...t.__previousStyleIds],__previousStyleIdToHistoryIndexMap:t.__previousStyleIdToHistoryIndexMap&&new Map(t.__previousStyleIdToHistoryIndexMap)}}be(t){return void 0!==t.attributes.styleIndex?{styleIndex:t.attributes.styleIndex,shouldRenderNumber:!1}:{shouldRenderNumber:!1}}ye(){let t;for(;t=this.Ht.pop();)this.St.contains(t)&&this.St.removeChild(t)}async Ci(){if(this.Ki=[],this._e())try{await this.xe()}catch(t){(0,W.S3)("Could not load font face",{enabled:!!this.F.STUDIO_JS,contexts:{fontFaceId:this.style.font.id}})}this.Fe()}_e(){return!this.wi&&!!this.style.font}async xe(){if(this.F.STUDIO_JS){const t=this.Ce().add(this.style.font.id),i=await this.Ae(t);this.Ee(i)}}async Ae(t){const i=[];for(const e of t.values()){const t=this.Se(e);if(!t)throw new Error(`Did not find font style '${e}'.`);i.push(y(t))}return Promise.all(i)}Se(t){for(const i of this.Bt){const e=i.fontStyles.find((({id:i})=>i===t));if(e)return e}}Ee(t){for(const i of t)document.fonts.add(i)}Fe(){this.St.style.fontSize=`${this.style.fontSize}px`}Ce(){var t,i;const e=new Set,n=null!==(i=null===(t=this.$t)||void 0===t?void 0:t.document.id)&&void 0!==i?i:this.Ot.document.id;for(const s of this.Et.spans)if((0,a.WT)(s)){const t=s.styleIds[n],i=this.Ot.element.characterStyles.get(t);i&&i.font&&e.add(i.font.id)}return e}xi(){if(!this.Oe){this.Pi=document.createElement("div"),this.Pi.style.height="10px",this.Pi.style.top="-10000px",this.Pi.style.position="absolute",this.Si.ownerDocument.body.appendChild(this.Pi);const t=this.Si.ownerDocument.createElement("canvas");this.Oe=t.getContext("2d")}}Bi(){this.Oe=void 0,this.Pi.remove()}si(t){this.Zt={spans:[{type:"end",content:"END",dir:"ltr",top:0,left:0,width:0,height:0,lineHeight:0,attributes:{},startJoint:0,endJoint:0}],dir:"infer",lineHeight:0,maxFontSize:1,lineWidth:0,characterWidth:0,trailingSpaceWidth:0,endsWithNewline:!1,isLastLine:!1},t.splice(0,1/0,this.Zt)}$e(t){let i=0;const e=[];t:for(let n=0;n<this.Zt.spans.length;n++){const s=this.Zt.spans[n];if("end"===s.type)break;if("newline"===s.type){e.push({type:"ellipsis",content:"...",style:{},top:0,left:0,width:0,height:0,lineHeight:0,attributes:{},startJoint:0,endJoint:0});break}const r=this.Qt({type:"word",content:"...",lineHeight:0,dir:"ltr",style:s.style,top:0,left:0,width:0,height:0,attributes:{},styleIds:{},__previousStyleIds:this.$t?[]:void 0,__previousStyleIdToHistoryIndexMap:this.$t?new Map:void 0},!0),o=this.Gt,h=this.style.characterSpacing*o,c=r.width-h,u=(0,a.Ag)(s);for(let n=0;n<=s.content.length;n++){u.content=s.content.substring(0,n);const r=this.Qt(u,!0),o=r.width;if(r&&i+o+c>(this.style.width||0)-(this.style.padding.top+this.style.padding.bottom)){if(0===n)return void this.si(t);const{preContentSpan:i}=this.ni(s,n-1);i.width=o,i.lineHeight=r.height,e.push(i,{type:"ellipsis",content:"...",top:0,style:s.style,left:0,width:0,height:0,lineHeight:0,attributes:{},startJoint:0,endJoint:0});break t}}e.push(s),i+=s.width}this.Zt.spans=e,this.Jt()}qt(){return{spans:[],dir:"infer",lineHeight:0,maxFontSize:1,lineWidth:0,trailingSpaceWidth:0,characterWidth:0,endsWithNewline:!1,isLastLine:!1}}ri(t,i,e){this.Zt.spans.push(...i),this.Jt(),this.$e(t),this.kt=!0,e.shouldAbort=!0}Jt(){var t;if(!this.Zt)return;let i=0,e=0,n=0,s=0,r=0,o=0,h=!0,c="infer";for(const u of this.Zt.spans){if("infer"===c&&(0,a.WT)(u)&&u.dir&&(c=u.dir),"end"===u.type){i=this.Be(i);continue}if("newline"===u.type){h&&u.lineHeight>i&&(i=u.lineHeight),n+=u.width,r+=u.width,s+=1;continue}u.lineHeight>i&&(i=u.lineHeight);const l=null!==(t=u.style.characterSpacing)&&void 0!==t?t:this.style.characterSpacing,d=u.style.fontSize?u.style.fontSize*this.Gt:this.Gt;"ellipsis"!==u.type?(u.left=o,"word"!==u.type&&"variable"!==u.type||(r=l*d),"space"===u.type&&(r+=u.width),n+=u.width,u.style.fontSize&&u.style.fontSize>e&&(e=u.style.fontSize),s+=u.content.length,o+=u.width,u.attributes.shouldRenderNumber&&(o+=4),h=!1):r=l*d}this.je({dir:c,lineWidth:n,trailingSpaceWidth:r,lineHeight:i,maxFontSize:e,characterWidth:s})}Be(t){return 1===this.Zt.spans.length&&(t=this.Me()),t}Me(){var t,i;let e=this.style.lineHeight*this.Gt;return(null===(t=this.Dt)||void 0===t?void 0:t.currentStyle.lineHeight)?e=this.Dt.currentStyle.lineHeight*this.Gt:(null===(i=this.Ie)||void 0===i?void 0:i.lineHeight)&&(e=this.Ie.lineHeight),e}je({dir:t,lineWidth:i,trailingSpaceWidth:e,lineHeight:n,maxFontSize:s,characterWidth:r}){this.Zt.dir=t,this.Zt.lineWidth=i,this.Zt.trailingSpaceWidth=e,this.Zt.lineHeight=n,this.Zt.maxFontSize=s||1,this.Zt.characterWidth=r;const o=i-e;o>this.he&&(this.he=Math.round(100*o)/100),this.Wt=0,this.Ie=this.Zt}Kt(t,i,e){var n;this.ae+=this.Zt.lineHeight;const s=this.F.STUDIO_JS?0:2;if("truncate"===this.style.textOverflow&&!(null===(n=this.Dt)||void 0===n?void 0:n.inEditMode)&&this.ae>(this.style.height||0)-(this.style.padding.top+this.style.padding.bottom)+s){this.kt=!0;const n=t.pop();if(this.Zt=t.pop(),!this.Zt)return this.Zt={dir:"infer",spans:[{type:"end",content:"END",dir:"ltr",top:0,left:0,width:0,height:0,lineHeight:0,attributes:{},startJoint:0,endJoint:0}],lineHeight:0,maxFontSize:0,trailingSpaceWidth:0,lineWidth:0,characterWidth:0,endsWithNewline:!1,isLastLine:!1},void t.splice(0,1/0,this.Zt);this.Zt.spans.push(...n.spans,...e),t.push(this.Zt),this.$e(t),i.shouldAbort=!0}}Qt(t,i,e){var n,s,r;if(this.Oe&&i){const i=(0,a.WT)(t)&&t.style.fontSize&&t.style.fontSize*(null!=e?e:this.style.fontSize)||e||this.style.fontSize,o=(0,a.xm)(t)&&(null===(n=this.Dt)||void 0===n?void 0:n.inEditMode)?`"Open Sans", ${it}`:this.ke((0,a.WT)(t)&&t.style.font||this.style.font);this.Oe.font=`${i}px ${o}`;const h=!!((0,a.WT)(t)&&t.style.uppercase||this.style.uppercase),c=(null!==(s=t.startJoint)&&void 0!==s?s:"")+t.content.replace(/\u00A0/g," ")+(null!==(r=t.endJoint)&&void 0!==r?r:""),u=h?c.toLocaleUpperCase():c,l=this.Oe.measureText(u),d=t.content.length,f=i*((0,a.WT)(t)&&t.style.characterSpacing||this.style.characterSpacing)*d,p=l.width+f,v=i*((0,a.WT)(t)&&t.style.lineHeight||this.style.lineHeight);return{width:p/this.Vt,height:v/this.Vt}}return{width:t.width*this.pe,height:t.lineHeight*this.pe}}Ji(){this.Te(),this.ye()}Re(t){const i=document.createElement("div");return Object.assign(i.style,t),i}Le(t,i){for(let e=0;e<t.spans.length;e++){const n=t.spans[e];if(void 0===n.attributes.styleIndex||"newline"===n.type)continue;const s=this.Re({position:"absolute",top:"0",left:`${Math.round(n.left)}px`,height:"100%",width:`${n.width}px`,backgroundColor:"#f6f6f6"});i.appendChild(s)}}ze(t,i){for(let e=0;e<t.spans.length;e++){const n=t.spans[e];if(void 0===n.attributes.styleIndex||"newline"===n.type)continue;const s=this.Re({position:"absolute",top:"0",left:`${n.left}px`,height:"100%",width:`${n.width}px`,borderBottom:"1px solid #c3cbf7"});if(n.attributes.shouldRenderNumber){const t=n.attributes.styleIndex,i=this.Re({position:"absolute",right:"-5px",top:"-4px",fontSize:"8px",fontStyle:"italic",color:"var(--studio-color-primary)",display:this.Dt.hasFocus?"block":"none"});i.className="number",i.innerHTML=t&&t>0?`${t}`:"?",s.appendChild(i)}i.appendChild(s)}}Oi(){const t={spans:[],dir:"infer",lineHeight:0,maxFontSize:0,lineWidth:0,trailingSpaceWidth:0,characterWidth:0,endsWithNewline:!1,isLastLine:!1};for(const i of this.Ki)this.Pe(i,t);this.F.STUDIO_JS&&this.vi&&this.Ne(t),this.Ki=[t],this.Tt=this.re()}Pe(t,i){let e;for(const n of t.spans)"ellipsis"!==n.type&&"composition"!==n.type?""!==n.content&&(e&&(0,P.E4)(e,n)?e.content+=n.content:(e=n,i.spans.push(n),(0,a.WT)(n)&&this.He(n))):(e=n,i.spans.push(n))}He(t){for(const i of Object.keys(N.lt))(0,a.qA)(i,t.style,this.style)&&delete t.style[i]}Ne(t){let i;if(t.spans.every((t=>void 0===t.attributes.styleIndex||1===t.attributes.styleIndex)))t.spans.forEach((t=>t.attributes.shouldRenderNumber=!1));else{for(const e of t.spans){const t=e.attributes.styleIndex;if(i){const e=i.attributes.styleIndex;e===t?i.attributes.shouldRenderNumber=!1:void 0!==e&&(i.attributes.shouldRenderNumber=!0)}i=e}i=void 0}}Yi(t){var i;const e=[];for(let n=0;n<t.length;n++)if("variable"!==t[n].type)e.push(t[n]);else{const s=t[n];this.Ve(s);const r=this.zt.get(s.style.variable.spanId);if((null===(i=this.Dt)||void 0===i?void 0:i.inEditMode)||this.vi)s.content=H.I+decodeURIComponent(r.style.variable.path),e.push(s);else{const t=this.Ue(s);e.push(...t)}}return e}Ve(t){t.style.variable.spanId&&this.zt.get(t.style.variable.spanId)||(t.style.variable.spanId=t.style.variable.spanId||`${Date.now()}`,this.zt.set(t.style.variable.spanId,{style:t.style,span:t}))}Ue(t){const i=this.At.getFeedValue(t.style.variable,t.style.variable.spanId,this.Ot.element).value;return(0,a.O8)(i,{},t.style,a.Vc)}We(){var t,i;const e=this.Ot.inDesignView&&null!==(i=null===(t=this.Dt.styleResolver.getResolvedText())||void 0===t?void 0:t.style)&&void 0!==i?i:{};return Object.assign((0,S.ei)(this.style,"font","characterSpacing","lineHeight","textColor","textOverflow","textShadows","padding","maxRows","horizontalAlignment","verticalAlignment"),{fontSize:this.Gt},e)}qi(t,i){this.Gt=i||this.style.fontSize;const e=[];this.Ye();const n={shouldAbort:!1};for(let s=0;s<t.length&&!n.shouldAbort;s++)this.Xt(t[s],e,n,!0,t.slice(s+1),!1,i);this.Ki=e}Ye(){this.ae=0,this.he=0,this.Lt=0,this.Ut=0,this.Pt=1,this.kt=!1,this.Zt=void 0,this.Ie=void 0}ve(t,i){const e=[];this.Ye();const n={shouldAbort:!1};for(let s=0;s<t.length&&!n.shouldAbort;s++)this.Xt(t[s],e,n,i,t.slice(s+1),!1);this.Ki=e}Xe(t){return t.maxFontSize<1&&(t.maxFontSize=1),-(t.lineHeight-t.maxFontSize*this.Gt)/2}Te(){this.Ze(),this.qe(),this.Ui=new WeakMap,this.Wi=new Map,this.zt=new Map,this.Qe(),this.Ei.style.alignItems=(0,a.$T)(this.style.verticalAlignment);const t=this.Ge();this.Si.style.lineHeight=`${this.style.lineHeight}`;for(let i=0;i<this.Ki.length;i++){const e=this.Ki[i],n=this.Ki.length-1===i,s=document.createDocumentFragment(),r=document.createElement("div"),o=r.dir=(0,a.WT)(e.spans[0])?e.spans[0].dir:"ltr";this.Je(r,e,i,t,o),this.Ui.set(r,i),this.Wi.set(i,r),s.appendChild(r);const h=`t-${i}`;let c=0,u=(0,a.WT)(e.spans[0])?e.spans[0].dir:"ltr",l=this.Ke(u);r.appendChild(l),(0,a.Kq)(e,((s,d)=>{var f,p,v;if(1!==e.spans.length&&"end"===s.type)return;const m=d===(n?e.spans.length-2:e.spans.length-1);(0,a.WT)(s)&&u!==s.dir&&(l=this.Ke(s.dir),r.appendChild(l),u=s.dir);const g=s.__viewElement=document.createElement("span");this.vi&&s.attributes.shouldRenderNumber&&(g.style.marginRight="4px");let w=!1;"space"===s.type?(d===e.spans.length-1||d===e.spans.length-2&&"newline"===e.spans[e.spans.length-1].type)&&(w=!0):"newline"===s.type&&(w=!0),g.style.display="inline-block",g.style.whiteSpace="pre-wrap",g.setAttribute("data-type",this.tn(s.type)),g.setAttribute("data-test-id",`rich-text-span-${this.tn(s.type)}`);const b=this.St.id||(null===(f=this.Dt)||void 0===f?void 0:f.keyboardBindings.inputId),y=this.gi?`${this.gi.id}-`:"";if(g.id=`${y}${b}-${h}-${d}`,g.setAttribute("data-cy",`${b}-${h}-${d}`),m&&this.in(l,e,t,o),(0,a.WT)(s)&&(g.dir=s.dir),"variable"===s.type&&this.en(s,g),g.addEventListener("click",this.oi),"end"===s.type)g.style.height=(null===(p=this.Dt)||void 0===p?void 0:p.currentStyle.lineHeight)*this.Gt+"px",g.innerHTML="&#8203;";else{this.nn(s,g);const t=this.sn(s,e,w),i=null!==(v=t.textColor)&&void 0!==v?v:this.style.textColor;this.rn(Object.assign({fontSize:1,characterSpacing:this.style.characterSpacing,textColor:i},t),g)}(0,a.WT)(s)&&(s.line=i,s.column=c,c+=s.content.length),l.appendChild(g)})),this.Si.appendChild(s)}}Ze(){const t=this.We();this.rn(t,this.St,!1)}qe(){this.Si.innerHTML="",this.St.style.fontSize=`${this.Gt}px`,this.Si.classList.add("invisible-selection")}Qe(){var t;(null===(t=this.Dt)||void 0===t?void 0:t.inEditMode)||"scroll"!==this.style.textOverflow?this.St.style.overflow="visible":this.St.style.overflow="auto"}Ge(){let t=this.style.horizontalAlignment;return t=this.hn(t),t=this.an(t),this.cn(t),t}hn(t){return"left"===t&&(0,a.WT)(this.Ki[0].spans[0])&&"rtl"===this.Ki[0].spans[0].dir?"right":t}an(t){if(!this.vi)return t;return(0,a.WT)(this.Ki[0].spans[0])&&"rtl"===this.Ki[0].spans[0].dir?"right":"left"}cn(t){this.Ei.style.justifyContent=(0,a.RP)(t),this.Si.style.textAlign=t}Je(t,i,e,n,s){switch(t.className="text-line",t.setAttribute("data-test-id","rich-text-text-line"),n){case"left":t.style.justifyContent="ltr"===s?"flex-start":"flex-end";break;case"center":t.style.justifyContent="center";break;case"right":t.style.justifyContent="ltr"===s?"flex-end":"flex-start"}t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="flex",t.style.alignItems="baseline",t.style.height=`${Math.max(1,i.lineHeight)}px`,t.style.whiteSpace="nowrap",t.style.fontSize=i.maxFontSize*this.Gt+"px",t.style.letterSpacing=`${this.style.characterSpacing}em`,"top"===this.style.verticalAlignment&&0===e?t.style.marginTop=`${this.Xe(i)}px`:"bottom"===this.style.verticalAlignment&&i.isLastLine&&(t.style.marginBottom=`${this.Xe(i)}px`)}Ke(t){const i=document.createElement("div");return i.dir=t,i.style.unicodeBidi="bidi-override",i}in(t,i,e,n){if(i.trailingSpaceWidth)switch(e){case"left":"rtl"===n&&(t.style.marginLeft=-i.trailingSpaceWidth+"px");break;case"center":case"right":"rtl"===n?t.style.marginLeft=-i.trailingSpaceWidth+"px":t.style.marginRight=-i.trailingSpaceWidth+"px"}}en(t,i){var e;i.setAttribute("data-variable",t.style.variable.path),t.style.variable.spanId!==i.id?(this.zt.delete(t.style.variable.spanId),t.style.variable.spanId=i.id,this.zt.set(t.style.variable.spanId,{style:t.style,span:t})):this.zt.get(i.id)||(t.style.variable.spanId=i.id,this.zt.set(i.id,{style:t.style,span:t})),t.style.variable.spanId=i.id,this.vi||this.At.addFeedElement(i.id,(0,V.Xh)(t.style.variable),null===(e=this.Ot.viewElement)||void 0===e?void 0:e.__data)}nn(t,i){"newline"===t.type?this.ln(t,i):"ellipsis"===t.type?this.dn(i):"space"===t.type?this.pn(t,i):"composition"===t.type?this.vn(t,i):this.mn(t,i)}ln(t,i){i.innerHTML=" ",i.style.whiteSpace="pre",i.style.width=`${t.width}px`}dn(t){t.innerHTML="..."}pn(t,i){i.style.whiteSpace="pre",i.innerHTML=`${t.content}&zwnj;`}vn(t,i){i.style.width=`${t.width}px`,i.innerHTML="&#8203;",this.Dt.keyboardBindings.compositionSpanElement=i}mn(t,i){var e,n;const s=t.content.normalize("NFC");i.innerHTML=(0,S.HZ)((null!==(e=t.startJoint)&&void 0!==e?e:"")+s.replace(/\u00A0/g," ")+(null!==(n=t.endJoint)&&void 0!==n?n:""))}sn(t,i,e){const n=Object.assign({underline:this.style.underline,strikethrough:this.style.strikethrough,uppercase:this.style.uppercase},t.style);return"newline"===t.type&&(n.fontSize=i.maxFontSize),e&&(n.underline=!1,n.strikethrough=!1),n}rn(t,i,e=!0,n=!1){const s=i.style;let r=!1;const o=n?["textColor"]:[...Object.keys((0,S.CE)(N.lt,"__fontFamilyId")),"padding"],h={style:t,styleAttribute:s,element:i,useRelativeFontSize:e};for(const a of o)switch(a){case"font":this.wn(h);break;case"textColor":this.bn(h);break;case"fontSize":this.yn(h);break;case"underline":case"strikethrough":if(r)break;this._n(h),r=!0;break;case"uppercase":this.xn(h);break;case"characterSpacing":this.Fn(h);break;case"lineHeight":this.Cn(h);break;case"textShadows":this.An(h);break;case"variable":this.En(h);break;case"padding":this.Sn(h);break;default:s[a]=t[a]}}wn({style:t,styleAttribute:i,element:e}){t.font?i.fontFamily=this.ke(t.font,e):i.fontFamily=""}bn({style:t,styleAttribute:i}){i.color=t.textColor?(0,h.xP)(t.textColor):""}yn({style:t,styleAttribute:i,useRelativeFontSize:e}){let n="";void 0!==t.fontSize&&(n=e?this.Gt*t.fontSize+"px":`${this.Gt}px`),i.fontSize=n}_n({style:t,styleAttribute:i}){const e=[];t.underline&&e.push("underline"),t.strikethrough&&e.push("line-through"),i.textDecoration=e.length>0?e.join(" "):""}xn({style:t,styleAttribute:i}){i.textTransform=t.uppercase?"uppercase":""}Fn({style:t,styleAttribute:i}){i.letterSpacing=void 0!==t.characterSpacing?`${t.characterSpacing}em`:""}Cn({style:t,styleAttribute:i,useRelativeFontSize:e}){let n="none";void 0!==t.lineHeight&&(n=e?`${t.lineHeight}em`:`${t.lineHeight}`),i.lineHeight=n}An({style:t,styleAttribute:i}){i.textShadow=t.textShadows?t.textShadows.map((t=>`${t.offsetX}px ${t.offsetY}px ${t.blur}px ${t.color}`)).join(","):""}En({style:t,styleAttribute:i}){var e;t.variable&&((null===(e=this.Dt)||void 0===e?void 0:e.inEditMode)||this.vi?(i.color="var(--variable-artifact-color)",i.backgroundColor=this.vi?"rgba(235, 235, 235, 0.7)":"",i.cursor="var(--variable-artifact-cursor)",i.fontFamily=`'Open Sans', ${it}`):(i.color=i.color||"",i.cursor="",i.fontFamily=i.fontFamily||""))}Sn({style:t,styleAttribute:i}){t.padding?(i.paddingTop=`${t.padding.top}px`,i.paddingLeft=`${t.padding.left}px`,i.paddingRight=`${t.padding.right}px`,i.paddingBottom=`${t.padding.bottom}px`):(i.paddingTop="",i.paddingLeft="",i.paddingRight="",i.paddingBottom="")}On(t){this.Ki.forEach((i=>{i.spans.forEach((i=>{if((0,a.WT)(i)&&i.__viewElement){const e=Object.assign(Object.assign({},t),i.style);this.rn(e,i.__viewElement,!0,!0)}}))}))}tn(t){switch(t){case"newline":return"newline";case"space":return"space";case"word":return"text";case"ellipsis":return"ellipsis";case"end":return"end";case"variable":return"variable";case"composition":return"composition"}}ai(t){let i=this.At.elements.get(t);if(!i){const t=this.$n();1===t.length&&(i=this.At.elements.get(t[0].style.variable.spanId))}return i}ci(t){const i=t.element;return!(function(t){const i=null==t?void 0:t.actions;return!!i&&i.some((t=>!t.disabled&&t.preventClickThrough))}(i)||function(t){const i=null==t?void 0:t.actions;return!!i&&i.some((t=>!t.disabled&&t.operations.some((t=>t.method===T.OpenUrl&&t.value))))}(i))}ui(t,i){t.preventDefault(),t.stopPropagation(),this.emit("spanClicked",[t,i])}hi(){var t;const i=null===(t=this.Dt)||void 0===t?void 0:t.inEditMode,e=window.bfstudio&&(window.bfstudio.inShowcaseMode||window.bfstudio.inPreviewMode&&"DV"===window.bfstudio.activePage);return!!i||!!e}$n(){return this.Tt.filter(a.xm).slice(0,2)}Dn(t,i){return!(3!==t.nodeType||!t.parentNode)&&(!!(t=t.parentNode).dataset&&this.Bn(t.dataset.type)===i)}Bn(t){switch(t){case"newline":return"newline";case"space":return"space";case"text":return"word";case"end":return"end";case"variable":return"variable";case"composition":return"composition"}throw new Error("Unknown span type.")}jn(t){this.style=t?Object.assign(Object.assign({},this.li),t):this.li}ke(t,i){let e=t&&`"f-${t.id}"`;if(!e&&i){const t=window.getComputedStyle(i).fontFamily;t&&(e=t)}return e&&-1===e.indexOf(",")&&(e+=`, ${it}`),e}static Mn(t,i){return i.some((i=>{const e=1===i.length&&i[0]===t,n=i.length>1&&t>=i[0]&&t<=i[1];return e||n}))}static Li(t){return 32===t?"infer":this.Mn(t,K)?"rtl":this.Mn(t,G)?"ltr":"previous"}te(){var i,e;const n=null!==(e=null===(i=this.Tt[0])||void 0===i?void 0:i.content.charCodeAt(0))&&void 0!==e?e:"";return t.Mn(n,J)}};et=(0,L.gn)([(0,L.fM)(3,(0,U.f3)(2)),(0,L.fM)(4,(0,U.f3)(28,{optional:!0})),(0,L.fM)(5,(0,U.f3)(16,{optional:!0})),(0,L.fM)(6,(0,U.f3)(31,{optional:!0})),(0,L.w6)("design:paramtypes",[Object,HTMLDivElement,Object,Object,Object,Object,Array])],et),(0,U.GY)(2,{},et,"_env",3),(0,U.GY)(28,{optional:!0},et,"editorState",4),(0,U.GY)(16,{optional:!0},et,"editor",5);var nt,st,rt,ot=r(879126521801134);!function(t){t.Joint="joint",t.Separate="separate"}(nt||(nt={})),function(t){t.Blur="blur",t.Contrast="contrast",t.Invert="invert",t.Grayscale="grayscale",t.Saturation="saturate",t.Sepia="sepia"}(st||(st={})),function(t){t.Length="px",t.Percentage="%"}(rt||(rt={}));const ht={[st.Blur]:{name:"Blur",icon:"filter-blur",unit:rt.Length,min:0,max:100},[st.Contrast]:{name:"Contrast",icon:"filter-contrast",unit:rt.Percentage,min:0,max:200,default:100},[st.Invert]:{name:"Invert",icon:"filter-invert",unit:rt.Percentage,min:0,max:100},[st.Grayscale]:{name:"Grayscale",icon:"filter-grayscale",unit:rt.Percentage,min:0,max:100},[st.Saturation]:{name:"Saturation",icon:"filter-saturate",unit:rt.Percentage,min:0,max:200,default:100},[st.Sepia]:{name:"Sepia",icon:"filter-sepia",unit:rt.Percentage,min:0,max:100}},at=(Object.entries(ht).reduce(((t,[i,e])=>[...t,Object.assign({id:i},e)]),[]),[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ct=Math.cos,ut=Math.sin,lt=Math.tan,dt=Math.sqrt,ft=Math.pow;class pt{constructor(t){t?this.In(t):this.kn=this.Tn()}In(t){const i=t.split(/\s*[(),]\s*/).slice(1,-1);return 6===i.length?this.kn=[+i[0],+i[2],0,+i[4],+i[1],+i[3],0,+i[5],0,0,1,0,0,0,0,1]:16===i.length?this.kn=[+i[0],+i[4],+i[8],+i[12],+i[1],+i[5],+i[9],+i[13],+i[2],+i[6],+i[10],+i[14],+i[3],+i[7],+i[11],+i[15]]:this.Tn(),this}Rn(){return`matrix3d(${this.kn.join(",")})`}Ln(t){return this.kn=this.zn(this.kn,t),this}Pn(t=0,i=0,e=0){const n=ut(t),s=ct(t),r=ut(i),o=ct(i),h=ut(e),a=ct(e),c=[1,0,0,0,0,s,-n,0,0,n,s,0,0,0,0,1],u=[o,0,r,0,0,1,0,0,-r,0,o,0,0,0,0,1],l=[a,h,0,0,-h,a,0,0,0,0,1,0,0,0,0,1],d=this.zn(this.zn(c,u),l);return this.Ln(d)}Nn(t){const i=ut(t),e=ct(t);return this.Ln([1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1])}Hn(t){const i=ut(t),e=ct(t);return this.Ln([e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1])}Vn(t){const i=ut(t),e=ct(t);return this.Ln([e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1])}Un(t,i){const e=lt(t),n=lt(i);return this.Ln([1,e,0,0,n,1,0,0,0,0,1,0,0,0,0,1])}Wn(t,i,e=0){return this.Ln([1,0,0,0,0,1,0,0,0,0,1,0,t,i,e,1])}Yn(t=1,i=1,e=1){return this.Ln([t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1])}Xn(){return this.Zn(1,4)}qn(){return this.Zn(2,4)}Qn(){return this.Zn(3,4)}Gn(){return this.Jn(this.Zn(1,1),this.Zn(1,2),this.Zn(1,3))}Kn(){return this.Jn(this.Zn(2,1),this.Zn(2,2),this.Zn(2,3))}is(t){const i=this.Tn();return i[11]=-1/t,this.Ln(i)}es(){return this.Zn(1,1)<0}ns(){return this.Zn(2,2)<0}ss(t,i){const e=t[0],n=t[1],s=t[2],r=t[3],o=t[4],h=t[5],a=t[6],c=t[7],u=t[8],l=t[9],d=t[10],f=t[11],p=t[12],v=t[13],m=t[14],g=t[15],w=i[0]||0,b=i[1]||0,y=i[2]||0,_=i[3]||0;return[w*e+b*o+y*u+_*p,w*n+b*h+y*l+_*v,w*s+b*a+y*d+_*m,w*r+b*c+y*f+_*g]}zn(t,i){const e=[i[0],i[1],i[2],i[3]],n=[i[4],i[5],i[6],i[7]],s=[i[8],i[9],i[10],i[11]],r=[i[12],i[13],i[14],i[15]],o=this.ss(t,e),h=this.ss(t,n),a=this.ss(t,s),c=this.ss(t,r);return[o[0],o[1],o[2],o[3],h[0],h[1],h[2],h[3],a[0],a[1],a[2],a[3],c[0],c[1],c[2],c[3]]}Zn(t,i){return this.kn[4*(i-1)+(t-1)]}Tn(){return at.slice()}Jn(t,i,e){return dt(ft(t,2)+ft(i,2)+ft(e,2))}}class vt{get isPlaying(){return!this.rs}constructor(t){this.target=t,this.O=1,this.A=0,this.os=0,this.J=.5,this.hs=Z("linear"),this.rs=!0,this.cs=[],this.onCompleted=t=>{this.cs.push(t)},this.B=t=>{if(this.rs)return;if(this.k&&t-this.A<this.k)return void(this.T=requestAnimationFrame(this.B));this.A=t,this.us||(this.us=t);const i=(t-this.us)/1e3;this.os+=i*this.O,this.us=t,this.ls(this.os)?this.pause():this.T=requestAnimationFrame(this.B)}}static to(t,i,e){return new vt(t).to(i,e)}to(t,i){return this.fromTo(this.target,t,i)}from(t,i){return this.fromTo(t,this.target,i)}fromTo(t,i,e){return this.ds(e),this.fs=this.ps(t),this.vs=this.ps(i),this.restart().play()}play(){return!0===this.rs&&(this.rs=!1,this.T=requestAnimationFrame(this.B)),this}pause(){this.rs=!0,this.us=0,this.R()}restart(){return this.os=0,this}revert(){return this.O*=-1,this.play()}ds(t={}){void 0!==t.customFPSInterval&&(this.k=t.customFPSInterval),void 0!==t.duration&&(this.J=t.duration),void 0!==t.timingFunction&&(this.hs=Z(t.timingFunction)),this.ms=t.callback}ls(t){const i=this.gs(t),e=this.ws(i);"object"==typeof this.vs&&Object.keys(this.vs).forEach((t=>{const i=this.fs[t],n=this.vs[t];if("number"!=typeof i)throw new Error(`Cannot animate property ${t}. Must be of type number`);this.target[t]=(0,S.t7)(i,n,e)})),this.ms&&this.ms(this);const n=this.O<0?i<=0:i>=1;if(n)for(const s of this.cs)s();return n}ws(t){return this.hs(t)}gs(t){return this.J>0?(0,S.uZ)(t/this.J,0,1):1}R(){this.T&&(cancelAnimationFrame(this.T),this.T=void 0)}ps(t){const i={};return"number"==typeof t&&(i.value=t),"object"==typeof t&&Object.keys(t).forEach((e=>{const n=t[e];"number"==typeof n&&(i[e]=n)})),i}}var mt=r(359228699048257),gt=r(356676357306009);const wt=(0,S.MN)(["x","y","originX","originY","rotationX","rotationY","rotationZ","opacity","scaleX","scaleY","fill","radius","shadows","filters","textColor","border"]);var bt=r(354032240760973),yt=r(577269179748313);function _t(t){return"string"==typeof t&&t.indexOf("@")>=0}function xt(t,i){if("@value"!==t){if(_t(t)){const e=function(t,i){const e=function(t){const{settings:i,canvasSize:e,element:n}=t,s=t.propertyName&&n[t.propertyName],{x:r,y:o,width:h,height:a,rotationX:c,rotationY:u,rotationZ:l}=n;return{x:r,y:o,width:h,height:a,rotationX:c,rotationY:u,rotationZ:l,value:s,settings:i,creativeWidth:e.width,creativeHeight:e.height}}(i),n=At(i.element,t),s=Ft.get(n);if(s&&(0,S.vZ)(s,e))return Ct.get(n);Ft.set(n,e),Ct.delete(n)}(t,i);if("number"==typeof e)return e;const{settings:n,canvasSize:s,element:r}=i,o=i.propertyName&&r[i.propertyName],{x:h,y:a,width:c,height:u,rotationX:l,rotationY:d,rotationZ:f}=r,p=(0,yt.Yt)({x:0,y:0,width:c,height:u,rotationZ:f}),v={x:h,y:a,rotationX:l,rotationY:d,rotationZ:f,width:p.width,height:p.height,creativeWidth:s.width,creativeHeight:s.height,edgePoint:t=>{const i=function(t,i,e,n){e=(e-90)*(Math.PI/180);const s=1e-5,r=(0,S.L8)(Math.cos(e),s),o=(0,S.L8)(Math.sin(e),s),h=o/r,a=0===r,c=0===o;if(r<1e-16&&!a){const e=t.x*h+(n.height-t.y);if(e>=-i.height&&e<=n.height+i.height)return{x:-i.width,y:n.height-e-i.height*(-.5*o)}}if(r>1e-16&&!a){const e=(n.width-t.x)*h+t.y;if(e>=-i.height&&e<=n.height+i.height)return{x:n.width,y:e+i.height*(.5*o)}}if(o<1e-16&&!c){const e=t.y*r/o+(n.width-t.x);if(e>=-i.width&&e<=n.width+i.width)return{x:n.width-e-i.width*(-.5*r),y:-i.height}}if(o>1e-16&&!c){const e=(n.height-t.y)*r/o+t.x;if(e>=-i.width&&e<=n.width+i.width)return{x:e+i.width*(.5*r),y:n.height}}return t}({x:h,y:a},p,t,s);return i.x-=h,i.y-=a,i},transition:{},settings:{}};if(v.value=o,n)for(const t in n)v.settings[t]=n[t].value,v.transition[t]=n[t].value;const m=function(t){return t.replace(/\@/g,"")}(t),g=M.eval(m,v);if(isNaN(g))throw new Error(`Could not resolve formula: ${t}`);return Ct.set(At(r,t),g),g}return"string"!=typeof t||isNaN(+t)?t:+t}}const Ft=new Map,Ct=new Map;function At(t,i){return`${t.id}:${i}`}const Et=["x","y","rotationX","rotationY","rotationZ"];Object.freeze({ratio:1});function St(t,i,e){const n={};return t.forEach((t=>{const s=t.state,r=void 0!==t.rate?t.rate:1;if(0!==r)for(const o in s)if(wt.some((t=>t===o))){let t=n[o];const h=N.Is[o],a=s[o],c=void 0!==t?t:i[o];void 0!==a&&("number"===h?(void 0===t&&(t=Pt(o)?0:i[o]),n[o]=Dt(o,t,a,r,e)):n[o]=Ot(o,c,a,r))}else n[o]=s[o]})),n}function Ot(t,i,e,n){switch(N.Is[t]){case"number":return Dt(t,i,e,n);case"Radius":return function(t,i,e){if(i&&t)return{type:i.type,topLeft:Dt("radius",t.topLeft,i.topLeft,e),topRight:Dt("radius",t.topRight,i.topRight,e),bottomLeft:Dt("radius",t.bottomLeft,i.bottomLeft,e),bottomRight:Dt("radius",t.bottomRight,i.bottomRight,e)}}(i,e,n);case"Color":return $t(i,e,n);case"Shadow[]":case"TextShadow[]":return function(t,i,e){const n=[],s=Math.max((null==t?void 0:t.length)||0,(null==i?void 0:i.length)||0);for(let r=0;r<s;r++){let s=t&&t[r],o=i&&i[r];const h=null==s?void 0:s.color,a=null==o?void 0:o.color;s||(s=Object.assign({},o)),o||(o=Object.assign({},s)),n[r]={blur:Math.max(0,(0,S.t7)(s.blur,o.blur,e)),offsetX:(0,S.t7)(s.offsetX,o.offsetX,e),offsetY:(0,S.t7)(s.offsetY,o.offsetY,e),color:$t(h,a,e)},void 0!==s.spread&&(n[r].spread=Math.max(0,(0,S.t7)(s.spread,o.spread,e)))}return n}(i,e,n);case"FilterMap":return function(t,i={},e={}){const n=new Set([...Object.keys(i),...Object.keys(e)]);return[...n].filter((t=>void 0!==i[t]||void 0!==e[t])).reduce(((n,s)=>{var r,o,h,a;const c=ht[s];return Object.assign(Object.assign({},n),{[s]:{value:(0,S.t7)(null!==(o=null===(r=i[s])||void 0===r?void 0:r.value)&&void 0!==o?o:(null==c?void 0:c.default)||0,null!==(a=null===(h=e[s])||void 0===h?void 0:h.value)&&void 0!==a?a:(null==c?void 0:c.default)||0,t)}})}),{})}(n,i,e);case"Border":return function(t,i,e){if((t||i)&&(t=t||Object.assign(Object.assign({},i),{thickness:0}),(i=i||Object.assign(Object.assign({},t),{thickness:0}))&&t))return{thickness:Math.max(0,(0,S.t7)(t.thickness,i.thickness,e)),style:1===e?i.style:t.style,color:(0,h.Rc)(t.color,{color:i.color,amount:e})}}(i,e,n);default:if(1===n)return e}}function $t(t,i,e){i||((i=(0,h.lu)(t)).alpha=0),t||((t=(0,h.lu)(i)).alpha=0);const n={color:i,amount:e};return(0,h.Rc)(t,n)}function Dt(t,i,e,n,s=!1){if("number"!=typeof e){if("number"==typeof i)return i;throw new Error("Can only merge numeric values")}return Pt(t)&&!s?("number"!=typeof i&&(i=0),Bt(t,i+e*n)):("number"!=typeof i&&(i=1),Bt(t,(0,S.t7)(i,e,n)))}function Bt(t,i){const e=N.RF[t],n=N.ff[t];return"number"==typeof e&&(i=Math.max(e,i)),"number"==typeof n&&(i=Math.min(n,i)),i}function jt(t,i,e,n,s){if("number"===N.Is[n]){if("number"==typeof s&&!isNaN(s)||void 0===s)return s;if("object"==typeof s&&"number"===s.type)return s.value;if(_t(s))return xt(s,{element:t,propertyName:n,settings:i.settings,canvasSize:e});if("string"==typeof s&&!isNaN(+s))return+s;throw new Error("Unexpected number value.")}return s}function Mt(t,i,e={},n=1){const s=N.Is[t],r=i[t],o=e[t],h=void 0!==o?o:r;if(void 0!==h){if("number"===s){const i=function(t,i,e,n){return"number"!=typeof e?i:Pt(t)?i+(e||0):n}(t,r,o,h);return function(t){return N.By.includes(t)}(t)?function(t,i){return t*i}(i,n):i}if("Color"===s)return new bt.I(h);if("Border"===s)return function(t,i){return{thickness:t.thickness*i,color:t.color,style:t.style}}(h,n);if("Shadow[]"===s||"TextShadow[]"===s)return h.map((t=>It(s,t,n)));if("ImageAsset"===s)return Object.assign({},h);if("ImageSettings"===s)return Object.assign({},h);if("Padding"===s)return function(t,i){return{bottom:t.bottom*i,top:t.top*i,right:t.right*i,left:t.left*i}}(h,n);if("Radius"===s)return Object.assign(Object.assign({},h),{topLeft:h.topLeft*n,topRight:h.topRight*n,bottomLeft:h.bottomLeft*n,bottomRight:h.bottomRight*n})}return h}function It(t,i,e){const n=Object.assign({},i);return"Shadow[]"===t?(n.offsetX*=e,n.offsetY*=e,n.spread*=e,n.blur*=e):"TextShadow[]"===t&&(n.offsetX*=e,n.offsetY*=e,n.blur*=e),n}function kt(t,i,e=0,n=[]){n=function(t,i){if(i.length>1){const e=Math.max(...i.map((t=>t.rate)),0);if(0===e)return[];const n=St(i.map((t=>({rate:t.rate/e,state:t.state}))),t,!0);return[{rate:e,state:n}]}return i.slice(0)}(t,n),t.animations&&t.animations.filter((t=>!t.hidden)).forEach((s=>{const r=Lt(t,s,i,e).filter((t=>!n.some((i=>t.state===i.state))));n.unshift(...r)}));return St(n,t)}function Tt(t,i){var e;if((null===(e=t.states)||void 0===e?void 0:e.length)&&i)return t.states.find((t=>t.id===i))}function Rt(t,i,e,n){const s={};for(const r in n)s[r]=jt(t,i,e,r,n[r]);return s}function Lt(t,i,e,n=0){const s=[],{keyframes:r}=i;if(!r||!r.length||!(0,X.wU)(n,t))return s;const o=(0,X.zj)(t,n),h=1e-6,a=(0,X.DE)(r,o,h),c=(0,X.ZH)(r,o,h),u=(null==a?void 0:a.stateId)&&Object.assign({},Rt(t,i,e,Tt(t,a.stateId))),l=(null==c?void 0:c.stateId)&&Object.assign({},Rt(t,i,e,Tt(t,c.stateId)));if(!a&&!c)throw new Error("Animation has no keyframes");if(a===c||!c||a&&(0,X.wU)(o,a))u&&s.push({state:u,rate:1});else if(a&&c){const e=function(t,i){let e=i.timingFunction;return"@timingFunction"===e&&(e=t.timingFunction),Z(e)}(i,c),n=function(t,i,e,n){const s=(0,X.C2)(i,e),r=i.time+(i.duration||0);return s?n((0,S.uZ)((t-r)/s,0,1)):(0,X.wU)(t,i)?1:0}(o,a,c,e);if(u)if(l){zt(u,l).forEach((i=>{const e=Pt(i)?0:t[i];void 0===u[i]&&void 0!==e&&(u[i]=e),void 0===l[i]&&(l[i]=void 0!==e?e:Ot(i,u[i],e,1))}));const i=function(t){const i={};for(const e in t)Pt(e)&&(i[e]=t[e]);return function(t){return 0===zt(t).length}(i)?void 0:i}(u),e=function(t){const i={};for(const e in t)Pt(e)||(i[e]=t[e]);return Object.keys(i).length?i:void 0}(u);e&&s.push({state:e,rate:1}),i&&s.push({state:i,rate:1-n})}else s.push({state:u,rate:1-n});l&&s.push({state:l,rate:n})}return s}function zt(...t){const i=[];return t.forEach((t=>{for(const e in t){const n=e;void 0!==t[n]&&-1===i.indexOf(n)&&wt.indexOf(n)>-1&&i.push(n)}})),i}function Pt(t){return Et.indexOf(t)>-1}var Nt,Ht=r(961342611394679);function Vt(t,i,e){const{topLeft:n,topRight:s,bottomRight:r,bottomLeft:o}=e;return`M 0 ${n} A ${n} ${n} 0 0 1 ${n} 0 L ${t-s} 0 A ${s} ${s} 0 0 1 ${t} ${s}L ${t} ${i-r} A ${r} ${r} 0 0 1 ${t-r} ${i}L ${o} ${i} A ${o} ${o} 0 0 1 0 ${i-o} Z`}!function(t){t.ImageRemovedDuringLoad="Image was removed while loading",t.ImageLoadingFailed="Could not load image",t.ResizeObseravbleLoopLimit="ResizeObserver loop limit exceeded"}(Nt||(Nt={}));const Ut={fit:"xMidYMid meet",crop:"xMidYMid slice",stretch:"none"},Wt="http://www.w3.org/2000/svg",Yt="http://www.w3.org/1999/xlink";var Xt,Zt;!function(t){t.Shape="-shape",t.Group="-group",t.LinearGradient="-linear-gradient",t.Border="-border",t.Clip="-clip",t.Shadow="-shadow"}(Xt||(Xt={}));class qt extends Error{constructor(t,i){super(t),this.url=i,Object.setPrototypeOf(this,qt.prototype)}}class Qt{constructor(t,i,e){var n;this.bs=t,this.ys=i,this.F=e,this._s=[],this.Fs=[],this.Cs=[],this.As=[],this.Es=Zt.None,this.Ss=t=>{const i=t.imageSettings.sizeMode;return i?Ut[i]:t.ratio?"xMidYMid slice":t.ratio?"xMidYMid meet":"none"},this.Os=this.bs.document,this.$s=this.Os.querySelector("head base")?this.bs.location.href.replace(this.bs.location.hash,""):"",this.Ds=`${((0,c.xs)(this.ys)?this.ys.elementCid:"creative")||"unset"}-${Math.floor(1e6*Math.random())}`,this.Bs=this.Ms(),this.ks=this.ys.__data,this.Ts(),this.Rs.setAttribute("d",Vt(this.ys.width,this.ys.height,null!==(n=this.Ls)&&void 0!==n?n:this.getDefaultRadius()))}setViewBox(t,i,e,n){this.zs.setAttribute("viewBox",`${t} ${i} ${e} ${n}`)}setResponsive(){this.Ps>this.Ns?(this.zs.style.height="auto",this.zs.style.width="100%"):(this.zs.style.height="100%",this.zs.style.width="auto"),this.setViewBox(0,0,this.Ps,this.Ns)}Ms(){var t;switch(null===(t=this.ys)||void 0===t?void 0:t.kind){case ot.OH.Ellipse:case ot.OH.Image:return this.ys.kind;default:return ot.OH.Rectangle}}Ts(){var t;if(this.zs)throw new Error("Background already added");const i=this.Os,e=i.createElementNS(Wt,"g"),n=i.createElementNS(Wt,"ellipse"===this.Ms()?"ellipse":"path"),s=i.createElementNS(Wt,"defs"),r=i.createElementNS(Wt,"svg"),o=r.style;return r.setAttribute("xmlns",Wt),o.position="absolute",o.left="0",o.top="0",o.width="100%",o.height="100%",o.overflow="visible",o.zIndex="-1",this.Hs()&&(o.outline="1px solid transparent"),n.id=this.Ds+Xt.Shape,n.setAttribute("fill","transparent"),e.id=this.Ds+Xt.Group,e.appendChild(n),r.appendChild(s),r.appendChild(e),this.Rs=n,this.Vs=s,this.Us=e,this.zs=r,(0,c.iN)(this.ks)&&(this.Ws=this.Ys()),null===(t=this.ys.__rootElement)||void 0===t||t.prepend(r),r}Ys(){const t=document.createElementNS(Wt,"foreignObject");t.setAttribute("fill","transparent");const i=document.createElement("div");return t.appendChild(i),this.Us.appendChild(t),t}Xs(){this.Zs||(this.Zs=function(t){const i="http://www.w3.org/2000/svg",e=document.createElementNS(i,"g"),n=document.createElementNS(i,"g");n.setAttribute("transform",`translate(${t.width/2-12}, ${t.height/2-12})`),n.setAttribute("stroke","#ffffff"),n.setAttribute("stroke-width","2"),n.setAttribute("fill","none");const s=document.createElementNS(i,"circle");s.setAttribute("stroke-opacity","0.25"),s.setAttribute("cx","12"),s.setAttribute("cy","12"),s.setAttribute("r","12");const r=document.createElementNS(i,"path");r.setAttribute("d","M24 12c0-9.94-8.06-12-12-12");const o=document.createElementNS(i,"animateTransform");o.setAttribute("attributeName","transform"),o.setAttribute("type","rotate"),o.setAttribute("from","0 12 12"),o.setAttribute("to","360 12 12"),o.setAttribute("dur","1s"),o.setAttribute("repeatCount","indefinite"),r.appendChild(o),n.appendChild(s),n.appendChild(r);const h=document.createElementNS(i,"rect");return h.setAttribute("width",`${t.width}`),h.setAttribute("height",`${t.height}`),h.setAttribute("fill","rgba(0,0,0,0.25)"),e.appendChild(h),e.appendChild(n),e}(this.qs)),this.Zs.parentNode||this.Us.appendChild(this.Zs)}Qs(){var t;(null===(t=this.Zs)||void 0===t?void 0:t.parentNode)&&this.Us.removeChild(this.Zs)}Hs(){var t;return!(this.F.MODE!==s.y.ImageGenerator||!(null===(t=this.ys)||void 0===t?void 0:t.rotationZ)||0===this.ys.rotationZ)}W(t,i){let e;return this.qs=i?Object.assign(Object.assign({},t),i):t,this.ys=t,this.Bs===ot.OH.Image&&(e=this.Gs(this.qs.imageUrl)),this.Js(this.qs.fill),this.Ks(this.qs.border),this.tr(this.qs),this.ir(this.qs.shadows),e}tr(t){const{width:i,height:e,radius:n}=t;if(isNaN(i)||isNaN(e)||"number"!=typeof i||"number"!=typeof e)throw new Error("width, height must be provided");if(i!==this.Ps||e!==this.Ns){this.Ps=i,this.Ns=e;const t=this.er();this.zs.setAttribute("width",`${i+2*t}`),this.zs.setAttribute("height",`${e+2*t}`),"ellipse"===this.Bs?(this.Rs.setAttribute("cx",`${t+i/2}`),this.Rs.setAttribute("cy",`${t+e/2}`),this.Rs.setAttribute("rx",""+i/2),this.Rs.setAttribute("ry",""+e/2)):(this.Ws&&(this.Ws.setAttribute("height",`${e}`),this.Ws.setAttribute("width",`${i}`)),this.nr&&(this.nr.setAttribute("width",`${i}`),this.nr.setAttribute("height",`${e}`))),this.sr(),this.rr(),this.or()}this.hr(n),this.ar()}rr(){if(this.cr){if(!this.ur||"number"!=typeof this.Ps||"number"!=typeof this.Ns)throw new Error("No gradient position provided");const t=this.ur.from.x*this.Ps,i=this.ur.from.y*this.Ns,e=this.ur.to.x*this.Ps,n=this.ur.to.y*this.Ns;this.cr.setAttribute("x1",`${t}`),this.cr.setAttribute("y1",`${i}`),this.cr.setAttribute("x2",`${e}`),this.cr.setAttribute("y2",`${n}`)}}lr(t){var i;if(null===(i=null==t?void 0:t.stops)||void 0===i?void 0:i.length){const i=t.start.position,e=t.end.position;return{from:Object.assign({},i),to:Object.assign({},e)}}}dr(){if(!this.cr){const t=this.Ds+Xt.LinearGradient,i=document.createElementNS(Wt,"linearGradient");i.id=t,i.setAttribute("gradientUnits","userSpaceOnUse");const e=document.createElementNS(Wt,"stop");i.appendChild(e);const n=document.createElementNS(Wt,"stop");i.appendChild(n),this.Cs.push(e,n),this.cr=i}return this.cr}calculateRadius(t){const i=Math.min(this.ys.width,this.ys.height),e=Math.ceil(i/2),n=t=>t>e?e:t;return{type:t.type,topLeft:n(t.topLeft),topRight:n(t.topRight),bottomRight:n(t.bottomRight),bottomLeft:n(t.bottomLeft)}}getDefaultRadius(){return{type:nt.Joint,topLeft:0,topRight:0,bottomRight:0,bottomLeft:0}}hr(t){var i;if(this.Bs===ot.OH.Ellipse)return;const e=this.calculateRadius(t||this.getDefaultRadius()),n=Vt(this.ys.width,this.ys.height,e);n!==this.fr&&(this.Ls=e,this.fr=n,this.Rs.setAttribute("d",n),null===(i=this.pr)||void 0===i||i.setAttribute("d",n))}Js(t){const i=this.Ds+Xt.LinearGradient,e=null==t?void 0:t.toString();if(e!==this.vr)if(this.vr=e,t){const n=t.stops||[];if("linear-gradient"===t.type&&n.length){const e=this.dr();this.ur=this.lr(t),this.Ps&&this.Ns&&this.rr(),n.forEach(((i,e)=>{const n=i.color,s=this.Cs[e];s.setAttribute("offset",`${i.offset}%`),s.setAttribute("stop-color",(0,h.dF)(n)),s.setAttribute("stop-opacity",(n.alpha/100*(t.alpha/100)).toString())})),e.parentNode||this.Vs.appendChild(e),navigator.userAgent.includes("Safari")&&navigator.vendor.includes("Apple")?this.Rs.setAttribute("fill",`url('${this.$s}#${i}')`):this.Rs.setAttribute("fill",`url(#${i})`)}else this.Rs.setAttribute("fill",e)}else this.Rs.setAttribute("fill","transparent")}sr(){this.pr&&(this.pr.setAttribute("width",`${this.Ps}`),this.pr.setAttribute("height",`${this.Ns}`))}mr(){if(!this.pr){const t=this.Ds+Xt.Border,i=this.Ds+Xt.Clip,e=this.Os.createElementNS(Wt,"path");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("fill","transparent"),e.id=t,this.gr=this.Os.createElementNS(Wt,"clipPath"),this.gr.id=i;const n=this.Os.createElementNS(Wt,"use");n.setAttributeNS(Yt,"xlink:href",`${this.$s}#${t}`),n.style.pointerEvents="none",this.gr.appendChild(n),this.wr=this.Os.createElementNS(Wt,"use"),this.wr.style.pointerEvents="none",this.wr.setAttributeNS(Yt,"xlink:href",`${this.$s}#${t}`);const s=`url(${this.$s}#${i})`;if(this.nr&&this.nr.setAttribute("clip-path",s),this.Ws){this.Ws.setAttribute("clip-path",s);const t=this.Ws.firstElementChild;t.style.clipPath=s,z.G6&&(t.style.height="inherit")}this.Vs.appendChild(e),this.Vs.appendChild(this.gr),this.Us.appendChild(this.wr),this.pr=e}return this.pr}Ks(t){var i;let e;const{thickness:n,style:s,color:r}=t||{thickness:0,style:"solid"},o=r?r.toString():"transparent",h=(null===(i=this.br)||void 0===i?void 0:i.thickness)!==n;this.br&&!h&&this.br.style===s&&this.br.color===o||(this.br={thickness:n,style:s,color:o},this.zs.style.boxShadow=n&&this.Es!==Zt.BoxShadow?`0 0 ${n}px transparent`:"none",e=this.Bs===ot.OH.Image||(0,c.iN)(this.ks)?this.mr():this.Rs,e.setAttribute("stroke",this.br.color),e.setAttribute("stroke-width",`${this.br.thickness}`),e.setAttribute("stroke-linejoin","square"),"solid"===this.br.style?(e.setAttribute("stroke-linecap","butt"),e.setAttribute("stroke-dasharray","")):"dashed"===this.br.style?(e.setAttribute("stroke-linecap","butt"),e.setAttribute("stroke-dasharray",""+3*n)):"dotted"===this.br.style&&(e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-dasharray","1, "+2*n)),h&&this.yr(this.As))}yr(t){const i=this.Es,e=this.zs.style,n=e.willChange.split(",").filter((t=>!!t)).map((t=>t.trim()));if((null==t?void 0:t.length)&&i!==Zt.None){if(i===Zt.DropShadow){-1===n.indexOf("filter")&&(e.willChange=[...n,"filter"].join(", "));const i=t.map((t=>`drop-shadow(${t.offsetX}px ${t.offsetY}px ${t.blur}px ${t.color})`));e.filter=i.join(" ")}}else n.indexOf("filter")>-1&&(e.willChange=n.filter((t=>"filter"!==t)).join(", "),e.filter="")}ir(t=[]){var e,n,s;if(t.length){const r=t.map((t=>Object.assign(Object.assign({},t),{color:t.color.toString()}))),o=this._r();let h=this.As.length!==r.length||o!==this.Es;if(h||(h=r.some(((t,i)=>{const e=this.As&&this.As[i];return!e||t.blur!==e.blur||t.spread!==e.spread||t.offsetX!==e.offsetX||t.offsetY!==e.offsetY||t.color!==e.color}))),r.length!==(null===(e=this.As)||void 0===e?void 0:e.length)&&(this.xr=void 0),this.As=r,!h)return;this.Es=o,this.Fr();const a=this.Ds+Xt.Group,{width:c,height:u}=this.ys,l=this.Es===Zt.SvgShadow?t.length:0;for(;this._s.length>l;){const t=this._s.pop(),i=this.Fs.pop();null===(n=t.parentNode)||void 0===n||n.removeChild(t),null===(s=i.parentNode)||void 0===s||s.removeChild(i)}if(this.Es!==Zt.SvgShadow)return this.yr(this.As),void this.or();this.yr(),t.forEach(((t,e)=>{const n=t.color,s=this.Ds+Xt.Shadow+e;let r=this._s[e],o=this.Fs[e];if(!r){r=document.createElementNS(Wt,"filter"),r.id=s,r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("width","300%"),r.setAttribute("height","300%"),Gt(r,-100,-100,"%");const t=document.createElementNS(Wt,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("in","SourceGraphic"),t.setAttribute("result",`${s}_color`),r.appendChild(t);const i=document.createElementNS(Wt,"feGaussianBlur");i.setAttribute("type","matrix"),i.setAttribute("result",`${s}_blur`),i.setAttribute("in",`${s}_color`),r.appendChild(i),this._s.push(r),this.Vs.appendChild(r)}o||(o=document.createElementNS(Wt,"use"),o.setAttributeNS(Yt,"xlink:href",`${this.$s}#${a}`),o.setAttribute("filter",`url(${this.$s}#${s})`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),Gt(o,0,0),o.style.transformOrigin="50% 50%",this.Fs.push(o),(0,i.BE)(this.Vs,o));const h=`0 0 0 0 ${n.red/255} 0 0 0 0 ${n.green/255} 0 0 0 0 ${n.blue/255} 0 0 0 ${n.alpha/100} 0`;r.getElementsByTagName("feColorMatrix")[0].setAttribute("values",h),r.getElementsByTagName("feGaussianBlur")[0].setAttribute("stdDeviation",`${t.blur}`),Gt(o,t.offsetX,t.offsetY),o.style.transform=`scaleX(${1+t.spread/c}) scaleY(${1+t.spread/u})`})),this.or()}}async Gs(t){var i,e;if(t===this.Cr)return;this.Cr=t;const n=this.Ds+Xt.Clip;if(!this.nr){const t=this.nr=document.createElementNS(Wt,"image");Gt(t,0,0),this.mr(),this.Us.insertBefore(t,this.wr),t.setAttribute("clip-path",`url(${this.$s}#${n})`)}t&&(0,c.$Q)(this.ks)?((null===(i=this.ks.imageAsset)||void 0===i?void 0:i.__loading)&&this.Xs(),await this.Ar(t),(null===(e=this.ks.imageAsset)||void 0===e?void 0:e.__loading)||this.Qs()):this.Er(!0)}Ar(t){if(t=(0,C.Nm)(t),!this.nr||!this.Cr)throw new Error("No image element added to svg");const i=(0,z.Vk)();if(z.G6&&i<14||z.un&&i<20)this.Sr=function(t){return A(new Image,t)}(t);else{const i=new E;this.nr.addEventListener("load",(()=>i.resolve())),this.nr.addEventListener("error",(()=>{this.Er(),i.reject(new qt(Nt.ImageLoadingFailed,t))})),this.Sr=i}return this.nr.setAttributeNS(Yt,"xlink:href",t),this.nr.setAttribute("src",t),this.Sr.promise}Er(t=!1){this.nr&&(this.Sr&&t&&this.Sr.reject(Nt.ImageRemovedDuringLoad),this.nr.removeAttributeNS(Yt,"xlink:href"),this.nr.removeAttribute("xlink:href"),this.nr.removeAttribute("src"))}ar(){if(this.Bs===ot.OH.Image&&this.nr){const t=this.qs,i=t.__data,n=this.nr,s=this.Ss(i),r=e.b3.c(t),o=this.Or(t,i.imageSettings,i.imageAsset,!!t.feed,r);let h=o.x<0?o.x:0,a=o.y<0?o.y:0,c=Math.max(this.Ps+Math.abs(o.x),0),u=Math.max(this.Ns+Math.abs(o.y),0);if(i.imageSettings.sizeMode!==Ht.Jr.Crop&&(h=0,a=0,c=this.Ps,u=this.Ns),this.$r&&this.$r.x===h&&this.$r.y===a&&this.$r.width===c&&this.$r.height===u&&this.$r.fillOption===s)return;this.Rs.style.overflow=i.imageSettings.sizeMode===Ht.Jr.Crop?"hidden":"visible",n.setAttribute("width",`${c}`),n.setAttribute("height",`${u}`),n.setAttribute("preserveAspectRatio",s);const l=this.er();Gt(n,h+l,a+l),this.pr&&Gt(this.pr,l,l),this.$r={x:h,y:a,width:c,height:u,fillOption:s}}}or(){if(0===this.As.length)return;const t=this.zs,i=this.As||[],{width:e,height:n}=this.ys,s=this.er(),r=Math.ceil(e+2*s),o=Math.ceil(n+2*s),h={width:r,height:o};this.xr&&(0,yt.Bq)(this.xr,h)||(this.xr=h,t.style.left=`-${s}px`,t.style.top=`-${s}px`,t.style.width=`${r}px`,t.style.height=`${o}px`,t.setAttribute("width",`${r}`),t.setAttribute("height",`${o}`),this.Bs===ot.OH.Ellipse?(this.Rs.setAttribute("cx",r/2+"px"),this.Rs.setAttribute("cy",o/2+"px")):(Gt(this.Rs,s,s),this.Bs===ot.OH.Image&&this.$r&&(this.nr&&Gt(this.nr,this.$r.x+s,this.$r.y+s),this.pr&&Gt(this.pr,s,s))),this._r()!==Zt.SvgShadow?this.yr(i):i.forEach(((t,i)=>{this.Fs[i].style.transform=`scaleX(${1+t.spread/e}) scaleY(${1+t.spread/n})`})))}Fr(){var t;const i=this.Es,e=null===(t=this.br)||void 0===t?void 0:t.thickness,n=i===Zt.None&&!e||i===Zt.SvgShadow;this.zs.style.overflow=n?"clip":"visible"}Or(t,i,e,n,s){let r=0,o=0;if(!n&&!s&&(null==e?void 0:e.width)&&(null==e?void 0:e.height)){const n=Object.assign(Object.assign({},(0,yt.vd)(e,t,"cover")),{x:0,y:0}),s=n.width-t.width,h=n.height-t.height;s>0&&(r=Math.round((1-2*i.x)*s)),h>0&&(o=Math.round((1-2*i.y)*h))}return{x:r,y:o}}er(){var t;if(this._r()!==Zt.SvgShadow)return 0;const i=this.Dr();return((null===(t=this.ys.border)||void 0===t?void 0:t.thickness)||0)+i.reduce(((t,i)=>{const e=Math.max(Math.abs(i.offsetX),Math.abs(i.offsetY));return Math.max(t,e+2*i.blur+i.spread)}),0)}_r(){const t=this.ks,i=this.Dr();if(i.length&&t){return i.some((t=>t.spread>0))?z.vU&&i.length>1?Zt.DropShadow:Zt.SvgShadow:Zt.DropShadow}return Zt.None}Dr(){const t=this.ks;return t?[...t.states.map((t=>t.shadows||[])).reduce(((t,i)=>t.concat(i)),[]),...t.shadows||[]]:[]}}function Gt(t,i,e,n="px"){const s=i+n,r=e+n;t.getAttribute("x")!==s&&t.setAttribute("x",s),t.getAttribute("y")!==r&&t.setAttribute("y",r)}function Jt(t,i){if(!(0,c.YC)(t)||!(0,c.xj)(t))switch(t.kind){case ot.OH.Creative:i.Br(t);break;case ot.OH.Rectangle:i.jr(t);break;case ot.OH.Ellipse:i.Mr(t);break;case ot.OH.Image:i.Ir(t);break;case ot.OH.Text:i.kr(t);break;case ot.OH.Button:i.Tr(t);break;case ot.OH.Widget:i.Rr(t);break;case ot.OH.Video:i.Lr(t)}}function Kt(t,i,e=!1){switch(t.kind){case ot.OH.Creative:i.Br(t),ti(t.nodes,i,e);break;case ot.OH.Group:ti(t.nodes,i,e);break;default:e&&!(0,c.BM)(t)||Jt(t,i)}}function ti(t,i,e=!1){for(const n of t)(0,c.xj)(n)||Kt(n,i,e)}!function(t){t[t.None=0]="None",t[t.DropShadow=1]="DropShadow",t[t.BoxShadow=2]="BoxShadow",t[t.SvgShadow=3]="SvgShadow"}(Zt||(Zt={}));let ii=0,ei=class t extends Y.v{get zr(){return{width:this.viewTree.width,height:this.viewTree.height}}get creativeSize(){return{width:this.creativeDocument.width,height:this.creativeDocument.height}}get isEditorMode(){return window.bfstudio&&!window.bfstudio.inPreviewMode}get creativeDocument(){return this.Pr}constructor(t,i,e={},n,s,r,o){super(),this.container=t,this.Nr=n,this.feedStore=s,this.WidgetRenderer=r,this.ad=o,this.Hr=new Map,this.Vr=0,this.loop=1,this.storedViewElements=new Map,this.Ur=!1,this.Wr=new Map,this.Yr=new Map,this.Xr=!1,this.preloadingElements=new Map,this.logger=window.logger&&"bannerflow"===window.app?new window.logger("Renderer"+ii++):void 0,this.Vt=1,this.Zr=t=>{this.isEditorMode||(0,c.sL)(this.viewTree,(i=>{var e;if(i.__actionListeners)for(const n of i.__actionListeners){if(n.trigger!==R.MouseLeave)continue;const s=this.qr(i.__data).find((t=>n.action.operations.find((i=>i.value===t.state.id))));!s||(null===(e=null==s?void 0:s.animation)||void 0===e?void 0:e.isPlaying)||g(i.__rootElement,t.target)||n.event(t,!0)}}))},this.oi=(t,i,e)=>{if(!this.isEditorMode){if(this.Xr)return t.stopPropagation(),void(this.Xr=!1);if(e){if(this.Qr(t,e))return}this.Nr.STUDIO_JS||t.stopPropagation(),this.emit("click",[t,i])}},this.updateViewElementValues=()=>{this.X(this.Vr)},this.setCreativeDocument(i),this.Gr=e.versions,this.Kr=e.inDesignView||!1,this.bs=e.contentWindow||window,this.io=this.bs.document,this.eo=this.io.createElement("style"),this.io.head.appendChild(this.eo),this.no=this.eo.sheet,this.so=this.io.createDocumentFragment(),this.ro(),this.oo=this.Nr.STUDIO_JS?new Map:void 0,this.Nr.STUDIO_JS&&this.feedStore&&this.feedStore.on("dataChanged",this.updateViewElementValues)}ho(t){return(0,c.zX)(this.creativeDocument).findIndex((i=>i.id===t.id))}setCreativeDocument(t){this.Pr=t}U(t){this.ao=t}getViewElementById(t){return this.viewTree.nodes.find((i=>i.id===t))}Br(i){const e=!0===this.Nr.STUDIO_JS;this.co=`b${t.uo}`,this.rootElement=this.io.createElement("div"),this.rootElement.setAttribute("data-banner",""),this.rootElement.setAttribute("data-creative",""),this.Wr.set(this.co,this.rootElement),this.lo(i),this.viewTree.fill=i.fill,this.viewTree.border=i.border,this.viewTree.__rootElement=this.rootElement,this.do(this.co,{width:"100%",height:"100%",boxSizing:"border-box",position:"relative",overflow:e?"visible":"clip",fontFamily:'Helvetica, Arial, Tahoma, "Microsoft Yahei", 微软雅黑, STXihei, 华文细黑, sans-serif',"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"}),this.fo(this.viewTree),this.so.appendChild(this.rootElement),t.uo++,this.rootElement.addEventListener("mousemove",this.Zr)}jr(t){const i=this.po(t);return this.vo(i),i}Mr(t){const i=this.po(t);return this.vo(i),i}kr(t){return this.mo(t)}Tr(t){return this.mo(t)}mo(t){const i=this.po(t);if(i.__rootElement.classList.add("text"),this.do(i.elementCid,this.go(i)),this.Nr.STUDIO_JS&&t.font){for(const[i,e]of t.characterStyles.entries())e.font&&this.injectFontFace(e.font);this.injectFontFace(t.font)}return self.inServer||this.wo(i),i}Ir(t){const i=this.po(t);return this.bo(t,i),i}Rr(t){const i=this.po(t),e=i.__rootElement.parentNode;return e&&(e.querySelector(`#widget-${t.id}`)||this.WidgetRenderer.createWidget(i,t)),i}Lr(t,i){const e=this.po(t);if(i)return e;this.bo(t,e);const n=this.container.resolve(14);return e.__videoRenderer=n(e),e}bo(t,i){const e=e=>{let n="";t.feed&&this.feedStore&&(n=this.feedStore.getFeedValue(t.feed,t.id).targetUrl),this.oi(e,n,i)};this.on("destroy",(()=>{i.__rootElement&&i.__rootElement.removeEventListener("click",e)})),i.__rootElement.addEventListener("click",e)}vo(t){const i=i=>{this.isEditorMode||this.oi(i,void 0,t)};t.__rootElement.addEventListener("click",i),this.on("destroy",(()=>t.__rootElement.removeEventListener("click",i)))}Qr(t,i){var e;const n=(null===(e=i.__actionListeners)||void 0===e?void 0:e.filter((t=>t.trigger===R.Click&&!t.action.disabled)))||[];if(n.length){for(const i of n){if(i.action.operations.some((t=>t.method===T.OpenUrl))){i.event(t);break}i.event(t)}return!0}return!1}fo(t,i){var e;t.__svgBackground||(t.__svgBackground=new Qt(this.bs,t,this.Nr));const n=t.__svgBackground,s=(0,c.$Q)(t)||(0,c.iN)(t),r=n.W(t,i);if(r&&s){const i=t.id;this.preloadingElements.has(i)||(null===(e=this.logger)||void 0===e||e.verbose("[SvgBackground] adding image to preload:",i),this.preloadingElements.set(i,r))}}setCreativeStyle(t,i){Object.assign(this.creativeDocument,{[t]:i}),Object.assign(this.viewTree,{[t]:i}),this.fo(this.viewTree)}_o(t){var i;const r=t.feed,o=this.storedViewElements.get(t.id),h=null===(i=this.feedStore)||void 0===i?void 0:i.getFeedValueUrl(r,t.id,t),a=t.imageAsset,c=this.Nr.MODE===s.y.DesignView&&this.isEditorMode,u=this.Nr.MODE===s.y.ManageView,l=t.id,d=h||(null==a?void 0:a.url);if((0,n.Zp)(d))return d;if(!(0,n.CB)(d))return"";if(r&&!h)return"";if((c||u)&&l&&this.oo){const i=this.oo.get(l);if(i&&window.clearTimeout(i),(0,e.Ty)(o.imageUrl)===d)return this.oo.set(l,window.setTimeout((()=>{this.xo(t)}),1e3)),o.imageUrl}else if((0,e.Ty)(o.imageUrl)===d)return o.imageUrl;const f={width:this.creativeDocument.width*this.Vt*2,height:this.creativeDocument.height*this.Vt*2};let p;return c||(p=e.b3.getCroppingOptions(t)),e.b3.a(t,{feedUrl:h,force:c,sizeLimit:f,cropping:p})}xo(t){if(!this.Ur){const i=this.storedViewElements.get(t.id);if(!i)return;i.imageUrl=void 0,i.imageUrl=this._o(t),this.fo(i)}}Fo(t,i,e){const n=this.qr(t);let s=this.Co(t,i);return s?s.rate=e:(s={state:i,rate:e},n.push(s)),this.Yr.set(t.id,n),s}Co(t,i){return this.qr(t).find((t=>i===t.state))}qr(t){return this.Yr.get(t.id)||[]}Ao(){this.Yr.forEach(((t,i)=>{const e=this.Eo(i);e&&this.So(e)}))}Oo(t,i){const e=this.Yr.get(t.id),n=(null==e?void 0:e.filter((t=>t.state.id!==i.id)))||[];this.Yr.delete(t.id),this.Yr.set(t.id,n)}So(t,i=!0){const e=this.qr(t);this.Yr.delete(t.id),e.length&&(e.forEach((t=>{var i;return null===(i=t.animation)||void 0===i?void 0:i.pause()})),i&&this.$o(t))}wo(t){var i,e;let n=t.__richTextRenderer;const s=t.__data;if(n)return void n.rerender();const r={feedStore:this.feedStore,element:s,viewElement:t,skipFontLoad:this.Do,document:this.creativeDocument,inDesignView:this.Kr},o={spans:(null===(i=s.__dirtyContent)||void 0===i?void 0:i.spans)||s.content.spans,style:(0,S.ei)(Object.assign(t,(null===(e=s.__dirtyContent)||void 0===e?void 0:e.style)||{}),"width","height",...N.Gc)},h=this.container.resolve(22);n=t.__richTextRenderer=h(o,t.__rootElement,r),n.n();const c=()=>{this.emit("textElementInteractionsStarted",[n])},u=()=>{this.emit("textElementInteractionsEnded",[n])},l=()=>{null==n||n.off("interactionsStarted",c),null==n||n.off("interactionsEnded",u),null==n||n.off("destroyed",l)},d=(t,i)=>{this.oi(t,i)},f=i=>{var e;let n="";try{if(this.feedStore){const i=(null===(e=t.__richTextRenderer)||void 0===e?void 0:e.Et.spans)||[];for(const t of i)if((0,a.WT)(t)&&t.style.variable){n=this.feedStore.getFeedValue(t.style.variable,t.style.variable.spanId).targetUrl;break}}}catch(s){}this.oi(i,n,t)};t.__rootElement.addEventListener("click",f),this.on("destroy",(()=>{t.__rootElement&&t.__rootElement.removeEventListener("click",f)})),n.off("interactionsStarted",c),n.off("interactionsEnded",u),n.off("destroyed",l),n.off("spanClicked",d),n.on("interactionsStarted",c),n.on("interactionsEnded",u),n.on("spanClicked",d),n.on("destroyed",l)}Bo(t,i,e=!0){var n;if((0,c.xj)(t))return void this.jo(t);this.Mo(t);const s=this.storedViewElements.get(t.id);if(!s)throw new Error("Could not find view node");s.duration=t.duration,s.time=t.time;const r=0===i,o=null===(n=this.Yr.get(t.id))||void 0===n?void 0:n.map((t=>t)),h=(0,X.Uu)(t,this.Vr)&&!this.Io(s);if(!e||h||r){const n=kt(t,this.creativeSize,i,o);this.ko(s,t,n,e)}else s.opacity=0,this.To(s)}ko(t,i,e,n=!0){var s,r,o,h,a,u,l,d;null===(s=this.logger)||void 0===s||s.debug(`_setViewElementValuesWithState[${i.name}]`);const f=(0,c.mO)(i);if(t.x=Mt("x",i,e,this.Vt),t.y=Mt("y",i,e,this.Vt),t.width=Mt("width",i,e,f?void 0:this.Vt),t.height=Mt("height",i,e,f?void 0:this.Vt),t.originX=Mt("originX",i,e),t.originY=Mt("originY",i,e),t.scaleX=Mt("scaleX",i,e,f?this.Vt:void 0),t.scaleY=Mt("scaleY",i,e,f?this.Vt:void 0),t.rotationX=Mt("rotationX",i,e),t.rotationY=Mt("rotationY",i,e),t.rotationZ=Mt("rotationZ",i,e),t.mirrorX=Mt("mirrorX",i,e),t.mirrorY=Mt("mirrorY",i,e),t.opacity=Mt("opacity",i,e),t.border=Mt("border",i,e,this.Vt),t.fill=Mt("fill",i,e),t.shadows=Mt("shadows",i,e,this.Vt),t.radius=Mt("radius",i,e,this.Vt),t.filters=Mt("filters",i,e),t.perspective=this.Ro(i),f&&1!==this.Vt&&(t.x-=t.width*(1-this.Vt)/2,t.y-=t.height*(1-this.Vt)/2),(0,c.$Q)(t)){const n=i;n.feed?(t.feed=Mt("feed",n,e),n.imageAsset=void 0):n.imageAsset&&(t.feed=n.feed=void 0),t.imageUrl=this._o(t.__data)}const p={};if((0,c.BM)(t)){const n={},s=["textColor"];for(const i of s)n[i]=t[i];t.content.spans.forEach((t=>{"word"!==t.type&&"composition"!==t.type&&"space"!==t.type&&"variable"!==t.type&&"newline"!==t.type||t.style.textShadows&&(t.style.textShadows=t.style.textShadows.map((t=>It("TextShadow[]",t,this.Vt))))})),t.textColor=Mt("textColor",i,e),t.textShadows=Mt("textShadows",i,e,this.Vt),t.underline=Mt("underline",i,e),t.strikethrough=Mt("strikethrough",i,e),t.uppercase=Mt("uppercase",i,e),t.textOverflow=Mt("textOverflow",i,e),t.lineHeight=Mt("lineHeight",i,e),t.fontSize=Mt("fontSize",i,e,this.Vt),t.maxRows=Mt("maxRows",i,e),t.padding=Mt("padding",i,e,this.Vt),t.characterSpacing=Mt("characterSpacing",i,e),t.horizontalAlignment=Mt("horizontalAlignment",i,e),t.verticalAlignment=Mt("verticalAlignment",i,e);const c=i.__dirtyContent,d=null!==(r=null==c?void 0:c.style.fontSize)&&void 0!==r?r:t.fontSize,f=null!==(o=null==c?void 0:c.style.textShadows)&&void 0!==o?o:t.textShadows,v=null!==(h=null==c?void 0:c.style.padding)&&void 0!==h?h:t.padding;null===(a=t.__richTextRenderer)||void 0===a||a.me("textShadows",f,t.__richTextRenderer.style),null===(u=t.__richTextRenderer)||void 0===u||u.me("fontSize",d,t.__richTextRenderer.style),null===(l=t.__richTextRenderer)||void 0===l||l.me("padding",v,t.__richTextRenderer.style);for(const i of s)p[i]=!(0,S.vZ)(t[i],n[i])}(0,c.iN)(t)&&t.__videoRenderer&&t.__videoRenderer.updateVideo(),f&&(null===(d=i.__widget)||void 0===d||d.emit(mt.zu.ViewNodeChanged,[t])),n&&(this.fo(t),this.To(t,p))}Io(t){const i=t.time+t.duration;return!!(0,X.wU)(i,this.Vr,.001)&&this.creativeDocument.elements.some((({time:t})=>(0,X.wU)(i,t,.001)))}To(t,i){var e,n,s,r,o;const h=this.Hr.get(t.elementCid);if(!h)throw new Error("Could not get stylerule for element. "+(this.Nr.STUDIO_JS?"This is most likely caused by the element no longer existing from an undo/redo.":""));const{current:a,previous:u}=h;a.rawStyleValue=this.go(t);const l=(0,S.xF)(u.rawStyleValue,a.rawStyleValue),d=["pointerEvents","transform","width","height","opacity","filter","visibility"];for(const c of d)c in l&&(t.__rootElement.style[c]=l[c]);if(l.backfaceVisibility&&(u.styleRule.style.backfaceVisibility=l.backfaceVisibility),(0,c.BM)(t)){const h=void 0!==l.width||void 0!==l.height;let a=!1;const c=null===(e=t.__richTextRenderer)||void 0===e?void 0:e.At;if((h||this.Lo&&c)&&(a=!!(null==c?void 0:c.elements.get(t.id))||!!(null===(n=t.__richTextRenderer)||void 0===n?void 0:n.Et.spans.find((t=>"variable"===t.type)))||!!(null===(s=t.__dirtyContent)||void 0===s?void 0:s.spans.find((t=>"variable"===t.type)))),null==i?void 0:i.textColor){const i=t.textColor;null===(r=t.__richTextRenderer)||void 0===r||r.On({textColor:i})}(a||h)&&(null===(o=t.__richTextRenderer)||void 0===o||o.rerender(!1,t))}u.rawStyleValue=a.rawStyleValue,u.styleRule=a.styleRule}X(t,i){this.Ur||(this.Vr=t,i&&(this.Lo=i),(0,c.qL)(this.creativeDocument,(i=>{(0,c.xj)(i)||this.Bo(i,t)})),this.Lo=!1)}updateCreativeValues(){this.fo(this.viewTree)}$o(t){this.Bo(t,this.Vr)}zo(t){const i=this.Eo(t);i&&this.$o(i)}Po(t){const i=this.viewTree.nodes.find((i=>i.id===t.id));if((0,c.AA)(i))return;let e={callback:(e,n,s)=>{if(this.isEditorMode)return;if(n===R.TouchStart&&(this.No=!0),n===R.MouseLeave&&!s&&e.target!==i.__rootElement)return;if(this.No&&n.startsWith("mouse"))return;const r=e instanceof MouseEvent?e.relatedTarget:e.target;n!==R.MouseLeave&&r&&!this.io.body.contains(r)||t.actions.filter((t=>t.triggers.find((t=>t===n)))).forEach((t=>{t.disabled||t.operations.forEach((i=>{switch(i.method){case T.OpenUrl:this.oi(e,i.value);break;case T.SetState:case T.RemoveState:case T.ClearStates:t.preventClickThrough&&(this.Xr=!0),this.Ho(i,t,n)}}))}))}};e=Object.assign(Object.assign({},e),function(t){const i={};for(const e in R)i[R[e]]=(i,n)=>t.callback(i,R[e],n);return i}(e)),i.__actionListeners=i.__actionListeners||[];for(const n of i.__actionListeners)i.__rootElement.removeEventListener(n.trigger,n.event,!0);i.__actionListeners=[];for(const n of t.actions)if(!n.disabled)for(const t of n.triggers)t!==R.Click&&(t===R.TouchStart?i.__rootElement.addEventListener(t,e[t],{passive:!0}):i.__rootElement.addEventListener(t,e[t],!0)),i.__actionListeners.push({trigger:t,event:e[t],action:n})}Ho(t,i,e){var n,s;const r=this.viewTree.nodes.find((i=>i.id===t.target));if(!r)return;const o=r.__data,h=t.value;if(!h&&(t.method===T.SetState||t.method===T.RemoveState))return;if("reserved-pressed"===i.templateId&&function(t){return t===R.MouseLeave||t===R.TouchEnd||t===R.TouchCancel}(e)){const t=o.actions.find((t=>"reserved-pressed"===t.templateId&&t.operations.find((t=>t.value)))),i=this.qr(o).find((i=>i.state.id===t.operations[0].value));if(!i||0===i.rate)return}const a=o.states.find((t=>t.id===h)),c={duration:null!==(n=t.animation.duration)&&void 0!==n?n:.2,timingFunction:t.animation.timingFunction,customFPSInterval:(0,X.ot)(null===(s=this.ad)||void 0===s?void 0:s.parameters.fps),callback:()=>{this.ao||this.Bo(o,this.Vr)}};if(a){const i=this.qr(o).find((t=>t.animation&&t.state.id===a.id));if(i)t.method===T.RemoveState?this.qr(o).filter((t=>a===t.state&&t.animation)).forEach((t=>{(null==t?void 0:t.animation)&&t.animation.to({rate:0},c)})):i.animation.to({rate:1},c);else if(t.method===T.SetState){const t=this.Fo(o,a,0);t.animation=vt.to(t,{rate:1},c),t.animation.onCompleted((()=>{0===t.rate&&this.Oo(o,a)}))}}else a&&t.method!==T.ClearStates||this.qr(o).filter((t=>t.animation)).forEach((t=>{(null==t?void 0:t.animation)&&t.animation.to({rate:0},c)}))}Vo(t){var i,e;null===(i=this.logger)||void 0===i||i.debug("rerender_m"),this.Do=!1,this.setCreativeDocument(t),this.Uo(),this.ro(),this.so=this.io.createDocumentFragment(),(0,c.LY)(),this.Wo.innerHTML="",this.Yo(),Kt(this.creativeDocument,this),this.rootElement.addEventListener("click",this.oi),this.Xo(this.Do),this.Zo(),this.Wo.appendChild(this.so),null===(e=this.WidgetRenderer)||void 0===e||e.creativeApi.bind()}qo(t,i,e=!0){this.Wo.innerHTML="",this.Vr=t,this.Do=i,e&&(0,c.LY)(),this.ro(),this.Yo()}Xo(t){this.Qo();for(const i of this.creativeDocument.elements){if((0,c.xj)(i))continue;if(t&&!(0,c.BM)(i))continue;const e=this.storedViewElements.get(i.id),n=this.Hr.get(e.elementCid).current.styleRule,s=[];for(let t=0;t<n.style.length;t++)"transform"===n.style[t]&&(1!==this.Vt&&(0,c.BM)(i)||1===this.Vt)&&s.push(n.style[t]),n.style[t].match(/(opacity|perspectiveOrigin)/)&&s.push(n.style[t]);n.style.willChange=s.join(", ")}this.Zo()}initialize(t,i=0,e=!1){var n;if(null===(n=this.logger)||void 0===n||n.verbose("initialize"),this.Ur)return;this.Wo=t,this.qo(i,e,!1);const{width:s}=t.getBoundingClientRect(),r=this.creativeDocument.width,o=this.Go(s,r);this.Jo(o),Kt(this.creativeDocument,this,e),this.Xo(e),this.Wo.appendChild(this.so),this.rootElement.addEventListener("click",this.oi),this.Ko(t)}render(t,i=0,e=!1){var n;null===(n=this.logger)||void 0===n||n.verbose("render"),this.Vr=i,this.Do=e;const{width:s}=t.getBoundingClientRect(),r=this.creativeDocument.width,o=this.Go(s,r);this.Jo(o),t.innerHTML="",this.ro(),this.Yo(),this.Ur||(this.Br(this.creativeDocument),ti(this.creativeDocument.elements,this,e),this.rootElement.addEventListener("click",this.oi),this.Xo(e),this.Zo(),t.appendChild(this.so),this.Wo=t,this.Ko(t))}Uo(){var t,i;(0,c.sL)(this.viewTree,(t=>{var i;(0,c.BM)(t)&&(null===(i=t.__richTextRenderer)||void 0===i||i.Di()),(0,c.iN)(t)&&t.__videoRenderer.destroy();const e=this.Hr.get(t.elementCid);e.current.styleRule.style.willChange="",e.previous.styleRule.style.willChange="",t.__rootElement&&t.__rootElement.removeEventListener("click",this.oi)})),null===(t=this.rootElement)||void 0===t||t.removeEventListener("click",this.oi),null===(i=this.rootElement)||void 0===i||i.removeEventListener("mousemove",this.Zr)}th(t){const i=this.creativeDocument.at(t.id,!0);if(!i)throw new Error(`Could not find ${t.kind}`);(i.__parentNode||this.creativeDocument).ct(i.id),(0,c.AA)(i)||this.destroyViewElement(i)}destroyViewElement(t){var i,e;this.So(t,!1);const n=this.storedViewElements.get(t.id);if(!n)return;this.viewTree.nodes=this.viewTree.nodes.filter((t=>t.id!==n.id)),this.storedViewElements.delete(n.id);const s=n.elementCid,r=this.Hr.get(s);this.ih(r.current.styleRule);const o=null===(i=this.oo)||void 0===i?void 0:i.get(s);o&&window.clearTimeout(o),(0,c.BM)(n)&&n.__richTextRenderer&&(n.__richTextRenderer.Di(),n.__richTextRenderer=void 0),(0,c.mO)(n)&&(null===(e=n.__data.__widget)||void 0===e||e.destroy()),(0,c.iN)(n)&&n.__videoRenderer.destroy();const h=n.__safari3dElement||n.__rootElement;if(!h)throw new Error("HTML element does not exist on canvas.");this.rootElement.removeChild(h)}destroy(){var t;this.emit("destroy"),this.eo&&this.eo.parentNode&&this.eo.parentNode.removeChild(this.eo),this.Uo(),this.Ao(),this.feedStore&&(this.feedStore.destroy(),this.feedStore.off("dataChanged",this.updateViewElementValues));for(const i of this.creativeDocument.elements)this.th(i);this.no=void 0,this.Hr.clear(),this.WidgetRenderer&&this.WidgetRenderer.destroy(),this.storedViewElements.clear(),null===(t=this.eh)||void 0===t||t.disconnect(),this.Ur=!0,this.clearEvents()}po(t){const i=(0,c.oK)(t);return this.storedViewElements.set(t.id,i),this.Bo(t,this.Vr,!1),i.__rootElement=this.nh(i),this.do(i.elementCid,Object.assign({},this.go(i))),this.fo(i),this.viewTree.nodes.push(i),this.Zo(),this.Po(t),i}Zo(){const t=this.creativeDocument.elements;this.viewTree.nodes.sort(((i,e)=>t.indexOf(i.__data)-t.indexOf(e.__data))),(0,c.sL)(this.viewTree,((t,i,e)=>this.sh(t,e)))}rh(t){this.sh(t,Number.MAX_VALUE)}sh(t,i){const e=t.__safari3dElement||t.__rootElement,n=null==e?void 0:e.parentNode;if(e&&n){const t=Array.from(n.children).filter((t=>"DIV"===t.tagName)),s=(null==t?void 0:t.length)?t.indexOf(e):-1;s>-1&&s!==i&&n.insertBefore(e,t[i]||null)}}go(t){const i=(0,X.Uu)(t.__data,this.Vr),e="number"==typeof t.opacity?{opacity:`${i?t.opacity:0}`}:void 0,n=t.filters||{},s=Object.entries(n).filter((([t,i])=>void 0!==(null==i?void 0:i.value))).map((([t,i])=>{var e;const n=null===(e=ht[t])||void 0===e?void 0:e.unit;return`${t}(${i.value.toFixed(0)}${n})`})).join(" ");let r=!1;!z.HM&&z.ce.simple<=0&&(r=!0);return Object.assign(Object.assign(Object.assign(Object.assign({pointerEvents:i?"auto":"none"},this.oh(t)),"number"==typeof t.radius?{borderRadius:`${t.radius}px`}:void 0),e),{visibility:r||i?"visible":"hidden",filter:s||"unset"})}hh(){var t;for(const i of this.viewTree.nodes)(0,c.BM)(i)&&(null===(t=i.__richTextRenderer)||void 0===t||t.rerender())}Ro(t){return 2*Math.max(t.width,t.height)}oh(t){return{width:`${t.width}px`,height:`${t.height}px`,transform:this.ah(t)}}ch(t,i=!1){const e=this.uh(t);let n=i?"":`translate(${t.x}px, ${t.y}px)`;return t.rotationZ&&(n+=` rotateZ(${t.rotationZ}rad)`),t.rotationY&&(n+=` rotateY(${t.rotationY}rad)`),t.rotationX&&(n+=` rotateX(${t.rotationX}rad)`),n+=` scaleX(${e.x})`,n+=` scaleY(${e.y})`,n}ah(t){const i=this.uh(t),e=new pt;return e.Wn(t.x,t.y),e.is(t.perspective||800),t.rotationZ&&e.Vn(t.rotationZ),t.rotationY&&e.Hn(t.rotationY),t.rotationX&&e.Nn(t.rotationX),e.Yn(i.x,i.y),t.rotationY||t.rotationX||t.kind!==ot.OH.Image||e.Hn(2*Math.PI),e.Rn()}uh(t){return{x:("number"==typeof t.scaleX?t.scaleX:1)*(t.mirrorX?-1:1),y:("number"==typeof t.scaleY?t.scaleY:1)*(t.mirrorY?-1:1)}}ih(t){for(let i=this.no.cssRules.length-1;i>=0;i--)if(this.no.cssRules[i].selectorText===t.selectorText){this.no.deleteRule(i);break}}Yo(){this.Hr.clear();for(let t=(this.no&&this.no.cssRules?this.no.cssRules.length:0)-1;t>2;t--)this.no.deleteRule(t)}Qo(){const t=this.no;z.G6&&t.insertRule(`#${this.co} .safari-3d {position:absolute;left:0;top:0;bottom:0;right:0,pointer-events:none; transform: translateZ(0); }`,t.cssRules.length),t.insertRule(`#${this.co} .element{position:absolute;left:0;top:0;}`,t.cssRules.length),t.insertRule(`#${this.co} .text>div{position:relative;}`,t.cssRules.length)}do(t,i){let e;e=t!==this.co?`#${this.co} #${t}`:`#${t}`;let n="";for(const o in i)if(i[o]){n+=`${o.replace(/([A-Z])/g,(t=>`-${t.toLowerCase()}`))}:${i[o]};`}this.no.insertRule(`${e}{${n}}`,this.no.cssRules.length);const s=this.no.cssRules[this.no.cssRules.length-1],r=this.lh(s);this.Hr.set(t,{previous:{styleRule:s,rawStyleValue:r},current:{styleRule:s,rawStyleValue:r}});this.Wr.get(t).setAttribute("id",t)}lh(t){const i={};for(let e=0;e<t.style.length;e++){i[t.style[e]]=t.style[t.style[e]]}return i}nh(t){const i=this.io.createElement("div");if(this.Wr.set(t.elementCid,i),this.Nr.IN_TEST&&(t.name&&i.setAttribute("data-test-name",t.name),i.setAttribute("data-test-id",`element-kind-${t.kind}`)),i.classList.add("element",`kind-${t.kind}`),z.G6){const e=this.io.createElement("div");e.classList.add("safari-3d"),e.appendChild(i),t.__safari3dElement=e,this.rootElement.appendChild(e)}else this.rootElement.appendChild(i);return i}async injectFontFace(t){try{const i=await y(t);this.io.fonts.has(i)||this.io.fonts.add(i)}catch(i){(0,W.S3)("Could not load font",{enabled:this.Nr.STUDIO_JS,contexts:{font:t,originalError:i}})}}Eo(t){var i;return null===(i=this.storedViewElements.get(t))||void 0===i?void 0:i.__data}dh(){return this.Vt}Jo(t){var i,e;t!==this.Vt&&(0!==t?(null===(e=this.logger)||void 0===e||e.debug(`setting scale: ${t}`),this.Vt=t,this.lo(this.creativeDocument)):null===(i=this.logger)||void 0===i||i.verbose("Trying to set scale to 0. Aborting."))}fh(t){this.Jo(t),this.creativeDocument.elements.every((t=>this.storedViewElements.has(t.id)||(0,c.xj)(t)))&&(this.updateCreativeValues(),this.updateViewElementValues())}lo(t){this.viewTree.width=t.width*this.Vt,this.viewTree.height=t.height*this.Vt}Go(t,i){return t/i}Ko(t){var i,e;(null===(i=this.ad)||void 0===i?void 0:i.responsive)&&"undefined"!=typeof ResizeObserver&&(null===(e=this.logger)||void 0===e||e.verbose("initializing ResizeObserver"),this.eh=new ResizeObserver((t=>{var i;null===(i=this.logger)||void 0===i||i.debug("ResizeObserver: resize observed");const e=t[0],n=e.borderBoxSize&&e.borderBoxSize[0];let s=null==n?void 0:n.inlineSize;if("number"!=typeof s){s=e.target.getBoundingClientRect().width}const r=this.Go(s,this.creativeDocument.width);this.fh(r)})),this.eh.observe(t))}ro(){this.viewTree={kind:ot.OH.Creative,nodes:[],width:this.creativeDocument.width,height:this.creativeDocument.height}}jo(t){this.destroyViewElement(t)}Mo(t){this.storedViewElements.get(t.id)||Jt(t,this)}};async function ni(t,i,e){const s=[];r.p=i&&(0,n.C6)(i,"/scripts/");for(const n of t){if(!n.id.startsWith("preload"))continue;switch(/^([\w-]+)/.exec(n.url)[1]){case"widget":s.push(ri(e));break;case"feed":s.push(si(e));break;case"video":s.push(oi(e))}}await Promise.all(s),r.p=""}async function si(t){const{FeedStore:i}=await r.e(231).then(r.bind(r,604271260327388));t.bt(13,(t=>e=>{const n=t.resolve(3),s=t.resolve(2);return new i(n,s,e)})),t.resolve(13)}async function ri(t){const{WidgetRenderer:i,AdApi:e,CreativeApi:n,TimelineApi:s}=await r.e(263).then(r.bind(r,0x694983ad600e));t.mt(4,i),t.mt(8,e),t.mt(9,n),t.mt(10,s)}async function oi(t){const{VideoRenderer:i}=await r.e(791).then(r.bind(r,962482161143741));t.bt(14,(t=>e=>{const n=t.resolve(5),s=t.resolve(3),r=t.resolve(2),o=t.resolve(0);return new i(o,s,n,r,e)})),t.mt(7,i)}ei.uo=0,ei=(0,L.gn)([(0,L.fM)(0,(0,U.hL)()),(0,L.fM)(1,(0,U.f3)(1)),(0,L.fM)(3,(0,U.f3)(2)),(0,L.fM)(4,(0,U.f3)(6)),(0,L.fM)(5,(0,U.f3)(4)),(0,L.fM)(6,(0,U.f3)(0)),(0,L.w6)("design:paramtypes",[m.W2,gt.EG,Object,Object,Object,Object,Object])],ei);var hi=r(442095885506762),ai=r(649763800171425);class ci{get bs(){var t;return(this.ph?window:null===(t=this.vh)||void 0===t?void 0:t.contentWindow)||void 0}get Os(){var t;const i=null===(t=this.bs)||void 0===t?void 0:t.document;if(!i)throw new Error("No document found");return i}constructor(t,r,o,h,a){this.ad=t,this.preloadAssets=o,this.mh=a,this.gh=new Set,this.wh=!1,this.ph=!1,this.destroyed=!1,this.init=async()=>{var t;F("ac:init:start");const i=this.bs;if(!i)throw new Error("Ad container is not visible");if(this.destroyed)return;this.bh(),this.yh=this._h();const n=new m.W2;n.mt(0,this.ad),n.mt(1,this.creativeDataNode),n.mt(2,this.env);const r=function(t){const i=t.MODE===s.y.ManageView||t.MODE===s.y.DesignView,e=new m.W2;return e.mt(15,et),e.mt(5,I.L),e.bt(22,(e=>(n,s,r)=>{let o;if(i){const i=new m.W2;i.parent=e;const h=i.resolve(16),a=e.maybeResolve(28),c=e.resolve(31);o=new et(n,s,r,t,a,h,c),h.text=o}else o=new et(n,s,r,t);return o})),e.bt(11,(t=>i=>{const e=t.resolve(1),n=t.resolve(2),s=new ei(t,e,i,n),r=t.maybeResolve(13);t.mt(3,s),r&&(s.feedStore=r(i.brandId));const o=t.maybeResolve(4);s.WidgetRenderer=o;const h=t.maybeResolve(0);return s.ad=h,s})),e.bt(12,(t=>(i,e,n)=>(t.mt(1,i),t.mt(0,n),new k(i,e,t)))),e}(this.env);r.parent=n;const o=r.resolve(12);F("ac:init:load:features:start"),await Promise.all([ni(this.ad.selectedCreative.animated.files,this.ad.getOrigin(),r),e.b3.n((null===(t=this.env)||void 0===t?void 0:t.IMAGE_OPTIMIZER_ORIGIN)||"",this.ad.selectedCreative.animated.defaultOrigin,this.xh()),M.init(this.ph)]),F("ac:init:load:features:end");const h=o(this.creativeDataNode,{contentWindow:i,brandId:this.ad.data.brand.id},this.ad);this.renderer=h.Ft,this.renderer.on("click",this.oi),h.At&&(F("ac:init:load:feeds:start"),this.feedStore=h.At,this.renderer.feedStore=this.feedStore,await this.Fh(),F("ac:init:load:feeds:end")),this.animator=h.Ct,this.Ch(),F("ac:init:render:start"),this.renderer.render(this.yh,0,!0),F("ac:init:render:end");try{await this.xe()}catch(a){console.error("Failed to preload fonts",a)}finally{F("ac:init:rerender:start"),this.renderer.Vo(this.creativeDataNode),F("ac:init:rerender:end")}try{F("ac:init:load:elements:start");const t=[...this.renderer.preloadingElements.values()];if(Promise.allSettled){(await Promise.allSettled(t)).forEach((t=>{if("rejected"===t.status)throw t.reason}))}else await Promise.all(t);F("ac:init:load:elements:end")}catch(c){const t=c;t.message?this.Ah(t.message,{level:"error",contexts:{image:t.url?{url:t.url}:void 0,originalError:c}}):console.error(c)}if(this.Eh(),this.renderer.WidgetRenderer)try{F("ac:init:load:widgets:start"),await Promise.all(this.renderer.WidgetRenderer.widgetInitializingPromises),await Promise.all(this.renderer.WidgetRenderer.widgetLoadingPromises)}catch(c){let t,i="Unknown error.";c instanceof Error&&(i=c.message,t=c.contexts),"string"==typeof c&&(i=c),this.Ah(i,{level:"error",contexts:t})}finally{F("ac:init:load:widgets:end")}F("ac:init:visibility:check"),this.Sh()?(this.Oh(),I.L&&this.$h()):this.Dh=i.setInterval((()=>{var t;this.Sh()&&(null===(t=this.renderer)||void 0===t||t.Vo(this.creativeDataNode),this.Oh(),I.L&&this.$h(),i.clearInterval(this.Dh))}),10),"function"==typeof this.mh&&this.mh(this),F("ac:init:end")},this.oi=(t,i)=>{this.Bh()&&(i?this.ad.tracking.click({x:t.x,y:t.y,deepLinkUrl:i}):this.ad.tracking.click(t))};try{const t=this.jh(r);this.creativeDataNode=new gt.EG(t)}catch(c){throw new Error(`Could not prepare creative data: ${null==c?void 0:c.message}`)}try{this.Mh(Object.assign(Object.assign({},h),{MODE:s.y.AnimatedCreative}));const t=this.Ih(),e=t.contentWindow;if(this.ph=!t.contentDocument||!!(0,n.qd)(this.ad.parameters.iframeless),this.ph)t.remove(),this.init();else{if(!e)return void console.warn("Did not initialize the creative, due to container element is not visible:\n",this.ad.container);(0,i.xE)(t),this.vh=t,this.kh(e,this.init)}}catch(c){throw new Error(`Could not initialize creative: ${null==c?void 0:c.message}`)}}getPreloadFonts(){return this.preloadAssets.filter((t=>"font"===t.type))}_h(){return this.ph?this.ad.container:this.Os.body}Sh(){const t=this.Os.createElement("div"),i=t.style;i.height="1px",i.width="1px",i.position="absolute",i.top="-100000px",this.ad.container.appendChild(t);const e=t.getBoundingClientRect().height>0;return this.ad.container.removeChild(t),e}Eh(){if(this.renderer)for(const t of this.renderer.creativeDocument.elements)if((0,c.mO)(t)){this.hasWidgetElements=!0;break}}$h(){if(F("ac:animator:start"),!this.animator)return;const i=this.ad.shouldAutoplay();this.animator.seek(this.V());const e=(0,X.ot)(this.ad.parameters.fps);e&&this.animator.updateCustomFPSInterval(e),this.env.MODE===s.y.VideoGenerator&&(this.creativeDataNode.loops=1,this.animator.on("pause",(()=>{this.wh||(this.wh=!0,setTimeout((()=>{var t;return null===(t=this.animator)||void 0===t?void 0:t.emit("loop")}),0))}))),this.ad.viewability.pauseOutsideView()?(this.ad.on(t.ViewEnter,(()=>{var t;null===(t=this.animator)||void 0===t||t.play()})),this.ad.on(t.ViewLeave,(()=>{var t;null===(t=this.animator)||void 0===t||t.pause()})),this.ad.viewability.visible&&i&&this.animator.play()):i&&this.animator.play(),this.ad.on(t.Stop,(()=>{var t;null===(t=this.animator)||void 0===t||t.pause()})),F("ac:animator:end")}V(){var t,i;const e=parseFloat((null===(t=this.ad.parameters)||void 0===t?void 0:t.seek)||"");if(!isNaN(e))return e;if(this.Th()){const t=(null===(i=this.creativeDataNode.preloadImage)||void 0===i?void 0:i.frames)&&this.creativeDataNode.preloadImage.frames[0];return"number"==typeof t?t:1}return this.creativeDataNode.startTime||0}Th(){var t;return"preload-frame"===(null===(t=this.ad.parameters)||void 0===t?void 0:t.seek)}Mh(t){if(t){if(this.env=t,"image-generator"===this.ad.parameters.env||this.Th()?this.env.MODE=s.y.ImageGenerator:("video-generator"===this.ad.parameters.env||this.ad.isOmniRender())&&(this.env.MODE=s.y.VideoGenerator),!(0,n.$q)(window.location.href)){const t=this.ad.getOrigin();if((0,n.$q)(t)||(this.env.CUSTOM_AD_DOMAIN=(0,n.ge)(t,!1)),t)for(const i in this.env){const e=this.env[i];(0,n.CB)(e)&&((0,n.j3)(e)?this.env[i]=(0,n.C6)(t,e):t.includes("bannerflow.com/creatives")||(this.env[i]=(0,n.r9)(e,t)))}}e.kZ.imageOptimizerOrigin=this.env.IMAGE_OPTIMIZER_ORIGIN}}Ih(){const t=document.createElement("iframe"),e=t.style;return e.width=e.height="1px",e.minWidth=e.maxWidth=e.minHeight="100%",e.outline=e.border=e.transform=e.filter="none",e.display="block",e.position="absolute",e.left=e.top=e.opacity="0",e.transformOrigin="0 0",t.src=(0,i.CH)(),t.scrolling="no",this.ad.shouldFadeIn()&&(e.transition="opacity 0.2s ease"),this.ad.container.appendChild(t),t}Oh(){F("ac:iframe:show"),this.vh&&(this.vh.style.opacity="1")}bh(){const t=this.Bh()?"pointer;":"default;",i=this.Os,e=i.createElement("style");e.innerHTML=`*{box-sizing: border-box;}:root{color-scheme: light only;}html,body{margin:0;padding:0;overflow:hidden;width:100%;height:100%;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;user-select:none;cursor:${t};}`,this.creativeStylesRef=e,i.head.appendChild(e)}Bh(){const t=this.ad.tracking.getRedirectUrl();if(!1!==t)return t||this.ad.tracking.getTargetUrl()}kh(t,i){if("complete"===t.document.readyState)setTimeout((()=>{i()}),100);else{const e=()=>{i&&i(),t&&t.removeEventListener("load",e)};t.addEventListener("load",e)}}Ch(){const{animator:i,ad:e}=this;i&&e&&(i.on("loop",(()=>e.emit(t.Loop,[this.Rh()]))),i.on("pause",(()=>e.emit(t.Pause,[this.Rh()]))),i.on("play",(()=>e.emit(t.Play,[this.Rh()]))),i.on("stop",(()=>e.emit(t.Stop,[this.Rh()]))),i.on("seek",(()=>e.emit(t.Seek,[this.Rh()]))),F("ac:animated-events:added"))}Rh(){const t=this.animator;return{ad:this.ad,time:(null==t?void 0:t.time)||0,loop:(null==t?void 0:t.loop)||0}}destroy(){var t,i,e;clearInterval(this.Dh),null===(t=this.yh)||void 0===t||t.removeEventListener("click",this.oi),this.destroyed=!0;try{this.creativeStylesRef&&(this.Os.head.removeChild(this.creativeStylesRef),this.creativeStylesRef=void 0)}catch(n){}null===(i=this.renderer)||void 0===i||i.destroy(),null===(e=this.animator)||void 0===e||e.destroy()}async Fh(){var t,i;F("ac:preload:feeds:start"),this.creativeDataNode.elements.forEach((t=>{const i=(0,c.$Q)(t)||(0,c.iN)(t);if((0,c.BM)(t))for(const e of t.content.spans)"variable"===e.type&&this.gh.add(e.style.variable.id);else t.feed&&i?this.gh.add(t.feed.id):this.ad.overriddenFeedData&&(0,c.mO)(t)&&t.customProperties.filter((t=>"feed"===t.unit)).forEach((t=>{try{const i=JSON.parse(t.value);if(!(0,ai.Tu)(i)||0===i.id.length)return;this.gh.add(i.id)}catch(i){}}))})),this.ad.overriddenFeedData&&this.gh.size>0&&(null===(i=null===(t=this.renderer)||void 0===t?void 0:t.feedStore)||void 0===i||i.feeds.set([...this.gh][0],{feed:{data:this.ad.overriddenFeedData,intervalInSeconds:0},interval:void 0,overridden:!0})),await this.feedStore.preloadFeeds([...this.gh]),F("ac:preload:feeds:end")}xh(){return this.env.MODE===s.y.ImageGenerator||this.env.MODE===s.y.VideoGenerator?2:1}async xe(){var t;if(F("ac:preload:fonts:start"),this.feedStore){null===(t=this.renderer)||void 0===t||t.creativeDocument.elements.forEach((t=>{if((0,c.BM)(t))for(const i of t.content.spans)"variable"===i.type&&this.feedStore.addFeedElement(t.id,i.style.variable,t)}));for(const t of this.gh)this.feedStore.loadFontsBasedOnFeedData(t,!0)}for(const{value:e}of this.getPreloadFonts())if(e){if(!e.src.startsWith("data")){const[t,i]=e.src.split(hi.N),n=this.feedStore&&this.feedStore.fontCharacterCache.get(e.id)||"",s=decodeURIComponent(i),{textParams:r,distinctText:o}=(0,hi._)(n+s);if(n&&(this.feedStore.fontCharacterCache.set(e.id,o),e.src=t+r),!o)continue}try{if("bannerflow"===window.app&&this.ad.parameters["font-loading"])_(this.Os,e,this.env.FONTSERVICE_API_ORIGIN),await this.Os.fonts.load(`1em f-${e.id}`);else{const t=await y(e,this.env.FONTSERVICE_API_ORIGIN);this.Os.fonts.add(t)}}catch(i){this.Ah("Could not load font",{level:"error",contexts:{font:e,originalError:i}})}}F("ac:preload:fonts:end")}Ah(t,i){i&&"bannerflow"===window.app&&Sentry&&Sentry.captureMessage(t,{level:i.level,contexts:i.contexts}),console.error(t)}jh(t){return function(t,i){for(const e of t)(0,c.BM)(e)&&e.content.spans.length>1&&void 0!==e.assetId&&(e.font=l(e.assetId,i))}(t.elements,this.preloadAssets),this.Lh(t)?t:u(t)}Lh(t){return this.ad.isDocumentJSVersion()}}})(),t=o})(),t}));